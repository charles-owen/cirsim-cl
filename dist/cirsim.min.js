/*! For license information please see cirsim.min.js.LICENSE.txt */
(()=>{var t,e={92060:function(){!function(t){"use strict";if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(t){}var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},i=function(){this.data=[]},n=function(t,e,i){this.data=t,this.size=t.length,this.type=e,this.encoding=i},o=i.prototype,r=n.prototype,s=t.FileReaderSync,a=function(t){this.code=this[this.name=t]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),h=l.length,c=t.URL||t.webkitURL||t,u=c.createObjectURL,d=c.revokeObjectURL,p=c,f=t.btoa,v=t.atob,m=t.ArrayBuffer,y=t.Uint8Array,g=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(n.fake=r.fake=!0;h--;)a.prototype[l[h]]=h+1;return c.createObjectURL||(p=t.URL=function(t){var e,i=document.createElementNS("http://www.w3.org/1999/xhtml","a");return i.href=t,"origin"in i||("data:"===i.protocol.toLowerCase()?i.origin=null:(e=t.match(g),i.origin=e&&e[1])),i}),p.createObjectURL=function(t){var e,i=t.type;return null===i&&(i="application/octet-stream"),t instanceof n?(e="data:"+i,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):f?e+";base64,"+f(t.data):e+","+encodeURIComponent(t.data)):u?u.call(c,t):void 0},p.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&d&&d.call(c,t)},o.append=function(t){var i=this.data;if(y&&(t instanceof m||t instanceof y)){for(var o="",r=new y(t),l=0,h=r.length;l<h;l++)o+=String.fromCharCode(r[l]);i.push(o)}else if("Blob"===e(t)||"File"===e(t)){if(!s)throw new a("NOT_READABLE_ERR");var c=new s;i.push(c.readAsBinaryString(t))}else t instanceof n?"base64"===t.encoding&&v?i.push(v(t.data)):"URI"===t.encoding?i.push(decodeURIComponent(t.data)):"raw"===t.encoding&&i.push(t.data):("string"!=typeof t&&(t+=""),i.push(unescape(encodeURIComponent(t))))},o.getBlob=function(t){return arguments.length||(t=null),new n(this.data.join(""),t,"raw")},o.toString=function(){return"[object BlobBuilder]"},r.slice=function(t,e,i){var o=arguments.length;return o<3&&(i=null),new n(this.data.slice(t,o>1?e:this.data.length),i,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},i}(t);t.Blob=function(t,i){var n=i&&i.type||"",o=new e;if(t)for(var r=0,s=t.length;r<s;r++)Uint8Array&&t[r]instanceof Uint8Array?o.append(t[r].buffer):o.append(t[r]);var a=o.getBlob(n);return!a.slice&&a.webkitSlice&&(a.slice=a.webkitSlice),a};var i=Object.getPrototypeOf||function(t){return t.__proto__};t.Blob.prototype=i(new t.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},13113:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o}),t=i.hmd(t);var n=n||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,i=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,r=/constructor/i.test(t.HTMLElement),s=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},l=function(t){setTimeout((function(){"string"==typeof t?i().revokeObjectURL(t):t.remove()}),4e4)},h=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},c=function(e,c,u){u||(e=h(e));var d,p=this,f="application/octet-stream"===e.type,v=function(){!function(t,e,i){for(var n=(e=[].concat(e)).length;n--;){var o=t["on"+e[n]];if("function"==typeof o)try{o.call(t,i||t)}catch(t){a(t)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,o)return d=i().createObjectURL(e),void setTimeout((function(){var t,e;n.href=d,n.download=c,t=n,e=new MouseEvent("click"),t.dispatchEvent(e),v(),l(d),p.readyState=p.DONE}));!function(){if((s||f&&r)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=s?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,p.readyState=p.DONE,v()},n.readAsDataURL(e),void(p.readyState=p.INIT)}(d||(d=i().createObjectURL(e)),f)?t.location.href=d:t.open(d,"_blank")||(t.location.href=d);p.readyState=p.DONE,v(),l(d)}()},u=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=h(t)),navigator.msSaveOrOpenBlob(t,e)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,e,i){return new c(t,e||t.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);t.exports?t.exports.saveAs=n:"undefined"!=typeof define&&null!==define&&null!==i.amdO&&define([],(function(){return n}));const o=n},83766:()=>{"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])}return i},writable:!0,configurable:!0})},88637:()=>{String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t})},64916:(t,e,i)=>{i.p=function(){var t=/^(http.*\/.*\/)[^\/]+.js.*$/,e=document.currentScript.src.match(t);if(null!==e)return e[1];if(t=/^.*\/([^\/]+.js)$/,null!==(e=document.currentScript.src.match(t)))for(var i=e[1],n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var r=n[o].getAttribute("src"),s=r.indexOf(i);if(s>-1)return r.substring(0,s)}return""}()},50400:(t,e,i)=>{"use strict";var n=i(6559),o=i.n(n),r=i(24037),s=i.n(r),a=i(75767),l=i.n(a),h=i(57204),c=i.n(h),u=i(33833),d=i.n(u),p=i(26310),f=i.n(p),v=i(70959),m={};m.styleTagTransform=f(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=d();o()(v.Z,m);v.Z&&v.Z.locals&&v.Z.locals;i(64916),i(43516),i(88637),i(83766);var y=i(90028),g=function(){this.circuit=null,this.x=0,this.y=0,this.moveX=0,this.moveY=0,this.selectedStyle="#ff0000",this.unselectedStyle="#000000"};g.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.moveX=t.moveX,this.moveY=t.moveY},g.prototype.single=function(){return!1},g.prototype.selectStyle=function(t,e){return e.selection.isSelected(this)?(t.strokeStyle=this.selectedStyle,t.fillStyle=this.selectedStyle,!0):(t.strokeStyle=this.unselectedStyle,t.fillStyle=this.unselectedStyle,!1)},g.prototype.grab=function(){this.moveX=this.x,this.moveY=this.y},g.prototype.move=function(t,e){this.moveX+=t,this.moveY+=e,this.x=this.moveX,this.y=this.moveY,null!==this.circuit&&this.circuit.snapIt(this)},g.prototype.place=function(t,e){this.moveX=t,this.moveY=e,this.x=this.moveX,this.y=this.moveY,null!==this.circuit&&this.circuit.snapIt(this)},g.prototype.delete=function(){},g.prototype.drop=function(){},g.prototype.spawn=function(t,e){return null};var b=function(){};b.toHex=function(t,e){for(var i=Number(t).toString(16);i.length<e;)i="0"+i;return i},b.toBinary=function(t,e){for(var i=Number(t).toString(2);i.length<e;)i="0"+i;return i},b.inArray=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()===t.toLowerCase())return!0;return!1};var w=function(t,e){this.x=t,this.y=e};w.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x/=t,this.y/=t},w.normalize=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return new w(t.x/e,t.y/e)},w.rotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return new w(n*t.x-i*t.y,i*t.x+n*t.y)},w.distanceToLine=function(t,e,i,n){return 0==e?Math.abs((i*t.y+n)/i):0==i?Math.abs((e*t.x+n)/e):Math.abs(e*t.x+i*t.y+n)/Math.sqrt(e*e+i*i)},w.distanceToLineP2=function(t,e,i){return w.distanceToLine(t,e.y-i.y,i.x-e.x,e.x*i.y-i.x*e.y)},w.nearestOnLine=function(t,e,i,n){return 0==e?{x:t.x,y:-n/i}:0==i?{x:-n/e,y:t.y}:{x:(i*(i*t.x-e*t.y)-e*n)/(e*e+i*i),y:(e*(-i*t.x+e*t.y)-i*n)/(e*e+i*i)}},w.nearestOnLineP2=function(t,e,i){return w.nearestOnLine(t,e.y-i.y,i.x-e.x,e.x*i.y-i.x*e.y)},w.computeT=function(t,e,i){var n=i.x-e.x,o=i.y-e.y;return Math.abs(n)>Math.abs(o)?(t.x-e.x)/n:(t.y-e.y)/o},w.distance=function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},w.distanceToLineSegment=function(t,e,i){var n=w.nearestOnLineP2(t,e,i),o=w.computeT(n,e,i);if(o>=0&&o<=1)return{d:w.distance(t,n),p:n};var r=w.distance(t,e),s=w.distance(t,i);return r<s?{d:r,p:e}:{d:s,p:i}};var x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.left=t,this.top=e,this.right=i,this.bottom=n};x.prototype.setRightBottom=function(t,e){this.right=t,this.bottom=e},x.prototype.normalize=function(){if(this.left>this.right){var t=this.left;this.left=this.right,this.right=t}if(this.top>this.bottom){var e=this.top;this.top=this.bottom,this.bottom=e}},x.prototype.isEmpty=function(){return this.left>=this.right||this.top>=this.bottom},x.prototype.contains=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},x.prototype.expand=function(t){t.left<this.left&&(this.left=t.left),t.right>this.right&&(this.right=t.right),t.top<this.top&&(this.top=t.top),t.bottom>this.bottom&&(this.bottom=t.bottom)},x.prototype.expandXY=function(t,e){t<this.left&&(this.left=t),t>this.right&&(this.right=t),e<this.top&&(this.top=e),e>this.bottom&&(this.bottom=e)};var T=function(t,e,i,n,o,r){this.component=t,this.x=e,this.y=i,this.len=void 0!==n?n:16,this.index=void 0,this.name=o,this.inv=r,this.value=void 0,this.touchRange=8,this.bus=!1,this.reference=null,this.clock=!1};function I(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}T.prototype.orientation="w",T.prototype.single=function(){return!0},T.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.len=t.len,this.index=t.index,this.name=t.name,this.inv=t.inv,this.value=t.value,this.touchRange=t.touchRange,this.bus=t.bus,this.reference=t.reference},T.prototype.get=function(){return this.value},T.prototype.getAsString=function(){return function t(e){if(Array.isArray(e)){var i="";return e.forEach((function(e){i=t(e)+i})),i}return void 0===e?"?":e?"1":"0"}(this.value)},T.parseBusValue=function(t){for(var e=[],i=t.length-1;i>=0;i--){switch(t.substr(i,1)){case"0":e.push(!1);break;case"1":e.push(!0);break;case"?":e.push(void 0);break;default:return null}}return e},T.busValueToDecimal=function(t,e){if(void 0===t)return null;var i=0,n=1;for(var o in t){if(void 0===t[o])return null;t[o]&&(i+=n),n*=2}return void 0!==e&&(i%=e),i},T.prototype.touch=function(t,e){var i=this.getLoc(),n=this.touchRange;return t>=i.x-n&&t<=i.x+n&&e>=i.y-n&&e<=i.y+n},T.prototype.getLoc=function(){switch(this.orientation){case"w":return new w(this.component.x+this.x-this.len,this.component.y+this.y);case"n":return new w(this.component.x+this.x,this.component.y+this.y-this.len);case"s":return new w(this.component.x+this.x,this.component.y+this.y+this.len);case"e":return new w(this.component.x+this.x+this.len,this.component.y+this.y)}},T.prototype.draw=function(t,e){var i=this.component.x+this.x,n=this.component.y+this.y;switch(this.bus?t.lineWidth=2:t.lineWidth=1,this.orientation){case"e":if(t.beginPath(),t.moveTo(i,n+.5),t.lineTo(i+this.len,n+.5),t.fillRect(i+this.len-1,n-1,3,3),this.component.circuit.circuits.model.main.options.showOutputStates){t.font="11px Times",t.textAlign="left";var o=this.getAsString();o.length>8&&(o=parseInt(o,2),o=isNaN(o)?"?":b.toHex(o,4)),t.fillText(o,i+5,n-2)}void 0!==this.name&&(t.font="12px Times",t.textAlign="right",t.fillText(this.name,i-3,n+3)),t.stroke();break;case"w":if(t.beginPath(),t.moveTo(i,n+.5),t.lineTo(i-this.len,n+.5),t.fillRect(i-this.len-1,n-1,3,3),this.clock){var r=7;t.moveTo(i,n-r),t.lineTo(i+r,n),t.lineTo(i,n+r)}void 0!==this.name&&(t.font="12px Times",t.textAlign="left",t.fillText(this.name,i+2,n+3)),t.stroke();break;case"n":if(t.beginPath(),t.moveTo(i+.5,n),t.lineTo(i+.5,n-this.len),t.fillRect(i-1,n-this.len-1,3,3),this.clock){r=7;t.moveTo(i-r,n),t.lineTo(i,n+r),t.lineTo(i+r,n)}t.stroke(),void 0!==this.name&&(n+=this.clock?12+r:12,t.font="12px Times",t.textAlign="center",t.fillText(this.name,i,n));break;case"s":if(t.beginPath(),t.moveTo(i+.5,n),t.lineTo(i+.5,n+this.len),t.fillRect(i-1,n+this.len-1,3,3),this.clock){r=7;t.moveTo(i-r,n),t.lineTo(i,n-r),t.lineTo(i+r,n)}t.stroke(),void 0!==this.name&&(n-=this.clock?6+r:6,t.font="12px Times",t.textAlign="center",t.fillText(this.name,i,n))}t.lineWidth=1},T.prototype.autoLen=function(){if("s"===this.orientation)for(this.len=8*Math.floor(this.y/8)+8-this.y;this.len<12;)this.len+=8},T.prototype.bounds=function(){var t=this.component.x+this.x,e=this.component.y+this.y,i=new x(t,e,t,e);switch(this.orientation){case"e":i.expandXY(t+this.len,e);break;case"w":i.expandXY(t-this.len,e);break;case"n":i.expandXY(t,e-this.len);break;case"s":i.expandXY(t,e+this.len)}return i};var k=function(t,e,i,n,o,r){T.call(this,t,e,i,n,o,r),this.to=[],this.orientation="e"};(k.prototype=Object.create(T.prototype)).constructor=k,k.prototype.clone=function(){var t=new k(this.component,this.x,this.y,this.len,this.name,this.inv);return t.orientation=this.orientation,t.copyFrom(this),t},k.prototype.set=function(t){var e=!0;if(Array.isArray(t)){if(Array.isArray(this.value)&&t.length===this.value.length)for(var i in e=!1,t)if(t[i]!==this.value[i]){e=!0;break}}else e=this.value!==t;if(e){this.value=t;for(var n=0;n<this.to.length;n++){var o=this.to[n].to;null!==o&&o.set()}}},k.prototype.setAsString=function(t){if(this.bus)this.set(T.parseBusValue(t));else switch(t){default:this.set(!1);break;case"1":this.set(!0);break;case"?":this.set(void 0)}},k.prototype.get=function(){return this.value},k.prototype.draw=function(t,e){T.prototype.draw.call(this,t,e),this.bus?t.lineWidth=2:t.lineWidth=1;for(var i=0;i<this.to.length;i++)this.to[i].draw(t,e);t.lineWidth=1},k.prototype.add=function(t){this.to.push(t)},k.prototype.remove=function(t){var e=[];this.to.forEach((function(i){i!==t&&e.push(i)})),this.to=e},k.prototype.clear=function(){this.to.forEach((function(t){t.delete(this)})),this.to=[]},k.prototype.touchConnections=function(t,e){for(var i=0;i<this.to.length;i++){var n=this.to[i].touch(t,e);if(null!=n)return n}return null},k.prototype.selectRect=function(t,e){for(var i=0;i<this.to.length;i++)this.to[i].selectRect(t,e)},k.prototype.bounds=function(){var t,e=T.prototype.bounds.call(this),i=I(this.to);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.expand(n.bounds())}}catch(t){i.e(t)}finally{i.f()}return e};var O=function(t,e,i,n,o,r){T.call(this,t,e,i,n,o,r),this.from=[],this.orientation="w"};(O.prototype=Object.create(T.prototype)).constructor=O,O.prototype.clone=function(){var t=new O(this.component,this.x,this.y,this.len,this.name,this.inv);return t.orientation=this.orientation,t.copyFrom(this),t},O.prototype.set=function(){var t=this.from.length>0&&null!==this.from[0].from?this.from[0].from.value:void 0;this.value!==t&&(this.value=t,this.component.pending())},O.prototype.testAsString=function(t){this.component.testAsString(t,this)},O.prototype.setConnection=function(t){this.from.forEach((function(t){t.delete(this)})),t.to=this,this.from=[t],this.set()},O.prototype.clear=function(){this.from.forEach((function(t){t.delete(this)})),this.from=[]},O.prototype.add=function(t){this.from.push(t)},O.prototype.remove=function(t){var e=[];this.from.forEach((function(i){i!==t&&e.push(i)})),this.from=e},O.prototype.draw=function(t,e){T.prototype.draw.call(this,t,e);for(var i=0;i<this.from.length;i++)null===this.from[i].from&&this.from[i].draw(t,e)},O.prototype.bounds=function(){return T.prototype.bounds.call(this)};var A=function(t,e,i,n,o,r){k.call(this,t,e,i,n,o,r)};(A.prototype=Object.create(k.prototype)).constructor=A,A.prototype.draw=function(t,e){var i=this.component.x+this.x,n=this.component.y+this.y;t.beginPath(),t.arc(i+4+.5,n,4,0,2*Math.PI),t.moveTo(i+8,n+.5),t.lineTo(i+this.len,n+.5),t.fillRect(i+this.len-1,n-1,3,3),this.component.circuit.circuits.model.main.options.showOutputStates&&(t.font="11px Times",t.fillText(void 0===this.value?"?":this.value?"1":"0",i+7+8,n-2)),t.stroke(),void 0!==this.name&&(t.font="12px Times",t.textAlign="right",t.fillText(this.name,i-3,n+3),this.inv&&(n-=8,t.beginPath(),t.moveTo(i-3,n),t.lineTo(i-13,n),t.stroke()));for(var o=0;o<this.to.length;o++)this.to[o].draw(t,e)},A.prototype.set=function(t){void 0===t?k.prototype.set.call(this,t):k.prototype.set.call(this,!t)};var C=function(t,e){g.call(this),this.connection=null,void 0!==t&&(this.x=t,this.moveX=t),void 0!==e&&(this.y=e,this.moveY=e)};function E(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return z(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return z(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(C.prototype=Object.create(g.prototype)).constructor=C,C.prototype.touchRange=12,C.prototype.size=4,C.prototype.clone=function(){var t=new C;return t.copyFrom(this),t},C.prototype.draw=function(t,e){e.selection.isSelected(this)&&(this.selectStyle(t,e),t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill())},C.prototype.touch=function(t,e){return Math.abs(t-this.x)+Math.abs(e-this.y)<=this.touchRange},C.prototype.delete=function(t){this.connection.removeBend(this)},C.prototype.save=function(){return{x:this.x,y:this.y}};var B=function(t,e,i){if(g.call(this),this.touchRange=8,this.bends=[],null!==t){if(this.circuit=t.component.circuit,this.from=t,this.from.add(this),null===e){var n=t.getLoc();this.x=n.x,this.y=n.y}}else this.from=null;if(void 0===e&&console.log(this),null!==e){if(this.circuit=e.component.circuit,this.to=e,this.to.add(this),null===t){n=e.getLoc();this.x=n.x,this.y=n.y}!0!==i&&e.set()}else this.to=null};(B.prototype=Object.create(g.prototype)).constructor=B,B.prototype.clone=function(){if(null===this.from||null===this.to)return null;var t=this.from.component.prev,e=this.to.component.prev,i=this.from.index,n=this.to.index;void 0===e.ins[n]&&console.log(this);for(var o=new B(t.outs[i],e.ins[n],!0),r=0;r<this.bends.length;r++){var s=this.bends[r].clone();o.addBend(s)}return o},B.prototype.delete=function(t){var e=this.to;null!==this.to&&this.to!==t&&this.to.remove(this),null!==this.from&&this.from!==t&&this.from.remove(this),null!==e&&e.set()},B.prototype.removeBend=function(t){var e=[];this.bends.forEach((function(i){i!==t&&e.push(i)})),this.bends=e},B.prototype.getCircuit=function(){return null!==this.from?this.from.component.circuit:null!==this.to?this.to.component.circuit:null},B.prototype.drop=function(){if(null!==this.from&&null===this.to){var t=this.from.component.circuit.touchIn(this.x,this.y);null!==t&&this.from.bus===t.bus?t.setConnection(this):this.from.remove(this)}else if(null===this.from&&null!==this.to){var e=this.to.component.circuit.touchOut(this.x,this.y);null!==e&&this.to.bus===e.bus?(this.to.clear(),this.to.from=[this],this.from=e,e.add(this),this.to.set()):this.to.remove(this)}},B.prototype.draw=function(t,e){if(this.selectStyle(t,e),t.beginPath(),null!==this.from){var i=this.from.getLoc();t.moveTo(i.x+.5,i.y+.5)}else t.moveTo(this.x+.5,this.y+.5);for(var n=0;n<this.bends.length;n++){var o=this.bends[n];t.lineTo(o.x+.5,o.y+.5)}if(null!==this.to){i=this.to.getLoc();t.lineTo(i.x+.5,i.y+.5)}else t.lineTo(this.x+.5,this.y+.5);t.stroke();for(n=0;n<this.bends.length;n++)this.bends[n].draw(t,e)},B.prototype.bounds=function(){var t=null;if(null!==this.from){var e=this.from.getLoc();t=new x(e.x,e.y,e.x,e.y)}else t=new x(this.x,this.y,this.x,this.y);var i,n=E(this.bends);try{for(n.s();!(i=n.n()).done;){var o=i.value;t.expandXY(o.x,o.y)}}catch(t){n.e(t)}finally{n.f()}if(null!==this.to){var r=this.to.getLoc();t.expandXY(r.x,r.y)}else t.expandXY(this.x,this.y);return t},B.prototype.touch=function(t,e){for(var i=null!==this.from?this.from:new w(t,e),n=null!==this.to?this.to:new w(t,e),o=0;o<this.bends.length;o++){var r=this.bends[o];if(r.touch(t,e))return r}var s=i.getLoc();for(o=0;o<this.bends.length;o++){var a=this.bends[o];if(w.distanceToLineSegment({x:t,y:e},s,a).d<=this.touchRange)return this;s=a}return w.distanceToLineSegment({x:t,y:e},s,n.getLoc()).d<=this.touchRange?this:null},B.prototype.selectRect=function(t,e){for(var i=0;i<this.bends.length;i++){var n=this.bends[i];t.contains(n.x,n.y)&&e.push(n)}},B.prototype.spawn=function(t,e){if(null!==this.to&&null!==this.from){for(var i=0,n=1e10,o=this.from.getLoc(),r=0;r<this.bends.length;r++){var s=this.bends[r];(a=w.distanceToLineSegment({x:t,y:e},o,s)).d<=n&&(i=r,n=a.d),o=s}var a;(a=w.distanceToLineSegment({x:t,y:e},o,this.to.getLoc())).d<=n&&(i=r,n=a.d);var l=new C;return i<this.bends.length?this.insertBend(i,l):this.addBend(l),l.place(t,e),l}return null},B.prototype.insertBend=function(t,e){e.connection=this,e.circuit=this.circuit,this.bends.splice(t,0,e)},B.prototype.addBend=function(t){t.connection=this,t.circuit=this.circuit,this.bends.push(t)},B.prototype.save=function(){if(null===this.from||null===this.to)return null;for(var t=this.from.component,e=this.to.component,i=this.from.index,n=this.to.index,o=[],r=0;r<this.bends.length;r++){var s=this.bends[r];o.push(s.save())}return{from:t.id,out:i,to:e.id,in:n,bends:o}},B.prototype.load=function(t){var e=this;t.bends.forEach((function(t){var i=new C(t.x,t.y);e.addBend(i)}))};var N=function(){};N.unique=1,N.uniqueId=function(){return N.unique++},N.uniqueName=function(){return"cirsim-id-"+N.unique++};const P=N;var L=i(19074);function R(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var U=function(){};U.isVisible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},U.addClass=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},U.addClasses=function(t,e){null!=e&&e.split(" ").forEach((function(e){U.addClass(t,e)}))},U.removeClass=function(t,e){var i=new RegExp("\\b"+e+"\\b","g");t.className=t.className.replace(i,"")},U.createClassedDiv=function(t,e){var i=document.createElement("div");return U.addClass(i,t),void 0!==e&&U.addContent(i,e),i},U.addContent=function(t,e){U.isString(e)?t.innerHTML+=e:U.isElement(e)&&t.appendChild(e)},U.isString=function(t){return"string"==typeof t||!!t&&"object"===(0,L.Z)(t)&&"[object String]"===Object.prototype.toString.call(t)},U.isElement=function(t){return null!=t&&void 0!==t.nodeValue},U.offset=function(t){var e=t.getBoundingClientRect();return{left:e.left+t.scrollLeft+window.pageXOffset,top:e.top+t.scrollTop+window.pageYOffset}},U.child=function(t,e){var i,n=R(t.childNodes);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(o.tagName===e)return o}}catch(t){n.e(t)}finally{n.f()}return null};var D=i(23335),M=i.n(D),q=i(2259),F=function(t){this.classes=void 0!==t?"cirsim "+t:"cirsim",this.buttonOk="Ok",this.buttonCancel="Cancel",this.resize="none;",this.titleBarButtons=null};F.prototype.contents=function(t,e){this.html=t,this.title=e},F.prototype.open=function(){var t=this,e=document.createElement("form"),i=U.createClassedDiv("cirsim-dlg-content");e.appendChild(i);var n="".concat(this.html,'<p class="error"></p>\n<input type="submit" tabindex="-1" style="position:absolute; top:-1000px">');i.innerHTML=n,this.element=i;var o=[];null!==this.buttonOk&&o.push({contents:"Ok",click:function(e){t.ok()},focus:!0,class:"cs-ok"}),null!==this.buttonCancel&&o.push({contents:"Cancel",click:function(t){t.close()},class:"cs-cancel"});var r=new q.Z({addClass:this.classes,title:this.title,content:e,buttons:o,resize:this.resize,titleBarButtons:this.titleBarButtons});this.dialog=r,this.onOpen(),this.close=function(){r.close()},e.addEventListener("submit",(function(e){e.preventDefault(),t.ok()})),this.buttonOk=function(){return this.dialog.div.querySelector("button.cs-ok")}},F.prototype.ok=function(){this.close()},F.prototype.error=function(t){void 0!==t&&(this.element.querySelector(".error").innerHTML=t)},F.prototype.cancel=function(){},F.prototype.onOpen=function(){},F.prototype.sanitize=function(t){return M().sanitize(t)},F.prototype.uniqueId=function(){return N.uniqueName()};var H=function(t,e){var i=this;F.call(this,"component"),this.resize="both";var n=null,o="",r=function(){},s=function(){return null},a=function(){return null};this.open=function(){var s="";"help"in t.constructor&&(s+='<a class="helper">help</a>'),"description"in t.constructor&&(s+='<div class="description">',s+=t.constructor.description+"</div>");var a="";if(null!==t.naming)a=t.naming;else if(null!==t.prefix)for(var l=1;;l++){if(a=t.prefix+l,null===t.circuit.getComponentByNaming(a))break}var h="";null!==t.prefix&&(h+='<div class="control1 center gap"><label for="'+(n=N.uniqueName())+'">Name: </label><input type="text" name="'+n+'" id="'+n+'" value="'+a+'" spellcheck="false" class="compname text ui-widget-content ui-corner-all"></div>'),h+=o+s,i.contents(h,"Cirsim Component Properties"),F.prototype.open.call(i),r(),null!==n&&document.getElementById(n).select();var c=i.element.querySelector("a.helper");null!==c&&c.addEventListener("click",(function(i){i.preventDefault();var n=t.constructor.help;e.menu.helpMenu.componentHelp(n)}))},this.ok=function(){var o="";if(null!==t.prefix){var r=document.getElementById(n);if(0!==(o=r.value.replace(/^\s+|\s+$/gm,"")).length){var l=t.circuit.getComponentByNaming(o);if(null!==l&&l!==t)return U.addClass(r,"cirsim-error"),void i.error("Name already exists")}U.removeClass(r,"cirsim-error"),o=i.sanitize(o)}var h=s();null===h?(e.backup(),null!==t.prefix&&(t.naming=o.length>0?o:null),a(),i.close(),e.currentView().draw()):i.error(h)},this.extra=function(t,e,i){o=t,s=e,a=i},this.extraCreate=function(t){r=t}};function X(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return W(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return W(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(H.prototype=Object.create(F.prototype)).constructor=H;var Y=function(){g.call(this);var t=null;Object.defineProperty(this,"circuit",{get:function(){return t},set:function(e){t=e}}),this.height=10,this.width=10,this.prev=null,this.id="",this.circuit=null,this.naming=null,this.ins=[],this.outs=[]};(Y.prototype=Object.create(g.prototype)).constructor=Y,Y.prototype.prefix="U",Y.prototype.nameRequired=!1,Y.prototype.delay=11,Y.prototype.brand=function(){this.id="c"+ ++Y.maxId},Y.maxId=1e3,Y.prototype.copyFrom=function(t){this.height=t.height,this.width=t.width,this.prev=t.prev,this.naming=t.naming,this.id=t.id,t.prev=this,g.prototype.copyFrom.call(this,t);for(var e=0;e<this.ins.length;e++)this.ins[e].copyFrom(t.ins[e]);for(var i=0;i<this.outs.length;i++)this.outs[i].copyFrom(t.outs[i])},Y.prototype.drop=function(){this.x<this.width/2&&(this.x=this.width/2),this.y<this.height/2&&(this.y=this.height/2)},Y.prototype.grab=function(){g.prototype.grab.call(this),this.circuit.moveToFront(this)},Y.prototype.mouseUp=function(){},Y.prototype.added=function(t){if(this.circuit=t,null===this.naming&&this.nameRequired)for(var e=1;;e++){var i=void 0;if(i="*"===this.prefix.charAt(0)?e<=26?"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e-1):this.prefix.charAt(1)+(e-26):this.prefix+e,null===this.circuit.getComponentByNaming(i)){this.naming=i;break}}},Y.prototype.addIn=function(t,e,i,n){var o=new O(this,t,e,i,n);return o.index=this.ins.length,this.ins.push(o),o},Y.prototype.addOut=function(t,e,i,n,o){var r=new k(this,t,e,i,n,o);return r.index=this.outs.length,this.outs.push(r),r},Y.prototype.addOutInv=function(t,e,i,n,o){var r=new A(this,t,e,i,n,o);return r.index=this.outs.length,this.outs.push(r),r},Y.prototype.touch=function(t,e){var i=this.touchOut(t,e);if(null!==i)return new B(i,null);if(null!==(i=this.touchIn(t,e)))return new B(null,i);if(t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y-this.height/2&&e<=this.y+this.height/2)return this;for(var n=0;n<this.outs.length;n++){var o=this.outs[n].touchConnections(t,e);if(null!==o)return o}return null},Y.prototype.touchOut=function(t,e){for(var i=0;i<this.outs.length;i++)if(this.outs[i].touch(t,e))return this.outs[i];return null},Y.prototype.touchIn=function(t,e){for(var i=0;i<this.ins.length;i++)if(this.ins[i].touch(t,e))return this.ins[i];return null},Y.prototype.inRect=function(t,e){t.contains(this.x,this.y)&&e.push(this),this.outs.forEach((function(i){i.selectRect(t,e)}))},Y.prototype.delete=function(){for(var t=0;t<this.ins.length;t++)this.ins[t].clear();for(t=0;t<this.outs.length;t++)this.outs[t].clear();this.circuit.delete(this)},Y.prototype.bounds=function(){var t,e=new x(this.x-this.width/2,this.y-this.height/2,this.x+this.width/2,this.y+this.height/2),i=X(this.ins);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.expand(n.bounds())}}catch(t){i.e(t)}finally{i.f()}var o,r=X(this.outs);try{for(r.s();!(o=r.n()).done;){var s=o.value;e.expand(s.bounds())}}catch(t){r.e(t)}finally{r.f()}return e},Y.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,3),this.drawIO(t,e)},Y.prototype.drawIO=function(t,e){for(var i=0;i<this.ins.length;i++)this.selectStyle(t,e),this.ins[i].draw(t,e);for(i=0;i<this.outs.length;i++)this.selectStyle(t,e),this.outs[i].draw(t,e)},Y.prototype.save=function(){var t=this.constructor.type,e=this.naming;return null!==e&&(e=e.replace(/'/g,"`")),{id:this.id,x:this.x,y:this.y,name:e,type:t}},Y.prototype.load=function(t){this.id=this.sanitize(t.id);var e=+this.id.substr(1);e>Y.maxId&&(Y.maxId=e),this.x=+t.x,this.y=+t.y,this.moveX=this.x,this.moveY=this.y;var i=t.name;this.naming=null!==i?this.sanitize(i).replace(/`/g,"'"):null},Y.prototype.saveConnections=function(){for(var t=[],e=0;e<this.outs.length;e++)for(var i=this.outs[e],n=0;n<i.to.length;n++){var o=i.to[n].save();null!==o&&t.push(o)}return t},Y.prototype.properties=function(t){new H(this,t).open()},Y.prototype.advance=function(t){return!1},Y.prototype.pending=function(){for(var t=.1*this.delay,e=[],i=0;i<this.ins.length;i++)e.push(this.ins[i].value);null!==this.circuit.circuits&&this.circuit.circuits.simulation.queue(this,t,e)},Y.prototype.getSimulation=function(){return null!==this.circuit?this.circuit.circuits.simulation:null},Y.prototype.getDelay=function(){return this.delay},Y.prototype.compute=function(t){},Y.prototype.newTab=function(){},Y.prototype.drawName=function(t,e,i,n){null!==this.naming&&(t.beginPath(),t.font=void 0!==n?n:"14px Times",t.textAlign="center",t.fillText(this.naming,this.x+e,this.y+i),t.stroke())},Y.prototype.drawText=function(t,e,i,n,o){t.beginPath(),t.font=void 0!==o?o:"14px Times",t.textAlign="center",t.fillText(e,this.x+i,this.y+n),t.stroke()},Y.prototype.drawBox=function(t,e){if("none"!==e){var i=t.fillStyle;t.fillStyle=void 0!==e?e:"#ffffff",t.fillRect(this.x-this.width/2-.5,this.y-this.height/2-.5,this.width,this.height),t.fillStyle=i}t.beginPath(),t.rect(this.x-this.width/2-.5,this.y-this.height/2-.5,this.width,this.height),t.stroke()},Y.prototype.drawTrap=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=20);var n=this.x-this.width/2-.5,o=this.x+this.width/2+.5,r=this.y-this.height/2-.5,s=this.y+this.height/2+.5;t.fillStyle="#ffffff",t.beginPath(),t.moveTo(n,r+e),t.lineTo(n,s-e),t.lineTo(o,s-i),t.lineTo(o,r+i),t.lineTo(n,r+e),t.fill(),t.beginPath(),t.moveTo(n,r+e),t.lineTo(n,s-e),t.lineTo(o,s-i),t.lineTo(o,r+i),t.lineTo(n,r+e),t.stroke()},Y.prototype.command=function(t){if(!("string"==typeof t||t instanceof String)||"type:"!==t.substr(0,5))return null;var e=t.substr(5);if(e!==this.constructor.type){var i=this.circuit.circuits.model.main.components.get(e);return i=null!==i?i.label:e,{ok:!1,msg:"Component "+this.naming+" should be type <strong>"+i+"</strong> but is <strong>"+this.constructor.label+"</strong>"}}return{ok:!0}},Y.prototype.setAsString=function(t){},Y.prototype.testAsString=function(t,e){console.log(t)},Y.prototype.jaggedLine=function(t,e,i,n,o,r){var s=Math.round(e+(n-e)*r)+.5;i+=.5,o+=.5,t.moveTo(e,i),t.lineTo(s,i),t.lineTo(s,o),t.lineTo(n,o),t.stroke()},Y.prototype.sanitize=function(t){return M().sanitize(t)},Y.prototype.update=function(){};var V=function(t,e){var i=e.options;this.html=function(){var t="",e=i.getAPI("save"),o=i.getAPI("open");if(null!==o&&void 0===o.name&&(t+='<li><a class="file-open"><span class="icons-cl icons-cl-folder-open"></span>Open...</a></li>'),null!==e&&(t+='<li><a class="file-save"><span class="icons-cl icons-cl-disk"></span>Save</a></li>'),null!==e&&void 0===e.name&&(t+='<li><a class="file-saveas"><span class="icons-cl icons-cl-disk"></span>Save As...</a></li>'),i.loadMenu.length>0){t+=n(t);for(var r=0;r<i.loadMenu.length;r++){t+='<li><a class="cs-file-load-menu" data-index="'+r+'"><span class="icons-cl icons-cl-arrowthickstop-1-n"></span>'+i.loadMenu[r].name+"</a></li>"}}return"none"!==i.export&&(t+=n(t),"both"!==i.export&&"import"!==i.export||(t+='<li><a class="cs-file-import"><span class="icons-cl icons-cl-arrowthickstop-1-n"></span>Import</a></li>'),"both"!==i.export&&"export"!==i.export||(t+='<li><a class="cs-file-export"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Export</a></li>')),i.exportPNG&&(t+='<li><a class="cs-file-export-png"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Export PNG</a></li>'),i.imports.length>0&&(t+=n(t)+'<li><a class="cs-file-import-tab"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Import Tab</a></li>'),null!==i.exit&&(t.length>0&&(t+='<li class="menu-divider">&nbsp;</li>'),t+='<li><a class="file-exit">Exit</a></li>'),""!==t?'<li><a>File</a><ul class="file-menu">'+t+"</ul></li>":""};var n=function(t){return t.length>0?'<li class="menu-divider">&nbsp;</li>':""};this.activate=function(){t.click(".cs-file-import",(function(){e.import()})),t.click(".cs-file-export",(function(){e.export()})),t.click(".cs-file-load-menu",(function(t){var n=t.target.dataset.index;e.load(i.loadMenu[n].json)})),t.click(".cs-file-export-png",(function(t){e.currentView().exportPNG()})),t.click(".file-saveas",(function(){e.saveAs()})),t.click(".file-save",(function(){e.save()})),t.click(".file-open",(function(){e.open()})),t.click(".cs-file-import-tab",(function(){e.importTab()})),t.click(".file-exit",(function(){null!==i.exit&&(window.location.href=i.exit)}))},this.opening=function(){var i=!1,n=e.currentView().circuit;if(null!==n)for(var o=n.name,r=0;r<e.options.imports.length;r++){if(e.options.imports[r].into===o){i=!0;break}}t.enable(".cs-file-import-tab",i)}},Z=function(t,e){this.html=function(){return'<li><a>Edit</a><ul class="edit-menu"><li><a class="edit-undo"><span class="icons-cl icons-cl-arrowreturnthick-1-w"></span>Undo</a></li><li><a class="edit-delete"><span class="icons-cl icons-cl-trash"></span>Delete</a></li><li class="menu-divider">&nbsp;</li><li><a class="edit-properties">Properties</a></li></ul></li>'},this.activate=function(){t.click(".edit-delete",(function(t){console.log("delete"),e.backup(),e.currentView().delete()})),t.click(".edit-undo",(function(t){e.undo()})),t.click(".edit-properties",(function(t){1===e.currentView().selection.selection.length&&e.currentView().selection.selection[0]instanceof Y&&e.currentView().selection.selection[0].properties(e)})),document.addEventListener("keydown",(function(i){"Delete"===i.key?(t.closeAll(),e.backup(),e.currentView().delete()):"z"!==i.key||!i.ctrlKey||i.altKey||i.shiftKey||(t.closeAll(),e.undo())}))}},G=function(t){F.call(this);var e;this.open=function(){e=this.uniqueId();var t='<div class="control1 center"><label for="'.concat(e,'">New tab name: </label>\n<input class="tabname" type="text" id="').concat(e,'" spellcheck="false"></div>\n<p>Enter the name for the new tab.</p>');this.contents(t,"New Tab"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=document.getElementById(e).value;if(i=i.replace(/^\s+|\s+$/gm,""),(i=this.sanitize(i)).length<1)return this.error("Must provide a tab name"),void document.getElementById(e).select();if(i.length>8)return this.error("Name must be no longer than 8 characters"),void document.getElementById(e).select();var n=t.validateName(i);if(null!==n)return this.error(n),void document.getElementById(e).select();t.add(i),this.close()}};(G.prototype=Object.create(F.prototype)).constructor=G;var J=function(t,e,i){F.call(this),this.open=function(i,n){this.contents(e,t),!0!==n&&(this.buttonCancel=null),this.ok=function(){void 0!==i&&i(),this.close()},F.prototype.open.call(this)}};(J.prototype=Object.create(F.prototype)).constructor=J;var Q=function(t){F.call(this);var e;this.open=function(){var i=t.currentCircuit(),n=i.getName(),o=i.stats();e=this.uniqueId();var r='\n<div class="control1 center"><label for="'.concat(e,'">Tab name: </label>\n<input class="tabname" type="text" id="').concat(e,'" value="').concat(n,'" spellcheck="false" ').concat("main"===n?"disabled":"","></div>");r+="main"===n?'<p class="center"><em>The main tab cannot be renamed.</em></p>':"<p>This page presents information for the currently selected tab. Enter a new name to rename the tab.</p>",r+="<table>\n<tr><th>Property</th><th>Value</th></tr>\n<tr><td>Components</td><td>".concat(o.numComponents,"</td></tr>\n<tr><td>Connections</td><td>").concat(o.numConnections,"</td></tr>\n<tr><td>Width</td><td>").concat(o.width," pixels</td></tr>\n<tr><td>Height</td><td>").concat(o.height," pixels</td></tr>\n</table>"),this.contents(r,"New Tab"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=t.currentCircuit();if("main"!==i.getName()){var n=document.getElementById(e).value;if(n=n.replace(/^\s+|\s+$/gm,""),(n=this.sanitize(n)).length<1)return this.error("Must provide a tab name"),void document.getElementById(e).select();if(n.length>8)return this.error("Name must be no longer than 8 characters"),void document.getElementById(e).select();var o=t.validateName(n,i);if(null!==o)return this.error(o),void document.getElementById(e).select();n!==i.getName()&&t.rename(n),this.close()}else this.close()}};(Q.prototype=Object.create(F.prototype)).constructor=Q;var K=function(t,e){this.html=function(){return'<li><a>Tabs</a>\n<ul class="tabs-menu">\n<li><a class="tabs-properties"><span class="icons-cl icons-cl-wrench"></span>Properties...</a></li>\n<li><a class="tabs-add"><span class="icons-cl icons-cl-play"></span>Add...</a></li>\n<li><a class="tabs-delete"><span class="icons-cl icons-cl-close"></span>Delete...</a></li>\n<li><a class="tabs-left"><span class="icons-cl icons-cl-arrowthick-1-w"></span>Move Left</a></li>\n<li><a class="tabs-right"><span class="icons-cl icons-cl-arrowthick-1-e"></span>Move Right</a></li>\n</ul>\n</li>'};this.activate=function(){t.click(".tabs-add",(function(){new G(e.tabs).open()})),t.click(".tabs-delete",(function(){var t;null!==(t=e.tabs.currentCircuit())&&new J("Are you sure?",'<p class="large">Are you sure you want to delete the tab <em>'+t.getName()+"</em>?</p>",200).open((function(){e.tabs.delActive()}),!0)})),t.click(".tabs-properties",(function(){new Q(e.tabs).open()})),t.click(".tabs-left",(function(){var t=e.tabs;e.model.circuits.moveLeft(t.active)&&t.sync()})),t.click(".tabs-right",(function(){var t=e.tabs;e.model.circuits.moveRight(t.active)&&t.sync()}))},this.opening=function(){var i=e.tabs,n=e.model.circuits;t.enable(".tabs-delete",n.canDelete(i.active)),t.enable(".tabs-left",n.canMoveLeft(i.active)),t.enable(".tabs-right",n.canMoveRight(i.active))}},$=function(t,e){this.html=function(){return'<li><a>Options</a>\n<ul class="option-menu">\n<li><a class="option-showoutputstates">Show Output States<img></a></li>\n</ul></li>'},this.activate=function(){t.click(".option-showoutputstates",(function(t){e.options.showOutputStates=!e.options.showOutputStates,e.currentView().draw()}))},this.opening=function(){e.options.showOutputStates?U.addClass(t.find(".option-showoutputstates img"),"check"):U.removeClass(t.find(".option-showoutputstates img"),"check")}},_=function(t){F.call(this,"about"),this.open=function(){this.buttonCancel=null;var e=t.cirsim.root,i='<figure><img src="'.concat(e,'cirsim/img/logo-icon.png" alt="Cirsim Logo"></figure>\n<h1>Cirsim Circuit Simulator</h1>\n<p>Version: ').concat(t.cirsim.version,"</p>\n<p>Written by: Charles B. Owen</p>");t.cirsim.root.indexOf("cirsim-dev")>=0&&(i+='<p class="gap">Running from the development site.</p>'),this.contents(i,"About Cirsim"),F.prototype.open.call(this)}};(_.prototype=Object.create(F.prototype)).constructor=_;var tt=function(){};function et(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return it(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}tt.do=function(t){var e=new XMLHttpRequest;if("GET"===t.method){var i=[];for(var n in t.data)t.data.hasOwnProperty(n)&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(t.data[n]));e.open("GET",t.url+"?"+i.join("&"),!0)}else e.open(t.method,t.url,!0);if(e.onload=function(){if(e.status>=200&&e.status<400)if("json"===t.dataType)try{t.success(JSON.parse(e.responseText))}catch(t){console.log(t),console.log(e.responseText)}else t.success(e.responseText);else t.error(e.xhr,e.statusText,"invalid URL")},e.onerror=function(){t.error(e.xhr,e.statusText,"server not found")},"POST"===t.method)if("application/json"===t.contentType)e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(t.data));else{e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");var o=[];for(var r in t.data)t.data.hasOwnProperty(r)&&o.push(encodeURIComponent(r)+"="+encodeURIComponent(t.data[r]));e.send(o.join("&"))}else e.send()};var nt=function(t,e){var i=this,n=[];this.html=function(){return'<div class="cirsim-help">Fetching...</div>'},this.present=function(e){""===e&&(e="cirsim/help/index.html"),e=t.cirsim.root+e,this.presentAbsolute(e)},this.presentAbsolute=function(e){n.push(e),tt.do({url:e,data:{},method:"GET",success:function(t){o(t)},error:function(e,i,n){t.toast.message("Unable to communicate with server: "+n)}})};var o=function(n){if(n.indexOf("{{components}}")>0){t.cirsim.root;var o="<ul>";t.palette.palette.forEach((function(t){if(void 0!==t.help){var e=t.label;switch(e){case"0":e="Zero";break;case"1":e="One"}o+='<li><a href="'.concat(t.help,'.html">').concat(e,"</a> <em>").concat(t.desc,"</em></li>")}})),o+="</ul>",n=n.replace("{{components}}",o)}var r=t.cirsim.root;n=(n=n.replace(/src="img\//g,'src="'+r+"cirsim/help/img/")).replace(/href="/g,'href="'+r+"cirsim/help/");var s=e.element.querySelector(".cirsim-help");if(null!==s){s.innerHTML=n;var a,l=et(s.querySelectorAll("a"));try{for(l.s();!(a=l.n()).done;){a.value.addEventListener("click",(function(t){t.preventDefault(),i.presentAbsolute(t.target.href)}))}}catch(t){l.e(t)}finally{l.f()}}};this.home=function(){this.present("")},this.back=function(){if(!(n.length<2)){n.pop();var t=n[n.length-1];n.pop(),this.presentAbsolute(t)}}},ot=function(t){F.call(this,"help"),this.open=function(e){this.buttonCancel=null,this.resize="both";var i=new nt(t,this),n=i.html();this.contents(n,"Cirsim Help"),this.titleBarButtons=[{type:"custom",contents:'<span class="icons-cl icons-cl-arrowthick-1-w">',click:function(){i.back()}},{type:"custom",contents:'<span class="icons-cl icons-cl-home">',click:function(){i.home()}},{type:"close"}],F.prototype.open.call(this),i.present(e)}};(ot.prototype=Object.create(F.prototype)).constructor=ot;var rt=function(t,e){this.html=function(){return'<li><a>Help</a><ul class="help-menu"><li><a class="help-help">Help</a></li><li><a class="help-docked-help">Docked Help<img></a></li><li><a class="help-about">About...</a></li></ul></li>'},this.componentHelp=function(t){(t="cirsim/help/"+t+".html",e.isHelpDocked())?e.help.url(t):new ot(e).open(t)},this.activate=function(){t.click(".help-about",(function(t){new _(e).open()})),t.click(".help-help",(function(t){e.isHelpDocked()?e.help.home():new ot(e).open("")})),t.click(".help-docked-help",(function(t){e.dockedHelp(!e.isHelpDocked())}))},this.opening=function(){e.isHelpDocked()?U.addClass(t.find(".help-docked-help img"),"check"):U.removeClass(t.find(".help-docked-help img"),"check")}};function st(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return at(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return at(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function at(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var lt=function(t){var e=this,i=new V(this,t),n=new Z(this,t),o=new K(this,t),r=new $(this,t),s=new rt(this,t);this.helpMenu=s,this.nav=null,this.ul=null;var a=function(t){for(var i=t.target.parentNode;null!==i;i=i.parentNode)if(i===e.nav)return;e.closeAll()},l=function(t){var n,l=st(e.ul.childNodes);try{for(l.s();!(n=l.n()).done;){var u=n.value;if("LI"===u.tagName){var d=U.child(u,"UL");null!==d&&U.removeClass(d,"menu-open")}}}catch(t){l.e(t)}finally{l.f()}h(".edit-delete"),c(".edit-properties"),i.opening(),o.opening(),r.opening(),s.opening();var p=U.child(t,"UL");null!==p&&U.addClass(p,"menu-open"),document.addEventListener("click",a),document.addEventListener("mousedown",a)};this.closeAll=function(){var t,i=st(e.ul.childNodes);try{for(i.s();!(t=i.n()).done;){var n=t.value;if("LI"===n.tagName){var o=U.child(n,"UL");null!==o&&U.removeClass(o,"menu-open")}}}catch(t){i.e(t)}finally{i.f()}document.removeEventListener("click",a),document.removeEventListener("mousedown",a)},this.enable=function(t,i){var n=e.ul.querySelector(t);null!==n&&(i?U.removeClass(n.parentNode,"menu-disabled"):U.addClass(n.parentNode,"menu-disabled"))};var h=function(i){e.enable(i,t.currentView().selection.selection.length>0)},c=function(i){1===t.currentView().selection.selection.length&&t.currentView().selection.selection[0]instanceof Y?e.enable(i,!0):e.enable(i,!1)};this.find=function(t){return e.ul.querySelector(t)},this.click=function(t,i){var n=e.find(t);null!==n&&n.addEventListener("click",(function(t){t.preventDefault(),e.closeAll(),i(t)}))},function(){e.nav=document.createElement("nav"),U.addClass(e.nav,"menubar"),t.div.appendChild(e.nav);var a=document.createElement("ul");e.nav.appendChild(a),e.ul=a;var h="";h+=i.html(),h+=n.html(),t.options.tabsMenu&&(h+=o.html()),h+=r.html(),h+=s.html();var c,u=0,d=st(t.test.tests);try{for(d.s();!(c=d.n()).done;){var p=c.value;h+='<li><a class="cirsim-test-'+u+'">'+p.name+"</a></li>",u++}}catch(t){d.e(t)}finally{d.f()}a.innerHTML=h;var f,v=st(a.childNodes);try{var m=function(){var t=f.value;"LI"===t.tagName&&t.addEventListener("click",(function(i){i.preventDefault();var n=U.child(t,"UL");null!==n&&("hidden"===getComputedStyle(n).getPropertyValue("visibility")?l(t):e.closeAll())}))};for(v.s();!(f=v.n()).done;)m()}catch(t){v.e(t)}finally{v.f()}u=0;var y,g=st(t.test.tests);try{var b=function(){var i=y.value,n=".cirsim-test-"+u;e.click(n,(function(e){e.preventDefault(),t.test.runTestDlg(i)})),u++};for(g.s();!(y=g.n()).done;)b()}catch(t){g.e(t)}finally{g.f()}i.activate(),n.activate(),o.activate(),r.activate(),s.activate()}()},ht=function(t,e){this.width=t,this.height=e,this.scale=t/60;var i=e/this.scale;this.element=document.createElement("canvas"),this.element.style.width="60px",this.element.style.height=i+"px",this.element.style.backgroundColor="transparent",this.canvas=this.element,this.canvas.height=this.height,this.canvas.width=this.width,this.context=this.canvas.getContext("2d"),this.context.lineWidth=this.scale};ht.prototype.box=function(t,e){var i=this.width/2,n=this.height/2,o=i-t/2-.5,r=i+t/2+.5,s=n-e/2-.5,a=n+e/2+.5;this.context.beginPath(),this.context.moveTo(o,s),this.context.lineTo(r,s),this.context.lineTo(r,a),this.context.lineTo(o,a),this.context.lineTo(o,s),this.fillStroke()},ht.prototype.circle=function(t,e,i){t+=this.width/2,e+=this.height/2;var n=this.context.fillStyle;this.context.fillStyle="#ffffff",this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.fill(),this.context.fillStyle=n,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.stroke()},ht.prototype.io=function(t,e,i,n,o){n=void 0!==n?n:1,o=void 0!==o?o:1,t+=this.width/2,e+=this.height/2;for(var r=0;r<n;r++){this.context.beginPath(),this.context.moveTo(t,e);var s=6*this.scale;switch(i){case"w":case"W":this.context.lineTo(t-s,e);break;case"e":case"E":this.context.lineTo(t+s,e);break;case"n":case"N":this.context.lineTo(t,e-s);break;case"s":case"S":this.context.lineTo(t,e+s)}this.context.stroke(),e+=o}},ht.prototype.clock=function(t,e,i){this.io(t,e,i),this.context.beginPath();switch(t+=this.width/2,e+=this.height/2,i){case"n":case"N":this.context.moveTo(t-3,e),this.context.lineTo(t,e+3),this.context.lineTo(t+3,e)}this.context.stroke()},ht.prototype.drawText=function(t,e,i,n){var o=this.context;o.beginPath(),o.font=void 0!==n?n:"14px Times",o.textAlign="center",o.fillText(t,e+this.width/2,i+this.height/2),o.stroke()},ht.prototype.drawTextBar=function(t,e,i,n){var o=this.context,r=o.lineWidth;this.drawText(t,e,i,n),o.lineWidth=1;var s=o.measureText(t);o.beginPath(),i+=this.height/2-16,o.moveTo(e+this.width/2-s.width/2,i),o.lineTo(e+this.width/2+s.width/2,i),o.stroke(),o.lineWidth=r},ht.prototype.fillStroke=function(t){void 0===t&&(t="white");var e=this.context.fillStyle;this.context.fillStyle=t,this.context.fill(),this.context.fillStyle=e,this.context.stroke()},ht.prototype.lineWidth=function(t){var e=this.context.lineWidth;return this.context.lineWidth=t,e};var ct=function(t,e,i){this.palette=t,this.obj=e,this.circuit=void 0!==i?i.name:null;var n=this.paletteImage(e),o=U.createClassedDiv("cs-item"),r=U.createClassedDiv("cs-box");o.appendChild(r);var s=U.createClassedDiv("cs-img");r.appendChild(s),s.appendChild(n);var a=U.createClassedDiv("cs-desc");e.label.length>7&&U.addClass(a,"long"),a.innerText=void 0!==i?i.name:e.label,r.appendChild(a),this.element=o,t.main.dragAndDrop.draggable(this)};ct.prototype.paletteImage=function(){var t=this.obj;if(null!==t.img&&void 0!==t.img){var e=this.palette.cirsim.root,i=document.createElement("img");return i.setAttribute("src",e+"cirsim/img/"+t.img),i.setAttribute("alt",t.desc),i.setAttribute("title",t.desc),i.setAttribute("draggable","false"),i}if(void 0!==t.paletteImage)return t.paletteImage().element;var n=new ht(60,60);return n.box(30,40),n.io(15,20,"w",2,20),n.io(45,20,"e",2,20),n.drawText(t.label,0,0,"6px Times"),n.element};var ut=function(){};ut.roundedRect=function(t,e,i,n,o,r){n<2*r&&(r=n/2),o<2*r&&(r=o/2),t.beginPath(),t.moveTo(e+r,i),t.arcTo(e+n,i,e+n,i+o,r),t.arcTo(e+n,i+o,e,i+o,r),t.arcTo(e,i+o,e,i,r),t.arcTo(e,i,e+n,i,r),t.closePath()},ut.fillWith=function(t,e){var i=t.fillStyle;t.fillStyle=void 0!==e?e:"#ffffff",t.fill(),t.fillStyle=i},ut.fillTextWith=function(t,e,i,n,o){var r=t.fillStyle;t.fillStyle=void 0!==o?o:"#ffffff",t.fillText(e,i,n),t.fillStyle=r};function dt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return pt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ft=function(t){Y.call(this),this.height=160,this.width=80,this.circuitName=void 0!==t?t.circuit:void 0,this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[]};function vt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return mt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(ft.prototype=Object.create(Y.prototype)).constructor=ft,ft.type="CircuitRef",ft.label="REF",ft.desc="Circuit Component",ft.img="circuitref.png",ft.order=99,ft.description="<h2>Circuit Component</h2><p>A Circuit Component uses anotherCirsim circuit as a component in the current circuit</p>",ft.prototype.compute=function(t){this.getCircuitRef();for(var e=0;e<this.ins.length&&e<this.circuitIns.length;e++)this.circuitIns[e].set(t[e]);for(var i=0;i<this.outs.length&&i<this.circuitOuts.length;i++)this.outs[i].set(this.circuitOuts[i].get())},ft.prototype.advance=function(t){null!==this.circuitRef&&this.circuitRef.advance(t);for(var e=0;e<this.outs.length&&e<this.circuitOuts.length;e++)this.outs[e].set(this.circuitOuts[e].get());return!0},ft.prototype.getCircuitRef=function(){return null!==this.circuitRef?(this.circuitRef.circuits=this.circuit.circuits,this.circuitRef):null===this.circuit.circuits.getCircuit(this.circuitName)?null:(this.circuitRef=this.circuit.circuits.getCircuit(this.circuitName).copy_clone(),this.circuitRef.circuits=this.circuit.circuits,this.circuitRef.newTab(),this.circuitRef.pending(),this.ensureIO(),this.circuitRef)},ft.prototype.newTab=function(){this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[]},ft.prototype.update=function(){this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[],this.ensureIO()},ft.prototype.ensureIO=function(){var t=this.circuitRef;if(null!==t){var e=function(e,i){var n,o=t.getComponentsByType(e),r=dt(t.getComponentsByType(i));try{for(r.s();!(n=r.n()).done;){var s=n.value;o.push(s)}}catch(t){r.e(t)}finally{r.f()}return o.sort((function(t,e){return t.y===e.y?t.x-e.x:t.y-e.y})),o},i=function(t){var e,i={},n=dt(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;i[o.id]=o}}catch(t){n.e(t)}finally{n.f()}return i},n=e("InPin","InPinBus"),o=i(n);if(0===this.circuitIns.length)for(var r=0;r<n.length;r++)n[r].set(void 0);this.circuitIns=n;var s=e("OutPin","OutPinBus"),a=i(s);if(this.circuitOuts=s,n.length===this.ins.length&&s.length===this.outs.length){for(var l=!1,h=0;h<n.length;h++)if(this.ins[h].name!==n[h].naming||this.ins[h].bus!==("InPinBus"===n[h].constructor.type)){l=!0;break}for(var c=0;c<s.length;c++)if(this.outs[c].name!==s[c].naming||this.outs[c].bus!==("OutPinBus"===s[c].constructor.type)){l=!0;break}if(!l)return}var u=n.length>s.length?n.length:s.length;this.height=16*u+32,this.height<48&&(this.height=48);var d=this.width/2,p=-this.height/2+8,f=function(t,e){var i,n={},o=dt(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;null!==r.reference&&void 0!==e[r.reference]?n[e[r.reference].naming]=r:n[r.name]=r}}catch(t){o.e(t)}finally{o.f()}return n},v=f(this.ins,o);this.ins=[];var m=0;for(m=0;m<n.length;m++){var y=void 0;void 0!==v[n[m].naming]?(y=v[n[m].naming],this.ins.push(y),y.name=n[m].naming,y.x=-d,y.y=p+16*m,y.len=16,v[n[m].naming]=null):y=this.addIn(-d,p+16*m,16,n[m].naming),y.bus="InPinBus"===n[m].constructor.type,y.index=m,y.reference=n[m].id}for(var g in v)null!==v[g]&&v[g].clear();var b=f(this.outs,a);for(this.outs=[],m=0;m<s.length;m++){var w=void 0;void 0!==b[s[m].naming]?(w=b[s[m].naming],this.outs.push(w),w.name=s[m].naming,w.x=d,w.y=p+16*m,w.len=16,b[s[m].naming]=null):w=this.addOut(d,p+16*m,16,s[m].naming),w.index=m,w.bus="OutPinBus"===s[m].constructor.type,w.reference=s[m].id}for(var x in b)null!==b[x]&&b[x].clear()}},ft.prototype.clone=function(){var t=new ft;t.circuitName=this.circuitName;for(var e=0;e<this.ins.length;e++){var i=this.ins[e].clone();i.component=t,t.ins.push(i)}for(var n=0;n<this.outs.length;n++){var o=this.outs[n].clone();o.component=t,t.outs.push(o)}return null!==this.circuitRef&&(t.circuitRef=this.circuitRef.copy_clone(),t.ensureIO()),t.copyFrom(this),t},ft.prototype.load=function(t){this.circuitName=t.circuitName,Y.prototype.load.call(this,t),this.getCircuitRef()},ft.prototype.save=function(){var t=Y.prototype.save.call(this);return t.circuitName=this.circuitName,t},ft.prototype.draw=function(t,e){this.getCircuitRef(),this.ensureIO(),this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=(this.x,this.width,this.y-this.height/2-.5);this.y,this.height;t.beginPath(),t.rect(i,n,this.width,this.height),ut.fillWith(t),t.stroke(),t.font="14px Times",t.textAlign="center",null!==this.naming&&t.fillText(this.naming,this.x,this.y-10),t.fillText(this.circuitName,this.x,this.y+this.height/2-5),t.stroke(),this.drawIO(t,e)};var yt=function(t,e){var i=this;this.main=t,this.cirsim=t.cirsim,this.palette=[];var n=null,o=[],r=function(e){var r=e.type;if(b.inArray(r,o)||b.inArray(r,t.options.always)){i.palette.push(e);var s=new ct(i,e);n.appendChild(s.element)}};this.refresh=function(){var e,i=vt(n.querySelectorAll(".cs-circuitref"));try{for(i.s();!(e=i.n()).done;){var o=e.value;n.removeChild(o)}}catch(t){i.e(t)}finally{i.f()}for(var r=t.currentView().tabnum+1;r<t.model.circuits.circuits.length;r++){var s=t.model.circuits.circuits[r],a=new ct(this,ft,s);a.element.classList.add("cs-circuitref"),n.appendChild(a.element)}},function(){if(n=U.createClassedDiv("cs-palette"),e.appendChild(n),"string"==typeof t.options.components){if(null===(o=t.components.getPalette(t.options.components)))throw new Error("options.components invalid name "+t.options.components)}else t.options.components.forEach((function(e){var i=t.components.getPalette(e);null!==i?o=o.concat(i):("not"===e.toLowerCase()&&(e="Inverter"),"decoder"===e.toLowerCase()&&(e="BusDecoder"),o.push(e))}));t.components.components.forEach((function(t){r(t)}))}()},gt=function(){};gt.sanitize=function(t){return M().sanitize(t)},gt.boolean=function(t){return!0===t},gt.htmlentities=function(t){return t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")};var bt=i(43096),wt=i.n(bt),xt=0,Tt=function(){var t=this;this.time=1,this.view=null,this.speed=1e-6,this.instance=++xt,this.order=1,this.priorityQueue=new(wt().PriorityQueue)((function(t,e){return t.time===e.time?e.order-t.order:e.time-t.time})),this.setView=function(t){this.view=t,null===this.view||e||(e=!0,requestAnimationFrame(o))};var e=!1,i=null,n=!1,o=function o(r){e=!1,null===i&&(i=r);var s=.001*(r-i);for(i=r,s>1&&(s=1);s>0;){var a=s;a>.03&&(a=.03),t.advance(a*t.speed)&&null!==t.view&&t.view.draw(),s-=a}null===t.view||n||(e=!0,requestAnimationFrame(o))};this.kill=function(){n=!0}};function It(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return St(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return St(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tt.prototype.queue=function(t,e,i){var n=1e-9*e;this.priorityQueue.add({time:this.time+n,order:this.order,component:t,state:i}),this.order++},Tt.prototype.advance=function(t){for(var e=!1;!this.priorityQueue.isEmpty()&&this.priorityQueue.peek().time<=this.time+t;){var i=this.priorityQueue.dequeue(),n=i.time-this.time;t-=n,this.time=i.time,n>0&&null!==this.view&&this.view.advance(n)&&(e=!0),i.component.compute(i.state),e=!0}return this.time+=t,t>0&&null!==this.view&&this.view.advance(t)&&(e=!0),e};var kt=function(t,e){this.model=t,this.circuits=[],this.grid=8,this.snap=!0,this.id=null!==t?t.id:void 0,this.simulation=e||new Tt,this.prev=null};function Ot(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return At(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return At(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}kt.prototype.add=function(t){return this.circuits.push(t),t.circuits=this,t},kt.prototype.insert=function(t){return this.circuits.unshift(t),t.circuits=this,t},kt.prototype.getCircuits=function(){return this.circuits.slice()},kt.prototype.getCircuit=function(t){for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e];if(i.name===t)return i}return null},kt.prototype.advance=function(t){for(var e=!1,i=0;i<this.circuits.length;i++){this.circuits[i].advance(t)&&(e=!0)}return e},kt.prototype.canDelete=function(t){if(0===t)return!1;for(var e=this.circuits[t],i=0;i<t;i++){if(this.circuits[i].references(e).length>0)return!1}return!0},kt.prototype.canMoveLeft=function(t){if(t<2)return!1;var e=this.circuits[t];return 0===this.circuits[t-1].references(e).length},kt.prototype.canMoveRight=function(t){if(0===t||t===this.circuits.length-1)return!1;var e,i=this.circuits[t+1].name,n=It(this.circuits[t].references());try{for(n.s();!(e=n.n()).done;){if(e.value.circuitName===i)return!1}}catch(t){n.e(t)}finally{n.f()}return!0},kt.prototype.moveLeft=function(t){if(this.canMoveLeft(t)){this.model.backup();var e=this.circuits[t-1];return this.circuits[t-1]=this.circuits[t],this.circuits[t]=e,!0}return!1},kt.prototype.moveRight=function(t){if(this.canMoveRight(t)){this.model.backup();var e=this.circuits[t+1];return this.circuits[t+1]=this.circuits[t],this.circuits[t]=e,!0}return!1},kt.prototype.rename=function(t,e){this.model.backup();for(var i=this.circuits[t],n=0;n<t;n++){var o,r=It(this.circuits[n].references(i));try{for(r.s();!(o=r.n()).done;){o.value.circuitName=e}}catch(t){r.e(t)}finally{r.f()}}i.setName(e)},kt.prototype.newTab=function(){for(var t=this.circuits.length-1;t>=0;t--)this.circuits[t].newTab()},kt.prototype.recompute=function(){for(var t=this.circuits.length-1;t>=0;t--)this.circuits[t].recompute()},kt.prototype.clone=function(){var t=new kt(this.model,this.simulation);t.grid=this.grid,t.snap=this.snap,t.prev=this.prev,this.prev=t;for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e];t.add(i.clone())}return t},kt.prototype.update=function(t){var e,i=It(this.circuits);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n===t)break;n.update()}}catch(t){i.e(t)}finally{i.f()}},kt.prototype.toJSON=function(){return JSON.stringify(this.save())},kt.prototype.fmJSON=function(t){var e=JSON.parse(t);this.load(e)},kt.prototype.save=function(){for(var t=[],e=0;e<this.circuits.length;e++){var i=this.circuits[e];t.push(i.save())}var n={grid:this.grid,circuits:t,id:this.id};return this.snap&&(n.snap=!0),n},kt.prototype.load=function(t){this.grid=+t.grid,this.snap=gt.boolean(t.snap),this.prev=null,this.circuits=[],void 0!==t.id&&(this.id=gt.sanitize(t.id));for(var e=t.circuits.length-1;e>=0;e--){var i=t.circuits[e],n=new Ct(i.name);this.insert(n),n.load(i)}for(var o=this.circuits.length-1;o>=0;o--)this.circuits[o].pending()},kt.prototype.addCircuit=function(t){var e=new Ct(t);this.add(e)},kt.prototype.deleteCircuitByIndex=function(t){this.circuits.splice(t,1)},kt.prototype.getComponentByNaming=function(t){for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e].getComponentByNaming(t);if(null!==i)return i}return null},kt.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.circuits.length;i++){var n=this.circuits[i].getComponentsByType(t);e=e.concat(n)}return e},kt.prototype.replaceCircuit=function(t){t.circuits=this;for(var e=0;e<this.circuits.length;e++)if(this.circuits[e].name===t.name){this.circuits[e]=t,t.components.forEach((function(t){t.pending()})),this.model.newTab();break}};var Ct=function(t){this.circuits=null,this.components=[],this.name=t,this.width=this.defWidth,this.height=this.defHeight,this.prev=null,this.touch=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touch(t,e);if(null!==n)return n}return null},this.advance=function(t){for(var e=!1,i=0;i<this.components.length;i++){this.components[i].advance(t)&&(e=!0)}return e}};function Et(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return zt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Ct.prototype.defWidth=1920,Ct.prototype.defHeight=1080,Ct.prototype.clone=function(){var t=new Ct(this.name);t.width=this.width,t.height=this.height,t.prev=this.prev,this.prev=t;for(var e=0;e<this.components.length;e++){var i=(o=this.components[e]).clone();t.add(i)}for(var n=0;n<this.components.length;n++)for(var o=this.components[n],r=0;r<o.outs.length;r++)for(var s=o.outs[r],a=0;a<s.to.length;a++)s.to[a].clone();return t},Ct.prototype.copy_clone=function(){var t=new Ct(this.name);t.width=this.width,t.height=this.height;for(var e=0;e<this.components.length;e++){var i=(n=this.components[e]).clone();t.add(i)}for(e=0;e<this.components.length;e++)for(var n=this.components[e],o=0;o<n.outs.length;o++)for(var r=n.outs[o],s=0;s<r.to.length;s++)r.to[s].clone();return t},Ct.prototype.update=function(){var t,e=Ot(this.components);try{for(e.s();!(t=e.n()).done;){t.value.update()}}catch(t){e.e(t)}finally{e.f()}},Ct.prototype.draw=function(t,e){this.components.forEach((function(i,n,o){i.draw(t,e)}))},Ct.prototype.newTab=function(){for(var t=0;t<this.components.length;t++){this.components[t].newTab()}},Ct.prototype.recompute=function(){for(var t=0;t<this.components.length;t++)this.components[t].pending()},Ct.prototype.inRect=function(t){for(var e=[],i=this.components.length-1;i>=0;i--)this.components[i].inRect(t,e);return e},Ct.prototype.snapIt=function(t){this.circuits.snap&&(t.x=this.circuits.grid*Math.round(t.x/this.circuits.grid),t.y=this.circuits.grid*Math.round(t.y/this.circuits.grid))},Ct.prototype.add=function(t){return this.components.push(t),t.added(this),t},Ct.prototype.delete=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e]===t){this.components.splice(e,1);break}},Ct.prototype.touchIn=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touchIn(t,e);if(null!==n)return n}return null},Ct.prototype.touchOut=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touchOut(t,e);if(null!==n)return n}return null},Ct.prototype.save=function(){for(var t=[],e=0;e<this.components.length;e++){var i=this.components[e];t.push(i.save())}for(var n=[],o=0;o<this.components.length;o++){var r=this.components[o];n=n.concat(r.saveConnections())}return{name:this.name,width:this.width,height:this.height,components:t,connections:n}},Ct.prototype.load=function(t){this.name=gt.sanitize(t.name),this.width=+t.width,this.height=+t.height;for(var e={},i=0;i<t.components.length;i++){var n=t.components[i],o=void 0;if(null!==(o="CircuitRef"===n.type?ft:this.circuits.model.main.components.get(n.type))){var r=new o;r.circuit=this,r.load(n),e[r.id]=r,this.add(r)}else console.log(n)}for(var s=0;s<t.connections.length;s++){var a=t.connections[s],l=e[a.from];if(void 0!==l){var h=e[a.to];if(void 0!==h){var c=a.out,u=a.in,d=this.connect(l,c,h,u);null!==d&&d.load(a)}else console.log("To object undefined"),console.log(this),console.log(a)}else console.log("From object undefined"),console.log(this),console.log(a)}},Ct.prototype.getComponentByNaming=function(t){for(var e=0;e<this.components.length;e++){var i=this.components[e];if(i.naming===t)return i}return null},Ct.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.components.length;i++){var n=this.components[i];n.constructor.type===t&&e.push(n)}return e},Ct.prototype.mouseUp=function(){for(var t=0;t<this.components.length;t++){this.components[t].mouseUp()}},Ct.prototype.connect=function(t,e,i,n){return t.outs.length<=e||i.ins.length<=n?null:new B(t.outs[e],i.ins[n])},Ct.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.components.length;i++){var n=this.components[i];n.constructor.type===t&&e.push(n)}return e},Ct.prototype.maxXY=function(){for(var t=1,e=1,i=0;i<this.components.length;i++){var n=this.components[i].bounds();n.right>t&&(t=n.right),n.bottom>e&&(e=n.bottom)}return{x:t+16,y:e+16}},Ct.prototype.bounds=function(){if(0===this.components.length)return new x;for(var t=this.components[0].bounds(),e=0;e<this.components.length;e++){var i=this.components[e].bounds();t.expand(i)}return t},Ct.prototype.pending=function(){for(var t=0;t<this.components.length;t++){this.components[t].pending()}},Ct.prototype.getName=function(){return this.name},Ct.prototype.setName=function(t){this.name=t},Ct.prototype.stats=function(){var t=0;return this.components.forEach((function(e){e.outs.forEach((function(e){t+=e.to.length}))})),{name:this.name,numComponents:this.components.length,numConnections:t,width:this.width,height:this.height}},Ct.prototype.moveToFront=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e]===t){this.components.splice(e,1),this.components.push(t);break}},Ct.prototype.references=function(t){var e,i=[],n=Ot(this.components);try{for(n.s();!(e=n.n()).done;){var o=e.value;o instanceof ft&&(void 0!==t?o.circuitName===t.name&&i.push(o):i.push(o))}}catch(t){n.e(t)}finally{n.f()}return i};var Bt=function(t){this.main=t,this.circuits=new kt(this),this.circuits.add(new Ct("main"))};Bt.prototype.getCircuit=function(t){return this.circuits.getCircuit(t)},Bt.prototype.undo=function(){null!==this.circuits.prev&&(this.circuits=this.circuits.prev)},Bt.prototype.backup=function(){this.circuits.clone()},Bt.prototype.status=function(){var t,e=0,i=this.circuits,n=Et(i.circuits);try{for(n.s();!(t=n.n()).done;){for(var o=t.value,r=0,s=o;null!==s;)r++,s=s.prev;console.log("circuit depth: "+r)}}catch(t){n.e(t)}finally{n.f()}for(;null!==i;)e++,i=i.prev;console.log("circuits depth: "+e)},Bt.prototype.update=function(t){this.circuits.update(t)},Bt.prototype.toJSON=function(){return this.circuits.toJSON()},Bt.prototype.fmJSON=function(t){this.circuits.simulation.setView(null),this.circuits=new kt(this),this.circuits.fmJSON(t)},Bt.prototype.getSimulation=function(){return this.circuits.simulation},Bt.prototype.newTab=function(){this.circuits.newTab(),this.recompute()},Bt.prototype.recompute=function(){this.circuits.recompute()},Bt.prototype.addCircuit=function(t){this.backup(),this.circuits.addCircuit(t)},Bt.prototype.deleteCircuitByIndex=function(t){this.backup(),this.circuits.deleteCircuitByIndex(t)},Bt.prototype.getComponentByNaming=function(t){return this.circuits.getComponentByNaming(t)},Bt.prototype.getComponentsByType=function(t){return this.circuits.getComponentsByType(t)},Bt.prototype.replaceCircuit=function(t){this.circuits.replaceCircuit(t)},Bt.prototype.kill=function(){this.getSimulation().kill()};var Nt=function(t){var e=this;this.selection=[];var i=!1,n=!1,o=null;this.mouseDown=function(e,r,s){i=!0,n=!0;var a=t.circuit.touch(e,r);null!==a?a.single()?this.selection=[a]:this.isSelected(a)||(s.shiftKey||(this.selection=[]),this.selection.push(a)):(s.shiftKey||(this.selection=[]),o=new x(e,r,e,r));for(var l=0;l<this.selection.length;l++)this.selection[l].grab()},this.mouseMove=function(e,r,s,a){if(i){if(n){if(null===o&&this.selection.length>0&&t.model.backup(),1===this.selection.length){var l=this.selection[0].spawn(e,r);null!==l&&(this.selection=[l])}n=!1}if(null!==o)o.setRightBottom(e,r);else for(var h=0;h<this.selection.length;h++)this.selection[h].move(s,a);t.model.update(t.circuit)}},this.mouseUp=function(e,n){if(i){for(var s=!1,a=0;a<this.selection.length;a++)this.selection[a].single()&&(s=!0),this.selection[a].drop();s&&(this.selection=[])}i=!1,null!==o&&(r(),o=null),t.circuit.mouseUp()};var r=function(){if(o.normalize(),!o.isEmpty()){var i=t.circuit.inRect(o);if(i.length>0){for(var n=e.selection.slice(),r=0;r<i.length;r++)e.isSelected(i[r])||n.push(i[r]);e.selection=n}}};this.isSelected=function(t){for(var e=0;e<this.selection.length;e++)if(t===this.selection[e])return!0;return!1},this.draw=function(t){null!==o&&(t.setLineDash||(t.setLineDash=function(){}),t.strokeStyle="#888888",t.setLineDash([2,3]),t.beginPath(),t.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),t.stroke(),t.setLineDash([]))},this.getSelection=function(){return this.selection},this.clear=function(){this.selection=[]}};Nt.prototype.delete=function(){this.selection.forEach((function(t){t.delete()})),this.clear()};function Pt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Lt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Lt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Rt=function(t){this.api=t};Rt.prototype.errors=function(){return void 0!==this.api.errors?this.api.errors:null},Rt.prototype.fetch=function(t){if(void 0===this.api.data)return[];var e=[];return this.api.data.forEach((function(i){i.type===t&&e.push(i)})),e},Rt.prototype.getData=function(t){if(void 0===this.api.data)return[];var e,i=Pt(this.api.data);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.type===t)return n}}catch(t){i.e(t)}finally{i.f()}return null};var jt=function(t,e,i){F.call(this),this.buttonOk=null,this.open=function(n){var o=this;this.contents("<p>Loading tab from server...</p>","Loading tab..."),F.prototype.open.call(this);var r=e.getAPI("import"),s={};Object.assign(s,r.extra),Object.assign(s,t.extra),null!==r&&tt.do({url:r.url,data:Object.assign({cmd:"open",name:t.name},s),method:"GET",dataType:"json",success:function(t){var e=new Rt(t);if(!i.jsonErrors(e)){var r=t.data[0].attributes.data;n(r)}o.close()},error:function(t,e,n){console.log(t.responseText),i.message("Unable to communicate with server: "+n),o.close()}})}};(jt.prototype=Object.create(F.prototype)).constructor=jt;i(92060);var Ut=i(13113),Dt=function(t){F.call(this);var e=this.uniqueId();this.open=function(){var t='<div class="control"><label for="'.concat(e,'">Name</label>\n<input type="text" id="').concat(e,'" value="circuit" class="text ui-widget-content ui-corner-all">\n</div>\n<p>Enter a name for the exported .png file.</p>');this.buttonOk="Export",this.contents(t,"Cirsim Export PNG"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=this.sanitize(document.getElementById(e).value).replace(/^\s+|\s+$/gm,"").replace(/\.[^/.]+$/,"");if(0===i.length)this.error("You must supply a name");else{this.close(),i.endsWith(".png")||(i+=".png");var n=t.circuit,o=document.createElement("canvas"),r=n.bounds(),s=r.right-r.left+2,a=r.bottom-r.top+2;o.style.width=s+"px",o.style.height=a+"px",o.width=s,o.height=a;var l=o.getContext("2d");l.fillStyle="white",l.fillRect(0,0,o.width,o.height),l.translate(1-r.left,1-r.top),n.draw(l,t),o.toBlob((function(t){(0,Ut.Z)(t,i)}))}}};(Dt.prototype=Object.create(F.prototype)).constructor=Dt;var Mt=function(t,e,i){var n=this;Object.defineProperties(this,{main:{get:function(){return t}},circuit:{get:function(){return i},set:function(t){i=t}},element:{get:function(){return e}},model:{get:function(){return i.circuits.model}}}),this.selection=new Nt(this),this.tabnum=-1,e.addEventListener("dragover",(function(t){t.preventDefault()})),e.addEventListener("drop",(function(t){t.preventDefault()})),this.initialize=function(){n.setSize(),t.dragAndDrop.droppable(n,(function(t,e,i){var o=t.obj;if(void 0!==o){n.model.backup();var r=new o(t);r.brand(),r.x=e,r.y=i,n.circuit.add(r),n.circuit.snapIt(r),n.ensureSize(),n.draw()}}));var i={x:0,y:0},o={x:0,y:0},r={x:0,y:0},s=function(s,c,u,d){var p=U.offset(e);r={x:s,y:c},o.x=s-p.left,o.y=c-p.top,i.x=o.x,i.y=o.y,"inline"!==t.options.display?(n.selection.mouseDown(o.x,o.y,d),n.draw(),u?e.addEventListener("touchmove",h):e.addEventListener("mousemove",l),e.parentNode.addEventListener("scroll",a)):n.circuit.touch(o.x,o.y)},a=function(){var t=U.offset(e);o.x=r.x-t.left,o.y=r.y-t.top,n.selection.mouseMove(o.x,o.y,o.x-i.x,o.y-i.y),i.x=o.x,i.y=o.y,n.draw()},l=function(t){t.preventDefault(),c(t.pageX,t.pageY,!1)},h=function(t){t.preventDefault();var e=t.changedTouches[0];c(e.pageX,e.pageY,!0)},c=function(t,s,a){if(t!==r.x||s!==r.y){var l=U.offset(e);r={x:t,y:s},o.x=t-l.left,o.y=s-l.top,n.selection.mouseMove(o.x,o.y,o.x-i.x,o.y-i.y),n.ensureSize(),i.x=o.x,i.y=o.y,n.draw()}},u=function(t,r,s){e.parentNode.removeEventListener("scroll",a);var l=U.offset(e);o.x=t-l.left,o.y=r-l.top,n.selection.mouseUp(o.x,o.y),i.x=o.x,i.y=o.y,n.draw()};e.addEventListener("mousedown",(function(t){t.preventDefault(),s(t.pageX,t.pageY,!1,t)})),e.addEventListener("dblclick",(function(e){(e.preventDefault(),1===n.selection.selection.length&&n.selection.selection[0]instanceof Y)&&n.selection.selection[0].properties(t)})),document.querySelector("body").addEventListener("mouseup",(function(t){e.removeEventListener("mousemove",l),u(t.pageX,t.pageY,!1)})),e.addEventListener("touchstart",(function(t){t.preventDefault();var e=t.changedTouches[0];s(e.pageX,e.pageY,!0,t)})),e.addEventListener("touchend",(function(t){t.preventDefault();var e=t.changedTouches[0];u(e.pageX,e.pageY,!0)})),e.addEventListener("touchcancel",(function(t){var e=t.changedTouches[0];u(e.pageX,e.pageY,!0)}))},this.draw=function(){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),this.circuit.draw(t,this),this.selection.draw(t)},this.delete=function(){this.model.backup(),this.selection.delete(),this.draw()},this.advance=function(t){return this.circuit.circuits.advance(t)},this.ensureSize=function(){var t=this.circuit.bounds(),n=t.right+1,o=t.bottom+1;n>e.offsetWidth&&(e.style.width=n+"px",e.setAttribute("width",n),i.width=n),o>e.offsetHeight&&(e.style.height=t.bottom+"px",e.setAttribute("height",t.bottom),i.height=t.bottom)},this.setSize=function(){e.offsetWidth===this.circuit.width&&e.offsetHeight===this.circuit.height||(e.style.width=this.circuit.width+"px",e.style.height=this.circuit.height+"px",e.width=this.circuit.width,e.height=this.circuit.height)},this.initialize(),this.draw()};function qt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Ft(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ft(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Mt.prototype.importTab=function(t){var e=this;this.selection.clear(),new jt(t,this.main.options,this.main.toast).open((function(i){e.model.backup();var n=new Bt(e.main);n.fmJSON(i);var o=n.getCircuit(t.from);null!==o&&(o.name=t.into,e.main.model.replaceCircuit(o),e.circuit=o,e.draw())}))},Mt.prototype.exportPNG=function(){new Dt(this).open()};var Ht=function(t){var e=this;this.active=-1;var i=[],n=null,o=null,r=null;this.size=function(){return i.length},this.create=function(t){n=U.createClassedDiv("tabs"),o=document.createElement("ul"),n.appendChild(o),r=U.createClassedDiv("panes"),n.appendChild(r),t.appendChild(n),i=[],e.sync()},this.sync=function(){if(function(){var e=t.model.circuits.getCircuits();if(i.length!==e.length)return!0;for(var n=0;n<i.length;n++){if(i[n].circuit!==e[n])return!0;if(i[n].li.querySelector("a").textContent!==e[n].getName())return!0}return!1}()){var e=this.active>=0?i[this.active].circuit:null,a=t.model.circuits.getCircuits();r=U.createClassedDiv("panes"),o=document.createElement("ul");var l=[];a.forEach((function(e){var n=document.createElement("li"),a=document.createElement("a");n.appendChild(a),a.innerText=e.getName(),n.addEventListener("click",(function(t){t.preventDefault(),s(n)})),a.addEventListener("click",(function(t){t.preventDefault(),s(n)})),o.appendChild(n);var h=null,c=null;for(var u in i)e===i[u].circuit&&(h=i[u].pane,c=i[u].view);if(null===h){h=U.createClassedDiv("tab");var d=document.createElement("canvas");h.appendChild(d),c=new Mt(t,d,e)}r.appendChild(h),c.tabnum=l.length,l.push({li:n,pane:h,circuit:e,view:c})})),n.innerHTML="",n.appendChild(o),n.appendChild(r),i=l,this.selectTabByCircuit(e)}},this.selectTabByCircuit=function(t){if(null===t)this.selectTab(0,!0);else{var e=!1;for(var n in i)if(t===i[n].circuit){e=!0,this.selectTab(n,!0);break}e||(this.active>=i.length?this.selectTab(this.active-1):this.selectTab(this.active))}};var s=function(t){for(var n=0;n<i.length;n++)i[n].li===t&&e.selectTab(n)};this.selectTab=function(n,o){if(!0===o||n!==e.active){i.forEach((function(t){U.removeClass(t.li,"selected"),U.removeClass(t.pane,"selected")})),e.active=+n;var r=i[e.active];U.addClass(r.li,"selected"),U.addClass(r.pane,"selected"),r.view.draw(),t.model.getSimulation().setView(r.view),t.newTab()}},this.currentView=function(){return e.active<0?null:i[e.active].view},this.currentCircuit=function(){return e.active<0?null:i[e.active].circuit},this.undo=function(){var t=this.active>=0?i[this.active].circuit:null;null!==t&&(t=t.prev),this.active=-1;var e,n=qt(i);try{for(n.s();!(e=n.n()).done;){e.value.view.selection.clear()}}catch(t){n.e(t)}finally{n.f()}this.sync();var o,r=qt(i);try{for(r.s();!(o=r.n()).done;){o.value.view.draw()}}catch(t){r.e(t)}finally{r.f()}this.selectTabByCircuit(t)},this.destroy=function(){this.active=-1,n.parentNode.removeChild(n),n=null,i=[]},this.validateName=function(e,i){for(var n=t.model.circuits.getCircuits(),o=0;o<n.length;o++){var r=n[o];if(r!==i&&e.toLowerCase()===r.getName().toLowerCase())return"Name "+e+" already in use by another tab"}return null},this.add=function(e){t.model.addCircuit(e),this.sync(),this.selectTab(i.length-1,!0)},this.delActive=function(i){e.active<0||(t.model.deleteCircuitByIndex(e.active),e.sync())},this.rename=function(e){t.model.circuits.rename(this.active,e),this.sync()}},Xt=function(t){F.call(this);var e=this.uniqueId();this.open=function(){var t='<div class="control"><label for="'.concat(e,'">Name</label>\n<input type="text" id="').concat(e,'" value="circuit" class="text ui-widget-content ui-corner-all">\n</div>\n<p>Enter a name for the exported .cirsim file.</p>');this.buttonOk="Export",this.contents(t,"Cirsim Export"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=this.sanitize(document.getElementById(e).value).replace(/^\s+|\s+$/gm,"").replace(/\.[^/.]+$/,"");if(0===i.length)this.error("You must supply a name");else{this.close(),i.endsWith(".cirsim")||(i+=".cirsim");var n=t.toJSON();(0,Ut.Z)(new Blob([n],{type:"application/json"}),i)}}};(Xt.prototype=Object.create(F.prototype)).constructor=Xt;var Wt=function(t,e){F.call(this);var i=this,n=P.uniqueName(),o='<div class="control gap"><input class="file" type="file" id="'+n+'" /><br><span id="import-error" class="error"></span></div><p>Choose a file to import into Cirsim.</p>';this.ok=function(){var o=document.getElementById(n).files;if(!(o.length<1)){var r=o[0],s=new FileReader;s.onload=function(n){e.fmJSON(n.target.result),i.close(),t.reload()},s.onerror=function(t){i.error("Error reading circuits file")},s.onabort=function(t){i.error("Circuits file read aborted")},s.readAsText(r)}},this.buttonOk="Import",this.contents(o,"Cirsim Import")};(Wt.prototype=Object.create(F.prototype)).constructor=Wt;var Yt=function t(e,i){this.value=void 0,this.type=void 0!==i?i:t.AUTO,void 0!==e&&this.set(e)};Yt.AUTO=0,Yt.BINARY=1,Yt.HEX=2,Yt.FLOAT16=3,Yt.prototype.get=function(){return this.value},Yt.prototype.getBit=function(t){if(!(this.value.length<=t))return this.value[t]},Yt.prototype.set=function(t){Array.isArray(t)?this.value=t.slice():t instanceof Yt?this.value=t.value.slice():"string"==typeof t||t instanceof String?this.setAsString(t):this.value=t},Yt.prototype.setZero=function(t){this.value=[];for(var e=0;e<t;e++)this.value.push(!1)},Yt.prototype.clone=function(){return new Yt(this.value,this.type)},Yt.prototype.save=function(t){t.value=this.value,this.type!==Yt.AUTO&&(t.valuetype=this.type)},Yt.prototype.equals=function(t){if(this.value===t.value)return!0;if(Array.isArray(this.value)&&Array.isArray(t.value)&&this.value.length===t.value.length){for(var e=0;e<this.value.length;e++)if(this.value[e]!==t.value[e])return!1;return!0}return!1},Yt.prototype.load=function(t){this.set(t.value),void 0!==t.valuetype&&(this.type=t.valuetype)},Yt.prototype.getAsString=function(){if(void 0===this.value)return"?";switch(this.type){default:return this.value.length>8?this.getAsHex():this.getAsBinary();case Yt.BINARY:return this.getAsBinary();case Yt.HEX:return this.getAsHex();case Yt.FLOAT16:return this.getAsFloat16()}},Yt.prototype.setAsString=function(t,e){if("string"==typeof t||t instanceof String||(t=t.toString()),(t=(t=(t=gt.sanitize(t)).replace(/^\s+|\s+$/gm,"")).toLowerCase()).indexOf("inf")>=0||"nan"===t)return this.setAsFloat16(t,e);var i=t.substr(0,2);if("0x"===i)return this.setAsHex(t.substr(2),e);if("0b"===i)return this.setAsBinary(t.substr(2),e);if(t.indexOf(".")>=0||t.indexOf("e")>=0||t.indexOf("-")>=0)return this.setAsFloat16(t,e);switch(this.type){default:case Yt.BINARY:return this.setAsBinary(t,e);case Yt.HEX:return this.setAsHex(t,e);case Yt.FLOAT16:return this.setAsFloat16(t,e)}},Yt.prototype.draw=function(t,e,i,n,o){t.save(),t.translate(e,i),t.font="14px Times",t.textAlign="left";var r=0;null!=o&&(r=t.measureText(o+": ").width);var s=this.getAsString(),a=r+t.measureText(s).width,l=1;a>n&&(l=n/a,t.scale(l,l));r>0&&t.fillText(o+": ",-a/2,5),(this.type==Yt.HEX||this.type==Yt.AUTO&&Array.isArray(this.value)&&this.value.length>8)&&(t.font="bold 14px Times"),t.fillText(s,-a/2+r,5),t.restore()},Yt.prototype.dialogContent=function(t,e){var i=this,n=t.uniqueId(),o=t.uniqueId(),r=function(t,e,n){return'<input type="radio" name="'.concat(o,'" value="').concat(n,'"').concat(i.type===n?" checked":"","> ").concat(e)},s="";if(e){var a;switch(this.type){default:case Yt.BINARY:a="0b"+this.getAsBinary();break;case Yt.HEX:a="0x"+this.getAsHex();break;case Yt.FLOAT16:a=this.getAsFloat16()}s+='<div class="control"><label for="'+n+'">Value</label><input type="text" id="'+n+'" name="'+n+'" value="'+a+'" spellcheck="false" onfocus=" this.select()"></div>'}return{html:s+='<div class="control">'+r(0,"Auto",Yt.AUTO)+"<br>"+r(0,"Hexadecimal",Yt.HEX)+"<br>"+r(0,"Binary",Yt.BINARY)+"<br>"+r(0,"Float-16",Yt.FLOAT16)+"</div>",validate:function(){if(e){var t=i.type;i.type=parseInt(document.querySelector('input[name="'+o+'"]:checked').value);var r=document.getElementById(n).value,s=i.setAsString(r,!0);if(i.type=t,!s)return"Invalid value"}return null},accept:function(){if(i.type=parseInt(document.querySelector('input[name="'+o+'"]:checked').value),e){var t=document.getElementById(n).value;i.setAsString(t,!1)}}}},Yt.prototype.dialogOptions=function(t,e,i){var n=this.dialogContent(t,e);t.extra(n.html,n.validate,(function(){n.accept(),void 0!==i&&i()}),e?170:130)},Yt.prototype.getAsInteger=function(){if(!Array.isArray(this.value))return"?";for(var t=0,e=1,i=0;i<this.value.length;i++,e*=2){if(void 0===this.value[i])return"?";this.value[i]&&(t+=e)}return t},Yt.prototype.setAsInteger=function(t,e){for(var i=[],n=0;n<e;n++)i.push(1==(1&t)),t>>=1;return this.value=i,!0},Yt.prototype.getAsHex=function(){if(!Array.isArray(this.value))return"?";for(var t="",e=0;e<this.value.length;e+=4){for(var i=1,n=0,o=0;o<4&&e+o<this.value.length;o++,i*=2){if(void 0===this.value[e+o]){n=-1;break}this.value[e+o]&&(n+=i)}t=n<0?"?"+t:Number(n).toString(16)+t}return t},Yt.prototype.setAsHex=function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var o=t.substr(n,1);if(" "!==o)if("?"===o)i.push([void 0,void 0,void 0,void 0]);else{var r=parseInt(o,16);if(isNaN(r))return!1;i.push(1==(1&r),2==(2&r),4==(4&r),8==(8&r))}else if(i.length>0)break}return e||(this.value=i),!0},Yt.prototype.getAsBinary=function(){return function t(e){if(Array.isArray(e)){var i="";return e.forEach((function(e){i=t(e)+i})),i}return void 0===e?"?":e?"1":"0"}(this.value)},Yt.prototype.setAsBinary=function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var o=t.substr(n,1);if(" "!==o)switch(o){case"0":i.push(!1);break;case"1":i.push(!0);break;case"?":i.push(void 0);break;default:return!1}else if(i.length>0)break}return e||(this.value=i),!0},Yt.prototype.setInfinity16=function(t){this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,t]},Yt.prototype.getAsFloat16=function(){if(this.value.length<16)return"?";for(var t=this.value[15]?"-":"",e=0;e<15&&!this.value[e];e++);if(e>=15)return t+"0";var i=1,n=0;for(e=10;e<15;e++,i*=2)this.value[e]&&(n+=i);if(31==n){for(e=0;e<10;e++)if(this.value[e])return"NaN";return t+"inf"}n-=15;var o=1;i=.5;for(e=9;e>=0;e--,i/=2)this.value[e]&&(o+=i);return t+(o*=Math.pow(2,n)).toExponential(3)},Yt.prototype.setAsFloat16=function(t,e){var i=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];if("inf"===t)return e||(this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1]),!0;if("-inf"===t)return e||(this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!0]),!0;if("nan"===t)return e||(this.value=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]),!0;var n=parseFloat(t);if(isNaN(n))return!1;if(0==n)return e||(this.value=i),!0;var o=n<0;o&&(n=-n);for(var r=0;n>1&&r<16;)n/=2,r++;if(r>=15)return e||this.setInfinity16(o),!0;for(;n<1&&r>-15;)n*=2,r--;if(r<=-15)return e||this.setZero(16),!0;n-=1,n*=2;for(var s=9;s>=0;s--,n*=2)n>=1?(i[s]=!0,n-=1):i[s]=!1;for(r+=15,s=10;s<15;s++,r>>=1)i[s]=!!(1&r);return i[15]=o,e||(this.value=i),!0};var Vt=function(t){this.msg=t};function Zt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Gt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Gt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Jt=function(t){function e(t){return"string"==typeof t||t instanceof String}function i(e,i,n){if(void 0!==e.result){var o,r=Zt(document.querySelectorAll(e.result));try{for(r.s();!(o=r.n()).done;){o.value.value=i}}catch(t){r.e(t)}finally{r.f()}}if(void 0!==e.circuit){var s,a=Zt(document.querySelectorAll(e.circuit));try{for(a.s();!(s=a.n()).done;){s.value.value=n}}catch(t){a.e(t)}finally{a.f()}}var l=t.options.getAPI("test");if(null!==l){var h=Object.assign({cmd:"test",name:l.name,result:i,data:n,type:"application/json"},l.extra);tt.do({url:l.url,data:h,method:"POST",dataType:"json",contentType:l.contentType,success:function(e){var i=new Rt(e);t.toast.jsonErrors(i)||t.toast.message("Test result successfully saved to server")},error:function(e,i,n){t.toast.message("Unable to communicate with server: "+n)}})}}this.main=t,this.tests=[],this.addTest=function(t){t===Object(t)?this.tests.push(t):("{"===t.substr(0,1)||(t=atob(t)),this.tests.push(JSON.parse(t)))},this.findTest=function(t){for(var e=0;e<this.tests.length;e++)if(this.tests[e].tag===t)return this.tests[e];return null},this.runTestDlg=function(e){t.save(!0,!0),t.modal(!0),this.runTest(e).then((function(e){t.modal(!1);new J("Success","<h1>Circuit Success</h1><p>The test has passed.</p>").open(),i(e,void 0!==e.success?e.success:"success",t.model.toJSON())}),(function(n){t.modal(!1),new J("Test Failure","<h1>Circuit Failure</h1>"+n,450).open(),i(e,"fail",t.model.toJSON())}))},this.runTest=function(i){return new Promise((function(n,o){var r=t.model;r.backup();var s,a,l=-1;try{s=function(e){for(var i=t.model,n=[],o=0;o<e.input.length;o++){var r=e.input[o],s=r.split(":"),a=i,l="";if("tab"===s[0]){if(s.length<3)throw new Vt("<p>Invalid input tab definition: "+r+"</p>");var h=s[1];if(null===(a=i.getCircuit(h)))throw new Vt("<p>Invalid input tab: "+h+"</p>");l=" in tab <em>"+h+"</em>",s.splice(0,2)}if("type"===s[0]){if(s.length<2)throw new Vt("<p>Invalid input type specification: "+r+"</p>");var c=s[1],u=a.getComponentsByType(c);if(s.length>2){var d,p=null,f=Zt(u);try{for(f.s();!(d=f.n()).done;){var v=d.value;if(v.naming===s[2]){p=v;break}}}catch(t){f.e(t)}finally{f.f()}if(null===p)throw new Vt("<p>The test is not able to pass because you do not have a component named "+s[2]+" of type "+c+l+".</p>");n.push(p)}else{if(0===u.length)throw new Vt("<p>The test is not able to pass because you do not have a component of type "+c+l+".</p>");if(u.length>1)throw new Vt("<p>The test is not able to pass because you have more than one  component of type "+c+l+".</p><p>You are only allowed one component of that type in this circuit.</p>");n.push(u[0])}}else{var m=a.getComponentByNaming(s[0]);if(null===m)throw new Vt("<p>The test is not able to pass because you do not have a component named "+s[0]+l+".</p><p>Typically, the tests are looking for an input pin or a bus input pin. Input pins are labeled IN in the palette. Double-click on an input pin to set the name. Names in Cirsim are case sensitive.</p>");n.push(m)}}return n}(i),a=function(e){for(var i=t.model,n=[],o=0;o<e.output.length;o++){var r=i,s="",a=e.output[o].split("-"),l=a[0],h=l.split(":");if("tab:"===l.substr(0,4)){var c=l.substr(4),u=c.indexOf(":");if(-1===u)throw new Vt("<p>Invalid output tab definition: "+l+"</p>");var d=c.substr(0,u);if(null===(r=i.getCircuit(d)))throw new Vt("<p>Invalid out tab: "+d+"</p>");s=" in tab <em>"+d+"</em>",l=c.substr(u+1),h.splice(0,2)}var p=a.length>1?a[1]:0;if("type"===h[0]){if(h.length<2)throw new Vt("<p>Invalid output type specification: "+l+"</p>");var f=h[1],v=r.getComponentsByType(f);if(h.length>2){var m,y=null,g=Zt(v);try{for(g.s();!(m=g.n()).done;){var b=m.value;if(b.naming===h[2]){y=b;break}}}catch(t){g.e(t)}finally{g.f()}if(null===y)throw new Vt("<p>The test is not able to pass because you do not have a component named "+h[2]+" of type "+f+s+".</p>");n.push(y.ins[p])}else{if(0===v.length)throw new Vt("<p>The test is not able to pass because you do not have a component of type "+f+s+".</p>");if(v.length>1)throw new Vt("<p>The test is not able to pass because you have more than one  component of type "+f+s+".</p><p>You are only allowed one component of that type in this circuit.</p>");n.push(v[0].ins[p])}}else{var w=r.getComponentByNaming(l);if(!(null!==w&&w.ins.length>p))throw new Vt("<p>The test is not able to pass because you do not have a component named "+l+s+".</p><p>Output pins are labeled OUT in the palette. Double-click on an output pin to set the name. Pin names are case sensitive.</p>");n.push(w.ins[p])}}return n}(i)}catch(t){if(t instanceof Vt)return void o(t.msg);throw t}setTimeout((function h(){if(l>=0)for(var c=i.test[l],u=0;u<a.length&&u+s.length<c.length;u++){var d=c[u+s.length];if(null!=d&&"?"!==d){var p=!1,f=!1;if(e(d)){var v=!1;do{v=!1,"bitslop:"===d.substr(0,8)?(p=!0,d=d.substr(8),v=!0):"test:"===d.substr(0,5)&&(f=!0,d=d.substr(5),v=!0)}while(v)}if(f){var m,y=Zt(d.split(";"));try{for(y.s();!(m=y.n()).done;){var g=m.value;try{a[u].testAsString(g)}catch(t){return void(!0===g.quiet?o('<div class="cirsim-test-result"><p>This test is failing. Some output is not what is currently expected by the test. The circuit is left in the state it was in when the test failed. No additional detail will be provided about why the test is failed. It is your responsibility to create a circuit that works as expected.</p></div>'):o('<div class="cirsim-test-result"><p>This test is failing. '.concat(t,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>")))}}}catch(t){y.e(t)}finally{y.f()}}else{var b=new Yt;b.type=Yt.BINARY,b.setAsString(d);var w=a[u].getAsString(),x=!0;if(p)d=b.getAsInteger(),b.setAsBinary(w),("?"===(w=b.getAsInteger())||w<d-1||w>d+1)&&(x=!1);else if(e(d=b.getAsBinary())){for(var T=w.length-1,I=d.length-1;I>=0&&x;T--,I--)if("?"!==d.substr(I,1)){if(T<0){x=!1;break}w.substr(T,1)!=d.substr(I,1)&&(x=!1)}T>0&&(x=!1)}else null!==d&&"?"!==d&&(x=d==w);if(!x)return console.log("Test: "+l+" Output "+a[u].component.naming+" Actual: "+w+" Expected: "+d),void(!0===i.quiet?o('<div class="cirsim-test-result"><p>This test is failing. Some output is not what is currently expected by the test. The circuit is left in the state it was in when the test failed. No additional detail will be provided about why the test is failed. It is your responsibility to create a circuit that works as expected.</p></div>'):o('<div class="cirsim-test-result"><p>This test is failing. An output value is \nnot what is currently expected by the test. The circuit is left in the state it was \nin when the test failed.<p>\n<p class="cs-result">Output '.concat(a[u].component.naming," expected: ").concat(d," actual: ").concat(w,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>\n")))}}}if(++l<i.test.length){for(var S=i.test[l],k=0;k<s.length&&k<S.length;k++)if(null!==S[k]){var O=s[k].command(S[k]);if(null!==O){if(!O.ok)return void o("<p>This test is failing. "+O.msg+"</p>")}else try{s[k].setAsString(S[k])}catch(t){return void o('<div class="cirsim-test-result"><p>This test is failing. '.concat(t,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>"))}}for(var A=r.getSimulation(),C=0;C<100&&A.advance(.01*A.speed);C++);setTimeout(h,t.options.testTime),null!==A.view&&A.view.draw()}else n(i)}),t.options.testTime)}))}},Qt=function(t){var e=this;this.defaultDuration=2e3,this.interToastDelay=500;var i=[],n=!1,o=null;this.create=function(t){o=U.createClassedDiv("toast"),t.appendChild(o),o.innerHTML="testing"};var r=function t(){if(i.length>0&&!n){var r=i[0];i.splice(0,1),o.innerHTML=r.msg,o.classList.add("toast-active"),n=!0,setTimeout((function(){o.classList.remove("toast-active"),setTimeout((function(){n=!1,t()}),e.interToastDelay)}),r.time)}};this.message=function(t,e){void 0===e&&(e=this.defaultDuration),i.push({msg:t,time:e}),r()},this.jsonErrors=function(t){var e=this;return null!==t.errors()&&(t.errors().forEach((function(t){e.message("Server Error: "+t.title,5e3)})),!0)}},Kt=function(t){F.call(this),this.open=function(e){this.done=e;var i="<p>File "+t+" exists. Are you sure you want to overwrite?";this.contents(i,"Overwrite?"),F.prototype.open.call(this)},this.ok=function(){this.close(),this.done(!0)},this.cancel=function(){this.done(!1)}};(Kt.prototype=Object.create(F.prototype)).constructor=Kt;var $t=function(t,e,i){var n=this;F.call(this);var o=this,r=e.getAPI("files"),s=null,a=null;this.filename="";var l=this.uniqueId(),h=this.uniqueId(),c="#"+l,u="#"+h;this.open=function(e){a=e;var i='<div class="control"><label for="'+h+'">'+(t?"Available":"Existing")+'</label><select class="files" id="'+h+'" name="'+h+'" size="5"></select><div class="notice">Querying Server...</div></div><div class="control"><label for="'+l+'">Name</label><input type="text" name="'+l+'" id="'+l+'" value="'+this.filename+'" spellcheck="false" class="text ui-widget-content ui-corner-all"></div>';t?this.contents(i,"File Open"):(i+="<p>Enter a name to save your circuit on the server as.</p>",this.contents(i,"File Save")),F.prototype.open.call(this);var n=document.getElementById(h),o=document.getElementById(l);n.addEventListener("click",(function(t){o.value=n.value})),o.select(),d(u,c),t||this.buttonOk().setAttribute("disabled","true")},this.ok=function(){var e=this,i=(document.getElementById(h),document.getElementById(l));if(this.filename=this.sanitize(i.value).replace(/^\s+|\s+$/gm,""),0===this.filename.length)return i.focus(),void this.error("Must supply a file name");if(!/^[0-9a-zA-Z\.\-\+ ]+$/.test(this.filename))return i.focus(),void this.error("Names can contain a-z, A-Z, 0-9, ., -, +, and space");((this.filename.length<8||".cirsim"!==this.filename.substr(this.filename.length-7,7))&&(this.filename+=".cirsim"),t)?this.read(this.filename,a):s.indexOf(this.filename)>=0?new Kt(this.filename).open((function(t){t&&e.write(e.filename,a)})):this.write(this.filename,a)};var d=function(){tt.do({url:r.url,data:Object.assign({cmd:"files"},r.extra),method:"GET",dataType:"json",success:function(t){var e=new Rt(t);if(i.jsonErrors(e))o.close();else{var r=e.getData("files"),a=document.getElementById(h),c=(document.getElementById(l),a.parentNode.querySelector(".notice"));null!==c&&c.parentNode.removeChild(c),s=[],r.attributes.forEach((function(t){var e=document.createElement("option");e.value=t.name,e.innerText=t.name,a.appendChild(e),s.push(t.name)})),n.buttonOk().removeAttribute("disabled")}},error:function(t,e,n){console.log(t.responseText),i.message("Unable to communicate with server: "+n),o.close()}})}};($t.prototype=Object.create(F.prototype)).constructor=$t;var _t=function(t,e,i,n){$t.call(this,!1,i,n);var o=i.getAPI("save");this.write=function(e,i){var r=this;tt.do({url:o.url,data:Object.assign({cmd:"save",name:e,data:t},o.extra),method:"POST",dataType:"json",success:function(t){var o=new Rt(t);n.jsonErrors(o)||(r.close(),i(e))},error:function(t,e,i){console.log(t.responseText),n.message("Unable to communicate with server: "+i),r.close()}})}};(_t.prototype=Object.create($t.prototype)).constructor=_t;var te=function(t,e){$t.call(this,!0,t,e);var i=t.getAPI("open");this.read=function(t,n){var o=this;tt.do({url:i.url,data:Object.assign({cmd:"open",name:t},i.extra),method:"GET",dataType:"json",success:function(i){var r=new Rt(i);if(!e.jsonErrors(r)){var s=i.data[0].attributes.data;n(t,s),o.close()}},error:function(t,i,n){console.log(t.responseText),e.message("Unable to communicate with server: "+n),o.close()}})}};(te.prototype=Object.create($t.prototype)).constructor=te;var ee=function(t,e,i,n,o){F.call(this);var r=this;this.buttonOk=null,this.open=function(){var e=this;this.contents("<p>Saving to server...</p>","Saving..."),F.prototype.open.call(this);var s=n.getAPI("save");tt.do({url:s.url,data:Object.assign({cmd:"save",name:i,data:t},s.extra),method:"POST",dataType:"json",success:function(t){var e=new Rt(t);o.jsonErrors(e)||r.close()},error:function(t,i,n){console.log(t.responseText),o.message("Unable to communicate with server: "+n),e.close()}})}};(ee.prototype=Object.create(F.prototype)).constructor=ee;var ie=function(t,e,i){F.call(this),this.buttonOk=null,this.open=function(n){var o=this;this.contents("<p>Loading from server...</p>","Loading..."),F.prototype.open.call(this);var r=e.getAPI("open");null!==r&&tt.do({url:r.url,data:Object.assign({cmd:"open",name:t},r.extra),method:"GET",dataType:"json",success:function(e){var r=new Rt(e);if(!i.jsonErrors(r)){var s=e.data[0].attributes.data;n(t,s)}o.close()},error:function(t,e,n){i.message("Unable to communicate with server: "+n),o.close()}})}};(ie.prototype=Object.create(F.prototype)).constructor=ie;var ne=function(t){var e,i=this;this.home=function(){e.home()},this.url=function(t){e.present(t)},function(){e=new nt(t,i);var n=U.createClassedDiv("help-div");i.element=n,t.element.appendChild(n);var o='<div class="header"><h1>Cirsim Help</h1>\n<button type="button" class="help-back" title="Back">\n<span class="icons-cl icons-cl-arrowthick-1-w"></span></button>\n<button type="button" class="help-home" title="Home">\n<span class="icons-cl icons-cl-home"></span></button>\n<button type="button" class="help-close" title="Close">\n<span class="icons-cl icons-cl-closethick"></span></button>\n</div>\n'.concat(e.html());n.innerHTML=o,e.present("");var r=n.querySelector(".header");null!==r&&(r.querySelector("button.help-close").addEventListener("click",(function(e){e.preventDefault(),t.dockedHelp(!1)})),r.querySelector("button.help-home").addEventListener("click",(function(t){t.preventDefault(),e.home()})),r.querySelector("button.help-back").addEventListener("click",(function(t){t.preventDefault(),e.back()})))}()};function oe(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return re(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return re(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var se=function(t){var e=null,i=null,n=[];this.draggable=function(t){t.element.addEventListener("mousedown",(function(e){e.preventDefault(),o(t),r(e.pageX,e.pageY)})),t.element.addEventListener("touchstart",(function(e){e.preventDefault(),o(t);var i=e.changedTouches[0];r(i.pageX,i.pageY)}))},this.droppable=function(t,e){n.push({view:t,callback:e})};var o=function(n){var o=n.paletteImage();t.element.appendChild(o),o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.zIndex=100,o.style.cursor="pointer",i=n,e=o},r=function(i,n){if(null!==e){var o=t.element.getBoundingClientRect(),r=o.left+t.element.scrollLeft+window.pageXOffset,s=o.top+t.element.scrollTop+window.pageYOffset;return e.style.left=i-r-e.clientWidth/2+"px",e.style.top=n-s-e.clientHeight/2+"px",!0}return!1},s=function(o,r){if(null!==e){var s,a=oe(n);try{for(a.s();!(s=a.n()).done;){var l=s.value,h=l.view.element;if("none"!==h.parentNode.style.display){var c=h.getBoundingClientRect(),u=c.left+h.scrollLeft+window.pageXOffset,d=c.top+h.scrollTop+window.pageYOffset;if(o>=u&&r>=d&&o<u+(c.right-c.left)&&r<d+(c.bottom-c.top)){l.callback(i,o-u,r-d);break}}}}catch(t){a.e(t)}finally{a.f()}t.element.removeChild(e),e=null,i=null}};t.element.addEventListener("mousemove",(function(t){0!==t.which?r(t.pageX,t.pageY):s(t.pageX,t.pageY)})),t.element.addEventListener("touchmove",(function(t){var e=t.changedTouches[0];r(e.pageX,e.pageY)})),t.element.addEventListener("mouseup",(function(t){s(t.pageX,t.pageY)})),t.element.addEventListener("touchend",(function(t){var e=t.changedTouches[0];s(e.pageX,e.pageY)})),t.element.addEventListener("touchcancel",(function(t){var e=t.changedTouches[0];s(e.pageX,e.pageY)}))};function ae(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return le(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return le(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var he=function(t,e,i){var n=this;this.cirsim=t,this.element=e,this.options=t.options,this.components=t.components,this.test=new Jt(this),this.div=null;var o,r=ae(i);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.test.addTest(s)}}catch(t){r.e(t)}finally{r.f()}var a,l=ae(this.options.tests);try{for(l.s();!(a=l.n()).done;){var h=a.value;this.test.addTest(h)}}catch(t){l.e(t)}finally{l.f()}this.filename=null;var c=t.options,u=null,d=null,p=null,f=null,v=null,m=null;this.initialize=function(){var t=this;if("none"!==c.display){switch(U.addClass(e,"cirsim"),e.innerHTML="",c.display){case"full":U.addClass(e,"cirsim-full");break;case"inline":U.addClass(e,"cirsim-inline");break;default:U.addClass(e,"cirsim-window")}"window"===c.display&&(e.classList.contains("resizer")||new y.w(e,{handle:"10px solid #18453B"})),this.dragAndDrop=new se(this);var i=new MutationObserver((function(){document.body.contains(e)||(i.disconnect(),t.model.kill())}));i.observe(document.body,{childList:!0})}for(var n in u=new Bt(this),this.model=u,this.options.tabs)this.model.circuits.add(new Ct(this.options.tabs[n]));if(null!==this.options.load&&u.fmJSON(this.options.load),"inline"!==c.display&&"none"!==c.display&&(this.div=U.createClassedDiv("main"),this.element.appendChild(this.div),this.help=new ne(this),f=new Ht(this),this.tabs=f,d=new lt(this),this.menu=d,m=U.createClassedDiv("work"),this.div.appendChild(m),p=new yt(this,m),this.palette=p,f.create(m),v=U.createClassedDiv("cirsim-overlay"),this.div.appendChild(v),this.toast=new Qt(this),this.toast.create(this.div)),"inline"===c.display){var o=document.createElement("div");e.appendChild(o);var r=document.createElement("canvas");o.appendChild(r);var s=u.circuits.getCircuit("main"),a=new Mt(this,r,s,0);u.getSimulation().setView(a),v=U.createClassedDiv("cirsim-overlay"),e.appendChild(v),this.toast=new Qt(this),this.toast.create(this.element)}var l=this.options.getAPI("open");null!==l&&void 0!==l.url&&void 0!==l.name&&(this.filename=l.name,new ie(l.name,this.options,this.toast).open((function(e,i){u.fmJSON(i),t.reload(),t.filename=e})))},this.addTest=function(t){this.test.addTest(t)},this.currentView=function(){return f.currentView()},this.newTab=function(){null!==p&&p.refresh(),u.newTab()},this.backup=function(){u.backup()},this.undo=function(){u.undo(),f.undo(),p.refresh()},this.modal=function(t){v.style.display=t?"block":"none"},this.open=function(){var t=this;new te(this.options,this.toast).open((function(e,i){u.fmJSON(i),t.reload(),t.filename=e}))},this.save=function(t,e){var i=n.options.getAPI("save");if(null!==i)if(void 0===i.name){if(!0!==t)if(null===n.filename)n.saveAs();else{var o=u.toJSON();new ee(o,"application/json",n.filename,n.options,n.toast).open()}}else{var r=u.toJSON(),s=Object.assign({cmd:"save",name:i.name,data:r,type:"application/json"},i.extra);tt.do({url:i.url,data:s,method:"POST",dataType:"json",contentType:i.contentType,success:function(t){var i=new Rt(t);n.toast.jsonErrors(i)||!0!==e&&n.toast.message("Successfully saved to server")},error:function(t,e,i){console.log(t.responseText),n.toast.message("Unable to communicate with server: "+i)}})}},this.saveAs=function(){var t=this,e=u.toJSON(),i=new _t(e,"application/json",this.options,this.toast);null!==this.filename&&(i.filename=this.filename),i.open((function(e){t.filename=e}))},this.export=function(){new Xt(u).open()},this.import=function(){new Wt(this,u).open()},this.importTab=function(){for(var t=0;t<this.options.imports.length;t++){var e=this.options.imports[t];if(e.into===this.currentView().circuit.name)return void this.currentView().importTab(e)}},this.reload=function(){f.destroy(),f.create(m,u)};var g=!1;this.isHelpDocked=function(){return g},this.dockedHelp=function(t){(g=t)?U.addClass(this.element,"docked-help"):U.removeClass(this.element,"docked-help")},this.load=function(t){u.fmJSON(t),this.reload()},this.initialize()};he.prototype.runTest=function(t){return this.test.runTest(t)};var ce=function(t){for(var e in t=t||{},this.display="window",this.load=null,this.loadMenu=[],this.tabs=[],this.tabsMenu=!0,this.export="both",this.exportPNG=!1,this.testTime=17,this.userid=null,this.tests=[],this.imports=[],this.api=null,this.exit=null,this.global=null,this.components=["combinatorial","sequential"],this.always=["Zero","One","InPin","OutPin","Clock","Button","LED","Text"],this.showOutputStates=!1,t)if(t.hasOwnProperty(e)){if(!this.hasOwnProperty(e))throw new Error("Invalid option "+e);this[e]=t[e]}this.getAPI=function(t){if(null===this.api)return null;if(this.api===Object(this.api)){var e;if(void 0!==this.api[t]){var i=this.api[t];if(void 0===i.url)return null;e={url:i.url},void 0!==i.contentType?e.contentType=i.contentType:void 0!==this.api.contentType?e.contentType=this.api.contentType:e.contentType="application/x-www-form-urlencoded; charset=UTF-8",void 0!==i.extra?e.extra=i.extra:void 0!==this.api.extra?e.extra=this.api.extra:e.extra={},void 0!==i.name?e.name=i.name:void 0!==this.api.name&&(e.name=this.api.name)}else{if(void 0===this.api.url)return null;e={url:this.api.url},void 0!==this.api.extra?e.extra=this.api.extra:e.extra={},void 0!==this.api.name&&(e.name=this.api.name)}return e}return{url:this.api}}},ue=function(){this.components=[],this.palettes={},this.add=function(t){this.components.push(t),this.components.sort((function(t,e){return t.order-e.order}))},this.get=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e].type===t)return this.components[e];return null},this.addPalette=function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(e[n].type);this.palettes[t]=i},this.getPalette=function(t){return this.palettes.hasOwnProperty(t)?this.palettes[t]:null}};var de=function(){Y.call(this),this.height=16,this.width=16,this.addOut(8,0,8),this.outs[0].set(!1)};(de.prototype=Object.create(Y.prototype)).constructor=de,de.prototype.prefix=null,de.type="Zero",de.label="0",de.desc="0 (false)",de.description="<h2>Zero</h2><p>A simple false value.</p>",de.order=0,de.help="zero",de.prototype.compute=function(t){this.outs[0].set(!1)},de.prototype.clone=function(){var t=new de;return t.copyFrom(this),t},de.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawText(t,"0",0,5,"14px Times"),this.drawIO(t,e)},de.paletteImage=function(){var t=new ht(60,30);return t.box(16,16),t.io(8,0,"e"),t.drawText("0",0,5,"14px Times"),t};var pe=function(){Y.call(this),this.height=16,this.width=16,this.addOut(8,0,8),this.outs[0].set(!0)};(pe.prototype=Object.create(Y.prototype)).constructor=pe,pe.prototype.prefix=null,pe.type="One",pe.label="1",pe.desc="1 (true)",pe.description="<h2>One</h2><p>A simple true value.</p>",pe.order=1,pe.help="one",pe.prototype.compute=function(t){this.outs[0].set(!0)},pe.prototype.clone=function(){var t=new pe;return t.copyFrom(this),t},pe.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawText(t,"1",0,5,"14px Times"),this.drawIO(t,e)},pe.paletteImage=function(){var t=new ht(60,30);return t.box(16,16),t.io(8,0,"e"),t.drawText("1",0,5,"14px Times"),t};var fe=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-16,16),this.addIn(-32,16,16),this.addOut(32,0,16)};(fe.prototype=Object.create(Y.prototype)).constructor=fe,fe.type="And",fe.label="AND",fe.desc="AND gate",fe.order=11,fe.description="<h2>AND Gate</h2><p>The output of an AND gate is <em>true</em> if both inputs are true.</p>",fe.help="and",fe.prototype.compute=function(t){t[0]&&t[1]?this.outs[0].set(!0):!1===t[0]||!1===t[1]?this.outs[0].set(!1):this.outs[0].set(void 0)},fe.prototype.clone=function(){var t=new fe;return t.copyFrom(this),t},fe.prototype.draw=function(t,e){this.selectStyle(t,e),fe.path(t,this.x,this.y,this.width,this.height),ut.fillWith(t),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)},fe.path=function(t,e,i,n,o){var r=e-n/2-.5,s=e+n/2+.5,a=i-o/2-.5,l=i+o/2+.5;t.beginPath(),t.moveTo(r,l),t.lineTo(r,a),t.lineTo(s-o/2,a),t.arc(s-o/2,i,o/2+.5,-Math.PI/2,Math.PI/2),t.lineTo(r,l)},fe.paletteImageBase=function(){var t=new ht(120,70),e=t.context;e.lineWidth=1.5;var i=t.width/2,n=t.height/2,o=.5*t.width,r=(t.height,26.5),s=i-o/2-.5,a=i+o/2+.5,l=n-r+.5,h=n+r-.5;return this.leftX=s-t.width/2,this.rightX=a-t.width/2,e.beginPath(),e.moveTo(s,h),e.lineTo(s,l),e.lineTo(a-r,l),e.arc(a-r,n,r,-Math.PI/2,Math.PI/2),e.lineTo(s,h),t.fillStroke(),t.io(this.rightX,0,"e"),t},fe.paletteImage=function(){var t=fe.paletteImageBase();return t.io(this.leftX,-16,"w"),t.io(this.leftX,16,"w"),t};var ve=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(ve.prototype=Object.create(Y.prototype)).constructor=ve,ve.offsetX=40,ve.offsetY=30,ve.type="Or",ve.label="OR",ve.desc="OR gate",ve.order=20,ve.description="<h2>OR Gate</h2><p>The output of an OR gate is <em>true</em> \nif either or both inputs are true. Otherwise, it is false.</p>",ve.help="or",ve.prototype.compute=function(t){t[0]||t[1]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]?this.outs[0].set(void 0):this.outs[0].set(!1)},ve.prototype.clone=function(){var t=new ve;return t.copyFrom(this),t},ve.prototype.draw=function(t,e){this.selectStyle(t,e),ve.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},ve.draw=function(t,e,i,n,o){ve.path(t,e,i,n,o),ut.fillWith(t),t.stroke()},ve.path=function(t,e,i,n,o){var r=e-n/2-.5,s=i-o/2-.5,a=i+o/2+.5;t.beginPath();var l=ve.offsetX,h=Math.atan2(o/2,l),c=l/Math.cos(h);t.arc(r-l,i,c,-h,h);var u=(n/2*(n/2)-o/2*(o/2))/o;c=o/2+u,h=Math.atan2(u,n/2),t.lineTo(e,a),t.arc(e,i-u,c,Math.PI/2,h,!0),t.arc(e,i+u,c,-h,-Math.PI/2,!0),t.lineTo(r,s)},ve.paletteImageBase=function(){var t=new ht(120,70),e=t.context;e.lineWidth=1.5;var i=t.width/2,n=t.height/2,o=.5*t.width,r=.65*t.height,s=i-o/2-.5,a=i+o/2+.5,l=Math.round(n-r/2)-.5,h=Math.round(n+r/2)+.5;e.beginPath();var c=ve.offsetX,u=Math.atan2(r/2,c),d=c/Math.cos(u);e.arc(s-c,n,d,-u,u);var p=(o/2*(o/2)-r/2*(r/2))/r;return d=r/2+p,u=Math.atan2(p,o/2),this.leftX=s-t.width/2+3,this.rightX=a-t.width/2,e.lineTo(i,h),e.arc(i,n-p,d,Math.PI/2,u,!0),e.arc(i,n+p,d,-u,-Math.PI/2,!0),e.lineTo(s,l),t.fillStroke(),t.io(this.rightX,0,"e"),t},ve.paletteImage=function(){var t=ve.paletteImageBase();return t.io(this.leftX,-16,"w"),t.io(this.leftX,16,"w"),t};var me=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e,r=Math.sqrt(n*n-4)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+r,0,16+r),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(me.prototype=Object.create(Y.prototype)).constructor=me,me.offsetX=40,me.offsetY=30,me.type="Or3",me.label="OR",me.desc="OR gate",me.order=21,me.description="<h2>OR Gate</h2><p>The output of a three-input OR gate is <em>true</em> if any of of the inputs are true. Otherwise, it is false.</p>",me.prototype.compute=function(t){t[0]||t[1]||t[2]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]?this.outs[0].set(void 0):this.outs[0].set(!1)},me.prototype.clone=function(){var t=new me;return t.copyFrom(this),t},me.prototype.draw=function(t,e){this.selectStyle(t,e),ve.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},me.paletteImage=function(){var t=ve.paletteImageBase();return t.io(ve.leftX,-16,"w"),t.io(ve.leftX,0,"w"),t.io(ve.leftX,16,"w"),t};var ye=function t(){Y.call(this),this.height=64,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-64)-e,r=Math.sqrt(n*n-576)-e;this.addIn(-32+r,-24,16+r),this.addIn(-32+o,-8,16+o),this.addIn(-32+o,8,16+o),this.addIn(-32+r,24,16+r),this.addOut(32,0,16)};(ye.prototype=Object.create(Y.prototype)).constructor=ye,ye.offsetX=40,ye.offsetY=30,ye.type="Or4",ye.label="OR",ye.desc="OR gate",ye.order=22,ye.description="<h2>OR Gate</h2><p>The output of a four-input OR gate is <em>true</em> if any of of the inputs are true. Otherwise, it is false.</p>",ye.prototype.compute=function(t){t[0]||t[1]||t[2]||t[3]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]||void 0===t[3]?this.outs[0].set(void 0):this.outs[0].set(!1)},ye.prototype.clone=function(){var t=new ye;return t.copyFrom(this),t},ye.prototype.draw=function(t,e){this.selectStyle(t,e),ve.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},ye.paletteImage=function(){var t=ve.paletteImageBase();return t.io(ve.leftX,-16,"w"),t.io(ve.leftX,-5.5,"w"),t.io(ve.leftX,5.5,"w"),t.io(ve.leftX,16,"w"),t};var ge=function(){ve.call(this,name),this.outs=[],this.addOutInv(32,0,16)};(ge.prototype=Object.create(ve.prototype)).constructor=ge,ge.type="Nor",ge.label="NOR",ge.desc="NOR gate",ge.img="nor.png",ge.order=30,ge.description="<h2>NOR Gate</h2><p>The output of a NOR gate is <em>false</em> if either or both \n inputs are true. Otherwise, it is true.</p>",ge.help="nor",ge.prototype.clone=function(){var t=new ge;return t.copyFrom(this),t};var be=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-16,16),this.addIn(-32,0,16),this.addIn(-32,16,16),this.addOut(32,0,16)};(be.prototype=Object.create(Y.prototype)).constructor=be,be.type="And3",be.label="AND",be.desc="3-Input AND gate",be.order=12,be.description="<h2>AND Gate</h2><p>The output of a three-input AND gate is <em>true</em> if all three inputs are true.</p>",be.help="and3",be.prototype.compute=function(t){t[0]&&t[1]&&t[2]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]?this.outs[0].set(void 0):this.outs[0].set(!1)},be.prototype.clone=function(){var t=new be;return t.copyFrom(this),t},be.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,r),t.moveTo(i,o),t.lineTo(n-this.height/2,o),t.moveTo(i,r),t.lineTo(n-this.height/2,r),t.stroke(),t.beginPath(),t.arc(n-this.height/2,this.y,this.height/2+.5,-Math.PI/2,Math.PI/2),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),this.drawIO(t,e)},be.paletteImage=function(){var t=fe.paletteImageBase();return t.io(fe.leftX,-16,"w"),t.io(fe.leftX,0,"w"),t.io(fe.leftX,16,"w"),t};var we=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-24,16),this.addIn(-32,-8,16),this.addIn(-32,8,16),this.addIn(-32,24,16),this.addOut(32,0,16)};(we.prototype=Object.create(Y.prototype)).constructor=we,we.type="And4",we.label="AND",we.desc="4-Input AND gate",we.order=13,we.description="<h2>AND Gate</h2><p>The output of a four-input AND gate is <em>true</em> if all four inputs are true.</p>",we.help="and4",we.prototype.compute=function(t){t[0]&&t[1]&&t[2]&&t[3]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]||void 0===t[3]?this.outs[0].set(void 0):this.outs[0].set(!1)},we.prototype.clone=function(){var t=new we;return t.copyFrom(this),t},we.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,r),t.moveTo(i,o),t.lineTo(n-this.height/2,o),t.moveTo(i,r),t.lineTo(n-this.height/2,r),t.stroke(),t.beginPath(),t.arc(n-this.height/2,this.y,this.height/2+.5,-Math.PI/2,Math.PI/2),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),this.drawIO(t,e)},we.paletteImage=function(){var t=fe.paletteImageBase();t.height;return t.io(fe.leftX,-24,"w"),t.io(fe.leftX,-8,"w"),t.io(fe.leftX,8,"w"),t.io(fe.leftX,24,"w"),t};var xe=function(){fe.call(this,name),this.outs=[],this.addOutInv(32,0,16)};(xe.prototype=Object.create(fe.prototype)).constructor=xe,xe.type="Nand",xe.label="NAND",xe.desc="NAND gate",xe.order=16,xe.description="<h2>NAND Gate</h2><p>The output of a NAND gate is <em>false</em> if and only if both inputs are true.</p>",xe.help="nand",xe.prototype.clone=function(){var t=new xe;return t.copyFrom(this),t},xe.paletteImage=function(){var t=fe.paletteImageBase();return t.io(fe.leftX,-16,"w"),t.io(fe.leftX,16,"w"),t.io(fe.rightX+10,0,"e"),t.circle(fe.rightX+5,0,5),t};var Te=function(t,e,i,n){this.x=t,this.y=e,this.color="undefined",void 0===n?(this.radius=i,this.width=2*i,this.height=2*i):(this.radius=null,this.width=i,this.height=n)};Te.colors={black:["#000000","#000000"],undefined:["#444444","#888888"],green:["#55ff88","#00fb4a"],red:["#ff4444","#ff0000"],blue:["#25ffff","#15ddff"],purple:["#c000ff","#8000ff"],yellow:["#ffff00","#ffff80"],none:["#000000","#000000"]},Te.prototype.draw=function(t,e,i,n){if("none"!==this.color){var o=t.fillStyle;void 0===n&&(n="white"),t.beginPath(),e+=this.x,i+=this.y;var r,s,a=1.15*this.radius;if(Te.colors.hasOwnProperty(this.color)?(r=Te.colors[this.color][0],s=Te.colors[this.color][1]):(r="#000000",s="#000000"),null!==this.radius){var l=t.createRadialGradient(e,i,1,e,i,a);l.addColorStop(0,r),l.addColorStop(.5,s),l.addColorStop(1,n),t.fillStyle=l}else{var h=t.createLinearGradient(0,i-this.height/2,0,i+this.height/2);h.addColorStop(0,n),h.addColorStop(.25,r),h.addColorStop(.75,r),h.addColorStop(1,n),t.fillStyle=h}t.fillRect(e-this.width/2,i-this.height/2,this.width,this.height),"undefined"===this.color&&(t.font="14px Times",t.fillStyle="#ffffff",t.fontWeight="bold",t.textAlign="center",t.fillText("?",e,i+5),t.fillText("?",e+1,i+5),t.fontWeight="normal"),t.fillStyle=o}},Te.prototype.touch=function(t,e,i,n){return t+=this.x,e+=this.y,w.distance({x:t,y:e},{x:i,y:n})<=this.radius},Te.colorSelector=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n='<div class="control1 center"><label for="'+t+'">Color: </label><select id="'+t+'">',o=Te.colors;for(var r in o)o.hasOwnProperty(r)&&"black"!==r&&"undefined"!==r&&(!0!==i&&"none"===r||(n+=r===e?"<option selected>"+r+"</option>":"<option>"+r+"</option>"));return n+="</select></div>"};var Ie=function(){Y.call(this),this.height=16,this.width=64,this.led=new Te(19,0,7),this.addOut(32,0,16),this.set(!1)};(Ie.prototype=Object.create(Y.prototype)).constructor=Ie,Ie.prototype.prefix="*I",Ie.prototype.nameRequired=!0,Ie.type="InPin",Ie.label="In Pin",Ie.desc="Input Pin",Ie.img="inpin.png",Ie.order=2,Ie.description="<h2>Input Pin</h2><p>An IN pin serves as input for a circuit. Clicking the LED toggles the output true or false.</p>",Ie.help="inpin",Ie.prototype.clone=function(){var t=new Ie;return t.value=this.value,t.copyFrom(this),t},Ie.prototype.compute=function(t){this.outs[0].set(this.value)},Ie.prototype.draw=function(t,e){var i=this.value?"white":"#dddddd";this.outlinePath(t),t.fillStyle=i,t.fill(),this.led.color=this.value?"green":"off",this.led.draw(t,this.x,this.y,i),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.beginPath(),t.font="14px Times",t.textAlign="center";var n=this.value?"1":"0",o=this.x-9;null!==this.naming?t.fillText(this.naming+": "+n,o,this.y+5):t.fillText(n,o,this.y+5),this.drawIO(t,e)},Ie.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,n),t.lineTo(e,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e,n)},Ie.prototype.touch=function(t,e){return this.led.touch(this.x,this.y,t,e)?(this.circuit.circuits.model.backup(),this.set(!this.value),null):Y.prototype.touch.call(this,t,e)},Ie.prototype.set=function(t){"string"==typeof t||t instanceof String?this.setAsString(t):(this.value=t,this.outs[0].set(t))},Ie.prototype.setAsString=function(t){switch(t){case void 0:case"undefined":case"?":this.set(void 0);break;case"false":case"0":case!1:this.set(!1);break;case"true":case"1":case!0:this.set(!0);break;default:var e=1==+t;this.set(e)}},Ie.prototype.get=function(){return this.value},Ie.prototype.save=function(){var t=Y.prototype.save.call(this);return t.value=this.value,t},Ie.prototype.load=function(t){this.set(t.value),Y.prototype.load.call(this,t)},Ie.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control center"><div class="choosers"><label><input type="radio" id="'+n+'" value="1" name="'+n+'"'+(this.value?" checked":"")+'> true (1)</label><label><input type="radio" id="'+n+'" value="0" name="'+n+'"'+(this.value?"":" checked")+"> false (0)</label></div></div>";i.extra(o,(function(){return null}),(function(){e.set("1"===document.querySelector("#"+n+":checked").value)})),i.open()};var Se=function(){Y.call(this),this.height=16,this.width=64,this.color="green",this.led=new Te(-19,0,7),this.addIn(-32,0,16)};(Se.prototype=Object.create(Y.prototype)).constructor=Se,Se.prototype.prefix="O",Se.prototype.nameRequired=!0,Se.type="OutPin",Se.label="Out Pin",Se.desc="Output Pin",Se.img="outpin.png",Se.order=3,Se.description="<h2>Ouput Pin</h2><p>An OUT pin serves as output \nfor a circuit. The LED indicates if the input is true (led illuminated), false \n(black), or undefined (?).</p>",Se.help="outpin",Se.prototype.pending=function(){},Se.prototype.get=function(){return this.ins[0].value},Se.prototype.getAsString=function(){switch(this.ins[0]){case!0:return"1";case!1:return"0";default:return"?"}},Se.prototype.getAsValue=function(){return new Yt(this.ins[0].value)},Se.prototype.clone=function(){var t=new Se;return t.color=this.color,t.copyFrom(this),t},Se.prototype.load=function(t){void 0!==t.color&&(this.color=gt.sanitize(t.color)),Y.prototype.load.call(this,t)},Se.prototype.save=function(){var t=Y.prototype.save.call(this);return"green"!==this.color&&(t.color=this.color),t},Se.prototype.draw=function(t,e){var i=this.get(),n=this.value?"white":"#dddddd";if(this.outlinePath(t),t.fillStyle=n,t.fill(),"none"!==this.color&&(this.led.color=void 0===i?"undefined":i?this.color:"off",this.led.draw(t,this.x,this.y,n)),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.beginPath(),t.font="14px Times",t.textAlign="center","none"!==this.color){var o=void 0===i?"?":i?"1":"0",r=this.x+9;null!==this.naming?t.fillText(this.naming+": "+o,r,this.y+5):t.fillText(o,r,this.y+5)}else{var s=this.x+4;null!==this.naming&&t.fillText(this.naming,s,this.y+5)}this.drawIO(t,e)},Se.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},Se.prototype.properties=function(t){var e=this,i=new H(this,t),n='<div class="control1 center">',o=i.uniqueId();n+=Te.colorSelector(o,this.color,!0),n+="</div>",i.extra(n,(function(){return null}),(function(){e.color=gt.sanitize(document.getElementById(o).value)})),i.open()};var ke=function(){Y.call(this),this.height=44,this.width=44,this.freq=1e6,this.period=.5,this.addOut(22,0,10),this.set(!0),this.remaining=1/this.freq*this.period};(ke.prototype=Object.create(Y.prototype)).constructor=ke,ke.prototype.prefix="C",ke.type="Clock",ke.label="Clock",ke.desc="Clock",ke.img="clock.png",ke.order=104,ke.description="<h2>Clock</h2><p>A clock generates a sequence of pulses over time. The duty cycle is the width of the true period of the pulse as a percentage.</p>",ke.prototype.clone=function(){var t=new ke;return t.freq=this.freq,t.period=this.period,t.value=this.value,t.remaining=this.remaining,t.copyFrom(this),t},ke.prototype.advance=function(t){return this.remaining-=t,this.remaining<=0&&(this.set(!this.value),this.remaining=1/this.freq*(this.value?this.period:1-this.period),!0)},ke.prototype.set=function(t){this.value=t,this.outs[0].set(t)},ke.prototype.get=function(){return this.value},ke.prototype.compute=function(t){this.set(!1)},ke.prototype.load=function(t){this.freq=t.freq,this.period=t.period,Y.prototype.load.call(this,t)},ke.prototype.save=function(){var t=Y.prototype.save.call(this);return t.freq=this.freq,t.period=this.period,t},ke.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x,n=this.y;t.beginPath(),t.arc(i,n,this.width/2,0,2*Math.PI),t.fillStyle="#ffffff",t.fill(),t.beginPath(),t.arc(i,n,this.width/2,0,2*Math.PI),t.stroke();var o=this.x-15.5,r=this.x+15.5,s=this.y-10.4,a=this.y+10.5,l=o+this.period*(r-o),h=t.strokeStyle;t.strokeStyle="#00aa00",t.beginPath(),t.moveTo(o,a),t.lineTo(o,s),t.lineTo(l,s),t.lineTo(l,a),t.lineTo(r,a),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),t.strokeStyle=h,this.drawIO(t,e)},ke.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),r='<div class="control"><label for="'.concat(n,'">Frequency (Hz)</label>\n<input type="text" id="').concat(n,'" value="').concat(this.freq,'"></div>\n<div class="control slider"><label for="').concat(o,'">Duty Cycle</label>\n<input type="range" min="100" max="900" class="" value="').concat(1e3*this.period,'" id="').concat(o,'">\n</div>');i.extra(r,(function(){var t=document.getElementById(n).value;return+t!==parseInt(t)||t<1||t>1e7?"Frequency must be integer 1 to 1000000":null}),(function(){e.freq=document.getElementById(n).value,e.period=.001*document.getElementById(o).value})),i.open()};var Oe=function(){Y.call(this),this.height=50,this.width=40,this.addIn(-20,0,12),this.addOutInv(20,0,12)};(Oe.prototype=Object.create(Y.prototype)).constructor=Oe,Oe.type="Inverter",Oe.label="Inverter",Oe.desc="Inverter gate",Oe.order=50,Oe.description="<h2>Inverter</h2><p>The output of an Inverter gate is <em>true</em> if the \n input is false and <em>false</em> if the input is true.</p>",Oe.help="inverter",Oe.prototype.compute=function(t){this.outs[0].set(t[0])},Oe.prototype.clone=function(){var t=new Oe;return t.copyFrom(this),t},Oe.prototype.draw=function(t,e){this.selectStyle(t,e),Oe.path(t,this.x,this.y,this.width,this.height),ut.fillWith(t),Oe.path(t,this.x,this.y,this.width,this.height),t.stroke(),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-6,this.y+5),t.stroke()),this.drawIO(t,e)},Oe.path=function(t,e,i,n,o){var r=e-n/2-.5,s=e+n/2+.5,a=i-o/2-.5,l=i+o/2+.5;t.beginPath(),t.moveTo(r,a),t.lineTo(r,l),t.lineTo(s,i),t.lineTo(r,a)},Oe.paletteImage=function(){var t=new ht(120,70);return Oe.path(t.context,60,35,40,50),t.fillStroke(),t.io(-20,0,"w"),t.io(30,0,"e"),t.circle(25,0,5),t};var Ae=function(){Y.call(this),this.height=32,this.width=32,this.value=void 0,this.led=new Te(0,0,12),this.color="blue",this.addIn(-16,0,16)};(Ae.prototype=Object.create(Y.prototype)).constructor=Ae,Ae.prototype.prefix="L",Ae.prototype.nameRequired=!0,Ae.type="LED",Ae.label="LED",Ae.desc="Light Emitting Diode",Ae.img="led.png",Ae.order=102,Ae.description="<h2>LED</h2><p>An LED indicates if the input is true (color), false (black), or undefined (?). The LED color can be set using the component properties dialog box.</p>",Ae.prototype.compute=function(t){this.value=t[0]},Ae.prototype.get=function(){return this.ins[0].value},Ae.prototype.clone=function(){var t=new Ae;return t.color=this.color,t.value=this.value,t.copyFrom(this),t},Ae.prototype.draw=function(t,e){var i=this.get(),n=this.x-this.width/2-.5,o=this.y-this.height/2+.5;this.selectStyle(t,e);var r=t.fillStyle,s=t.strokeStyle,a=i?"#ffffff":"#dddddd";t.fillStyle=a,t.fillRect(n,o,this.width,this.height),t.fillStyle=r,t.beginPath(),t.rect(n,o,this.width,this.height),t.stroke(),t.lineWidth=1,t.fillStyle=r,t.strokeStyle=s,this.led.color=void 0===i?"undefined":i?this.color:"off",this.led.draw(t,this.x-.5,this.y,a);var l=12;t.fillRect(this.x-l-2,this.y-l,2,2),t.fillRect(this.x+l-2,this.y-l,2,2),t.fillRect(this.x-l-2,this.y+l,2,2),t.fillRect(this.x+l-2,this.y+l,2,2),this.drawIO(t,e)},Ae.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},Ae.prototype.load=function(t){this.color=gt.sanitize(t.color),Y.prototype.load.call(this,t)},Ae.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},Ae.prototype.properties=function(t){var e=this,i=new H(this,t,!1),n=i.uniqueId(),o=Te.colorSelector(n,this.color);i.extra(o,(function(){return null}),(function(){e.color=gt.sanitize(document.getElementById(n).value)})),i.open()};var Ce=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(Ce.prototype=Object.create(Y.prototype)).constructor=Ce,Ce.offsetX=40,Ce.offsetY=30,Ce.offsetX1=6,Ce.type="Xor",Ce.label="XOR",Ce.desc="XOR gate",Ce.img="xor.png",Ce.order=40,Ce.description="<h2>XOR Gate</h2><p>The output of an XOR gate is <em>true</em> if the state of the inputs differ. Otherwise, it is false.</p>",Ce.help="xor",Ce.prototype.compute=function(t){void 0===t[0]||void 0===t[1]?this.outs[0].set(void 0):this.outs[0].set(t[0]&&!t[1]||!t[0]&&t[1])},Ce.prototype.clone=function(){var t=new Ce;return t.copyFrom(this),t},Ce.prototype.draw=function(t,e){this.selectStyle(t,e),ve.draw(t,this.x,this.y,this.width,this.height),t.beginPath();var i=this.x-this.width/2-.5,n=Ce.offsetX,o=Math.atan2(this.height/2,n),r=n/Math.cos(o);t.arc(i-n-Ce.offsetX1,this.y,r,-o,o),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)};var Ee=function(){Y.call(this),this.height=16,this.width=96,this.narrow=!1,this.value=new Yt,this.addOut(48,0,16).bus=!0,this.set([!1,!1,!1,!1])};(Ee.prototype=Object.create(Y.prototype)).constructor=Ee,Ee.prototype.prefix="I",Ee.prototype.nameRequired=!0,Ee.type="InPinBus",Ee.label="Bus Input",Ee.desc="Bus Input Pin",Ee.img="inpinbus.png",Ee.order=300,Ee.description="<h2>Bus Input Pin</h2><p>A Bus Input pin serves as input for a circuit from a bus. Double-click to set the value.</p><p>Values can be preceeded by 0x or 0b for hexadecimal or binary values.</p><p>The display and input format is selectable. Auto format will display values with eight or fewer digits as binary and larger values in hex.</p>",Ee.help="inpinbus",Ee.prototype.clone=function(){var t=new Ee;return t.copyFrom(this),t.value=this.value.clone(),t},Ee.prototype.compute=function(t){this.outs[0].set(this.value.get())},Ee.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke();var i=this.x;this.narrow&&(i=this.x-this.height/4+1),this.value.draw(t,i,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},Ee.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,n),t.lineTo(e,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e,n)},Ee.prototype.set=function(t){Array.isArray(t)?this.value.set(t):("string"==typeof t||t instanceof String)&&this.value.setAsString(t),this.outs[0].set(this.value.get())},Ee.prototype.get=function(){return this.value.get()},Ee.prototype.setAsString=function(t,e){this.value.setAsString(t,e),e||this.outs[0].set(this.value.get())},Ee.prototype.getAsString=function(){return this.value.getAsString()},Ee.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),this.narrow&&(t.narrow=this.narrow),t},Ee.prototype.load=function(t){this.value.load(t),this.setNarrow(gt.boolean(t.narrow)),Y.prototype.load.call(this,t)},Ee.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=this.value.dialogContent(i,!0),r=o.html+'<input type="checkbox" id="'.concat(n,'" name="').concat(n,'"').concat(this.narrow?" checked":"",'> <label for="').concat(n,'">Narrow</label>');i.extra(r,o.validate,(function(){o.accept(),e.setNarrow(document.getElementById(n).checked),e.compute(null)})),i.open()},Ee.prototype.setNarrow=function(t){this.narrow=t,this.width=t?48:96,this.outs[0].x=this.width/2};var ze=function(){Y.call(this),this.value=new Yt,this.narrow=!1,this.height=16,this.width=96,this.addIn(-this.width/2,0,16).bus=!0};(ze.prototype=Object.create(Y.prototype)).constructor=ze,ze.prototype.prefix="O",ze.prototype.nameRequired=!0,ze.type="OutPinBus",ze.label="Bus Output",ze.desc="Bus Output Pin",ze.img="outpinbus.png",ze.order=302,ze.description="<h2>Bus Output Pin</h2>\n<p>An Bus Out pin serves as output for a bus in a circuit.</p>\n<p>The output format is selectable. Auto format will display values \nwith eight or fewer digits as binary and larger values in hex.</p>",ze.help="outpinbus",ze.prototype.compute=function(t){this.value.set(t[0])},ze.prototype.get=function(){return this.value.get()},ze.prototype.getAsString=function(){return this.value.getAsString()},ze.prototype.getAsValue=function(){return new Yt(this.value)},ze.prototype.clone=function(){var t=new ze;return t.copyFrom(this),t.value=this.value.clone(),t},ze.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),this.narrow&&(t.narrow=this.narrow),t},ze.prototype.load=function(t){this.value.load(t),this.setNarrow(gt.boolean(t.narrow)),Y.prototype.load.call(this,t)},ze.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke();var i=this.x+this.height/4;this.narrow&&(i-=2),this.value.draw(t,i,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},ze.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},ze.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=this.value.dialogContent(i),r=o.html+'<input type="checkbox" id="'.concat(n,'" name="').concat(n,'"').concat(this.narrow?" checked":"",'> <label for="').concat(n,'">Narrow</label>');i.extra(r,o.validate,(function(){o.accept(),e.setNarrow(document.getElementById(n).checked)})),i.open()},ze.prototype.setNarrow=function(t){this.narrow=t,this.width=t?48:96,this.ins[0].x=-this.width/2};var Be=function(){Y.call(this),this.height=16,this.width=96,this.value=new Yt,this.addOut(48,0,16).bus=!0,this.set([!1,!1,!1,!1])};(Be.prototype=Object.create(Y.prototype)).constructor=Be,Be.prototype.prefix=null,Be.type="BusConstant",Be.label="Bus Constant",Be.desc="Bus Constant value",Be.img="busconstant.png",Be.description="<h2>Bus Constant Value</h2><p>A Bus Constant is a value that can be set in the circuit as a fixed value feeding a bus.</p><p>Values can be preceeded by 0x or 0b for hexadecimal or binary values.</p><p>The display and input format is selectable. Auto format will display values with eight or fewer digits as binary and larger values in hex.</p>",Be.order=301,Be.prototype.clone=function(){var t=new Be;return t.copyFrom(this),t.value=this.value.clone(),t},Be.prototype.compute=function(t){this.outs[0].set(this.value.get())},Be.prototype.draw=function(t,e){this.drawBox(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.drawBox(t),this.value.draw(t,this.x,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},Be.prototype.set=function(t){this.value.set(t),this.outs[0].set(this.value.get())},Be.prototype.get=function(){return this.value.get()},Be.prototype.setAsString=function(t,e){this.value.setAsString(t,e),e||this.outs[0].set(this.value.get())},Be.prototype.getAsString=function(){return this.value.getAsString()},Be.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),t},Be.prototype.load=function(t){this.value.load(t),Y.prototype.load.call(this,t)},Be.prototype.properties=function(t){var e=this,i=new H(this,t);this.value.dialogOptions(i,!0,(function(){e.compute(null)})),i.open()};var Ne=function(){Y.call(this),this.height=50,this.width=80,this.size=4,this.addOut(this.width/2,0,16).bus=!0,this.ensureIO()};(Ne.prototype=Object.create(Y.prototype)).constructor=Ne,Ne.type="BusOr",Ne.label="Bus OR",Ne.desc="Bus OR gate",Ne.img="busor.png",Ne.description="<h2>Bus OR Gate</h2><p>The output of an OR gate is <em>true</em> \nif either or both  inputs are true. Otherwise, it is false. This version works for \nbuses. The size determines the number of inputs.</p>",Ne.order=308,Ne.prototype.compute=function(t){var e=[];t.forEach((function(t){if(Array.isArray(t))for(var i=0;i<t.length;i++){var n=t[i];e.length>i?!0===n&&(e[i]=!0):e.push(n)}})),this.outs[0].set(e)},Ne.prototype.clone=function(){var t=new Ne;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},Ne.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},Ne.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},Ne.prototype.ensureIO=function(){this.height=16*this.size+8,this.height<50&&(this.height=50);for(var t=this.size/2*16-8,e=0;e<this.size;e++){var i=30*this.size,n=Math.atan2(this.height/2,i),o=i/Math.cos(n),r=t-16*e,s=Math.sqrt(o*o-r*r)-i;e<this.ins.length?(this.ins[e].x=-this.width/2+s,this.ins[e].y=r,this.ins[e].len=16+s,this.ins[e].bus=!0):this.addIn(-this.width/2+s,t-16*e,16+s).bus=!0}for(;e<this.size;e++);if(e<this.ins.length){for(;e<this.ins.length;e++)this.ins[e].clear();this.ins.splice(this.size)}},Ne.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.height,n=this.width,o=this.x-n/2-.5,r=(this.x,this.y-i/2-.5),s=this.y+i/2+.5;t.beginPath();var a=30*this.size,l=Math.atan2(i/2,a),h=a/Math.cos(l);t.arc(o-a,this.y,h,-l,l);var c=(n/2*(n/2)-i/2*(i/2))/i;h=i/2+c,l=Math.atan2(c,n/2),t.moveTo(o,r),t.lineTo(this.x-this.width/4,r),t.bezierCurveTo(this.x+this.width/4,r,this.x+3*this.width/8,this.y-this.height/4,this.x+this.width/2,this.y),t.moveTo(o,s),t.lineTo(this.x-this.width/4,s),t.bezierCurveTo(this.x+this.width/4,s,this.x+3*this.width/8,this.y+this.height/4,this.x+this.width/2,this.y),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)},Ne.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO()})),i.open()};var Pe=function(){Y.call(this),this.height=100,this.width=52,this.value=null;var t=!0;Object.defineProperty(this,"bus",{get:function(){return t},set:function(e){if(t!==e){if(this.ins[0].bus!==e){for(var i=0;i<this.ins.length;i++)this.ins[i].clear();this.ins=[]}t=e,this.ensureIO()}}}),this.setSize(3),this.circuitOuts=[],this.ensureIO()};(Pe.prototype=Object.create(Y.prototype)).constructor=Pe,Pe.prototype.prefix="U",Pe.type="BusDecoder",Pe.label="Decoder",Pe.desc="Configurable Decoder",Pe.description="<h2>Decoder</h2>\n<p>The Decoder component converts a 2 to 4-bit binary value on <strong>In</strong> \nto a true on one of four to sixteen output lines. The number of outputs is determined \nby the bit size and is configurable.</p>",Pe.order=400,Pe.help="busdecoder",Pe.prototype.setSize=function(t){this.size=t,this.outputs=1;for(var e=0;e<t;e++)this.outputs*=2;this.ensureIO()},Pe.prototype.compute=function(t){if(this.bus)if(Array.isArray(t[0])){for(var e=0,i=1,n=0;n<t[0].length;n++)e+=t[0][n]?i:0,i*=2;this.set(e)}else this.set(null);else{for(var o=0,r=1,s=!1,a=0;a<t.length;a++){if(void 0===t[a]){s=!0;break}o+=t[a]?r:0,r*=2}this.set(s?null:o)}},Pe.prototype.set=function(t){if(null!=t){t&=this.outputs-1;for(var e=0;e<this.outputs;e++)this.outs[e].set(e==t)}else for(var i=0;i<this.outputs;i++)this.outs[i].set(void 0);this.value=t},Pe.prototype.clone=function(){var t=new Pe;return t.bus=this.bus,t.setSize(this.size),t.copyFrom(this),t},Pe.prototype.ensureIO=function(){var t,e=16,i=!1;if(this.height=this.outputs*e+26,this.height<80&&(this.height=80),this.ins.length>0&&this.ins[0].bus!==this.bus){for(t=0;t<this.ins.length;t++)this.ins[t].clear();this.ins=[]}if(this.bus)this.ins.length<1&&(this.addIn(-this.width/2,0,14,"In").bus=!0,i=!0);else{var n=this.size/2*e-8;for(t=0;t<this.size;t++){var o=n-t*e,r=null;t<this.ins.length?((r=this.ins[t]).x=-this.width/2,r.y=o,r.len=14):(i=!0,(r=this.addIn(-this.width/2,o,14,"I"+t)).orientation="w")}if(t<this.ins.length){for(;t<this.ins.length;t++)this.ins[t].clear();this.ins.splice(this.size)}}var s=this.width/2,a=this.outputs/2*e-8;for(t=0;t<this.outputs&&!(t>=this.outs.length);t++)this.outs[t].name="O"+t,this.outs[t].x=s,this.outs[t].y=a-t*e,this.outs[t].len=14;for(;t<this.outputs;t++)this.addOut(s,a-t*e,14,"O"+t),i=!0;if(t<this.outs.length){for(;t<this.outs.length;t++)this.outs[t].clear();this.outs.splice(this.outputs)}i&&this.set(this.value)},Pe.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5;this.y,this.height,this.y,this.height;if(this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText("decoder",this.x,this.y+this.height/2-2),null!==this.value&&this.value>=0&&this.value<this.outputs){var o=this.outs[this.value].y,r=this.value>=10?26:19;this.jaggedLine(t,i+15,this.y,n-r,this.y+o,.5)}this.drawName(t,0,-this.height/2+12),this.drawIO(t,e)},Pe.prototype.load=function(t){this.bus=!1!==t.bus,this.setSize(t.size),Y.prototype.load.call(this,t)},Pe.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.bus=this.bus,t},Pe.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size (bits): </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');o+='<div class="control center"><div class="choosers">';var r=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(r,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Input</label>\n<label><input type="radio" name="').concat(r,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Inputs</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>4?"Size must be an integer from 2 to 4":null}),(function(){e.setSize(document.getElementById(n).value),e.bus="1"===document.querySelector("input[name=".concat(r,"]:checked")).value})),i.open()},Pe.paletteImage=function(){var t=new ht(60,44);return t.box(20,42),t.io(10,-17.5,"e",8,5),t.io(-10,0,"w"),t.drawText("Decoder",0,20,"4px Times"),t};var Le=function(){Y.call(this),this.height=16,this.width=96,this.from=0,this.to=1,this.addIn(-48,0,16).bus=!0,this.addOut(48,0,16).bus=!0};(Le.prototype=Object.create(Y.prototype)).constructor=Le,Le.prototype.prefix=null,Le.type="BusSelector",Le.label="Bus Selector",Le.desc="Bus Subset Selector",Le.img="busselector.png",Le.description="<h2>Bus Selector</h2><p>A Bus Selector chooses some \nrange of bits from an input bus and feeds them to an output bus. This is a  tool \nto use to select fields from a bus.</p>\n<p>If configured as 4 to 8 (8:4 on the symbol), bits 4-8 becomes bits 0-4 on\nthe output bus. The output is a bus if more than one bit is selected and is a bit \nif only one bit is selected.</p>",Le.order=310,Le.help="busselector",Le.prototype.clone=function(){var t=new Le;return t.copyFrom(this),t.from=this.from,t.to=this.to,t},Le.prototype.compute=function(t){if(void 0!==t[0])if(this.from==this.to)this.outs[0].set(t[0][this.from]);else{for(var e=[],i=this.from;i<=this.to;i++)e.push(t[0][i]);this.outs[0].set(e)}else this.outs[0].set(void 0)},Le.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.font="14px Times",t.textAlign="center",t.fillText(this.to+":"+this.from,this.x,this.y+5),this.drawIO(t,e)},Le.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e+this.height/2,n),t.lineTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e+this.height/2,n)},Le.prototype.save=function(){var t=Y.prototype.save.call(this);return t.from=this.from,t.to=this.to,t},Le.prototype.load=function(t){this.from=t.from,this.to=t.to,Y.prototype.load.call(this,t),this.ensureIO()},Le.prototype.ensureIO=function(){this.outs[0].bus=this.from!=this.to},Le.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),r='<div class="control1 center gap">\n<input class="number" type="text" name="'.concat(n,'" id="').concat(n,'" value="').concat(this.from,'" spellcheck="false" onfocus="this.select()"> \n<label for="').concat(o,'">to </label>\n<input class="number" type="text" name="').concat(o,'" id="').concat(o,'" value="').concat(this.to,'" spellcheck="false" onfocus="this.select()"></div>');i.extra(r,(function(){var t=document.getElementById(n).value,e=document.getElementById(o).value,i=parseInt(t),r=parseInt(e);return isNaN(i)||i<0||i>32?(document.getElementById(n).select(),"Invalid from value"):isNaN(r)||r<0||r>32?(document.getElementById(o).select(),"Invalid to value"):i>r?(document.getElementById(n).select(),"Invalid values, <em>from</em> must be less than or equal to <em>to</em>."):null}),(function(){var t=document.getElementById(n).value,i=document.getElementById(o).value;e.from=parseInt(t),e.to=parseInt(i),e.ensureIO(),e.pending()})),i.open()};var Re=function(){Y.call(this),this.height=80,this.width=32,this.size=2,this.lastIn=null,this.bus=!0,this.circuitIns=[],this.addOut(this.width/2,0,8,"O").bus=!0,this.addIn(0,-this.height/2+10,13,"").orientation="n",this.ensureIO()};(Re.prototype=Object.create(Y.prototype)).constructor=Re,Re.prototype.prefix=null,Re.prototype.indent=10,Re.type="Multiplexer",Re.label="Multiplexer",Re.desc="Multiplexer",Re.img="multiplexer.png",Re.description="<h2>Multiplexer</h2><p>Multiplexes 2 to 16 inputs to a single output. The \ninputs and outputs and can be configured as buses or single bits.</p>\n<p>The value of the input pin or bus determines which input is routed to O. The input will be a single\nbit if there are two choices (binary) or a bus if there are more than 2 choices. </p>",Re.order=402,Re.help="multiplexer",Re.prototype.compute=function(t){var e=t[0];if(void 0===e)return this.outs[0].set(void 0),void(this.lastIn=null);if(Array.isArray(e)){var i=0,n=1;e.forEach((function(t){t&&(i+=n),n*=2})),e=i}else e=e?1:0;e<=t.length?(this.outs[0].set(t[e+1]),this.lastIn=e):(this.outs[0].set(void 0),this.lastIn=null)},Re.prototype.clone=function(){var t=new Re;return t.size=this.size,t.bus=this.bus,t.ensureIO(),t.copyFrom(this),t},Re.prototype.load=function(t){this.size=t.size,this.bus=!1!==t.bus,this.ensureIO(),Y.prototype.load.call(this,t)},Re.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.bus=this.bus,t},Re.prototype.ensureIO=function(){if(this.bus!==this.outs[0].bus){for(this.outs[0].clear(),this.outs[0].bus=this.bus,n=1;n<this.ins.length;n++)this.ins[n].clear();this.ins.splice(1,this.ins.length-1)}this.height=16*this.size+16,this.height<48&&(this.height=48);var t=this.width/2,e=this.ins[0];e.x=0,e.y=-this.height/2+this.indent/2,e.bus=this.size>2;for(var i=this.size/2*16-8,n=0;n<this.size&&!(n>=this.ins.length-1);n++){var o=this.ins[n+1];o.name="I"+n,o.x=-t,o.y=i-16*n,o.len=8}for(;n<this.size;n++)this.addIn(-t,i-16*n,8,"I"+n).bus=this.bus;if(++n<this.ins.length){for(;n<this.ins.length;n++)this.ins[n].clear();this.ins.splice(this.size+1)}},Re.prototype.draw=function(t,e){if(this.selectStyle(t,e),this.drawTrap(t,0,this.indent),null!==this.lastIn){var i=this.x-4,n=this.x+4,o=this.y-1,r=this.y+this.size/2*16-10-16*this.lastIn;this.jaggedLine(t,i,r,n,o,.5)}this.drawIO(t,e)},Re.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'.concat(n,'">Number of inputs: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');o+='<div class="control center"><div class="choosers">';var r=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(r,'"  ').concat(this.bus?"checked":"",' value="1"> Bus</label>\n<label><input type="radio" name="').concat(r,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?(document.getElementById(n).select(),"Must be an integer from 2 to 16"):null}),(function(){e.size=parseInt(document.getElementById(n).value),e.bus="1"===document.querySelector("input[name=".concat(r,"]:checked")).value,e.ensureIO()})),i.open()};var je=function(){};je.draw=function(t,e,i,n,o){var r=t.fillStyle,s=t.strokeStyle;t.fillStyle="#dddddd",t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.fill(),t.strokeStyle="#000000",t.lineWidth=.5,t.beginPath(),t.arc(e,i,n,0,2*Math.PI);var a=Math.cos(o)*n,l=Math.sin(o)*n;t.moveTo(e-a,i-l),t.lineTo(e+a,i+l),t.stroke(),t.strokeStyle=s,t.fillStyle=r,t.lineWidth=1};var Ue=function(){Y.call(this),this.height=50,this.width=50,this.buttonSize=40,this.value=!1,this.color="blue",this.addOut(this.width/2,0,48-this.width/2),this.set(!1)};(Ue.prototype=Object.create(Y.prototype)).constructor=Ue,Ue.prototype.prefix="B",Ue.type="Button",Ue.label="Button",Ue.desc="Push Button",Ue.img="button.png",Ue.order=100,Ue.description="<h2>Push Button</h2><p>Clicking the button turns on the output (true), while releasing turns it off.</p>",Ue.prototype.clone=function(){var t=new Ue;return t.value=this.value,t.color=this.color,t.copyFrom(this),t},Ue.prototype.compute=function(t){this.outs[0].set(this.value)},Ue.prototype.load=function(t){this.color=void 0!==t.color?t.color:"blue",Y.prototype.load.call(this,t)},Ue.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},Ue.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.y-this.height/2+.5,o=t.fillStyle,r=t.strokeStyle;switch(t.fillStyle="#cccccc",t.fillRect(i,n,this.width,this.height),t.fillStyle=o,t.beginPath(),t.rect(i,n,this.width,this.height),t.stroke(),this.color){case"blue":default:var s=["#25ffff","#15ddff","#00d5d4"];break;case"green":s=["#25ff25","#15ff00","#00d500"]}if(this.value){var a=t.createRadialGradient(this.x,this.y,1,this.x,this.y,16);a.addColorStop(0,s[0]),a.addColorStop(.5,s[1]),a.addColorStop(1,s[2]),t.fillStyle=a}else t.fillStyle="#888888";t.beginPath(),t.arc(this.x,this.y,16,0,2*Math.PI),t.fill(),t.strokeStyle="#000000",t.beginPath(),t.arc(this.x,this.y,17,0,2*Math.PI),t.lineWidth=4,t.stroke(),t.lineWidth=1,t.fillStyle=o,t.strokeStyle=r;var l=18;je.draw(t,this.x-l,this.y-l,3,.3),je.draw(t,this.x-l,this.y+l,3,1.3),je.draw(t,this.x+l,this.y-l,3,2.3),je.draw(t,this.x+l,this.y+l,3,.7),this.drawIO(t,e)},Ue.prototype.touch=function(t,e){return w.distance(new w(t,e),new w(this.x,this.y))<16?(this.set(!0),null):Y.prototype.touch.call(this,t,e)},Ue.prototype.mouseUp=function(){this.set(!1)},Ue.prototype.set=function(t){this.value=t,this.outs[0].set(t)},Ue.prototype.setAsString=function(t){var e=1==+t;this.set(e)},Ue.prototype.get=function(){return this.value},Ue.prototype.properties=function(t){var e=this,i=this,n=new H(this,t,!1),o=n.uniqueId(),r='<div class="control1 center"><label for="'+o+'">Color: </label><select id="'+o+'">';["green","blue"].forEach((function(t){t===i.color?r+="<option selected>"+t+"</option>":r+="<option>"+t+"</option>"})),r+="</select></div>",n.extra(r,(function(){return null}),(function(){e.color=document.getElementById(o).value})),n.open()};var De=function(){Y.call(this),this.size=22,this.text="Text",this.color="black",this.height=this.size,this.width=2*this.size};(De.prototype=Object.create(Y.prototype)).constructor=De,De.prototype.prefix=null,De.type="Text",De.label="Text",De.desc="Arbitrary Text",De.img="text.png",De.order=106,De.description="<h2>Text</h2><p>Arbitrary text for diagrams. Allows for notations that help\ndescribe parts of diagrams. The text size in pixels can be specified, as can the colors from a \nlimited palette.</p><p>The color selection is overridden by the selection color (red) when the \ntext component is selected.</p>",De.help="text",De.prototype.clone=function(){var t=new De;return t.copyFrom(this),t.text=this.text,t.size=this.size,t},De.prototype.draw=function(t,e){var i=this.selectStyle(t,e),n=this.text.replace(/&lt;/g,"<");if(n=(n=n.replace(/&gt;/g,">")).replace(/&amp;/g,"&"),t.font=this.size+"px Times",t.textAlign="center",i)t.fillText(n,this.x-1,this.y+5);else{var o;switch(this.color){default:o=this.color;break;case"green":o="#008000";break;case"pink":o="#FF69B4"}ut.fillTextWith(t,n,this.x-1,this.y+5,o)}this.height=this.size,this.width=t.measureText(n).width,this.drawIO(t,e)},De.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),r=i.uniqueId(),s='<div class="control">\n<label for="'.concat(n,'">Text: </label>\n<input type="text" id="').concat(n,'" value="').concat(this.text,'">\n</div>\n<div class="control1 center"><label for="').concat(o,'">Size: </label>\n<input class="number" type="text" id="').concat(o,'" value="').concat(this.size,'"></div>');s+='<div class="control1 center"><label for="'+r+'">Color: </label><select id="'+r+'">';var a=["black","green","blue","purple","orange","maroon","pink"];for(var l in a){var h=a[l];h===this.color?s+="<option selected>"+h+"</option>":s+="<option>"+h+"</option>"}s+="</select></div>",i.extra(s,(function(){var t=parseInt(document.getElementById(o).value);return isNaN(t)||t<10||t>55?"Size must be an integer between 10 and 55":gt.htmlentities(document.getElementById(n).value).length<1?"Text cannot be empty":null}),(function(){e.text=gt.htmlentities(document.getElementById(n).value),e.size=parseInt(document.getElementById(o).value),e.color=gt.sanitize(document.getElementById(r).value)})),i.open(),document.getElementById(n).select()},De.prototype.save=function(){var t=Y.prototype.save.call(this);return t.text=this.text.replace(/'/g,"`"),t.size=this.size,"black"!==this.color&&(t.color=this.color),t},De.prototype.load=function(t){this.text=gt.sanitize(t.text.replace(/`/g,"'")),this.size=+t.size,void 0!==t.color&&(this.color=gt.sanitize(t.color)),Y.prototype.load.call(this,t)};var Me=function(){Y.call(this),this.height=176,this.width=128;var t=this.width/2,e=this.height/2;this.values=[0,0,0,0,0,0,0,0],this.lastClk=!1,this.lastA=null,this.lastB=null,this.lastALU=null,this.lastW=null,this.alu=0;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-48,16,"ALU").bus=!0,this.addIn(-t,16,16,"Ae").bus=!0,this.addIn(-t,48,16,"Be").bus=!0,this.addIn(-t,-32,16,"ALUe").bus=!0,this.addIn(0,this.height/2,8,"R").orientation="s",this.addIn(-t,-16,16,"W"),this.addOut(t,-48,16,"A").bus=!0,this.addOut(t,48,16,"B").bus=!0,this.outs[0].set(void 0),this.outs[1].set(void 0)};(Me.prototype=Object.create(Y.prototype)).constructor=Me,Me.prototype.prefix="R",Me.type="Registers16",Me.label="Registers",Me.desc="Register File",Me.img="registers16.png",Me.description="<h2>Registers</h2>\n<p>Simple 16-bit register file. Ae and Be choose which register is routed to \nthe A and B outputs. ALU is the input from the ALU. ALUe chooses which register to write. \nA register will only be written if W (write enable) is high.</p><p>R is a reset input and is optional. \nThe R input (reset) sets all registers to zero.</p>\n<p>The register file sets the \nregister on the clock <em>leading edge.</em></p>",Me.order=700,Me.help="registers16",Me.prototype.compute=function(t){if(this.lastA=T.busValueToDecimal(t[2],8),this.lastB=T.busValueToDecimal(t[3],8),this.lastALU=T.busValueToDecimal(t[4],8),this.lastW=t[6],t[0]&&!this.lastClk&&(this.alu=T.busValueToDecimal(t[1]),null!==this.lastALU&&this.lastW&&(this.values[this.lastALU]=this.alu)),t[5]&&(this.values=[0,0,0,0,0,0,0,0]),null!==this.lastA){for(var e=this.values[this.lastA],i=[],n=0;n<16;n++)i.push(1==(1&e)),e>>=1;this.outs[0].set(i)}else this.outs[0].set(void 0);if(null!==this.lastB){for(var o=this.values[this.lastB],r=[],s=0;s<16;s++)r.push(1==(1&o)),o>>=1;this.outs[1].set(r)}else this.outs[1].set(void 0);this.lastClk=t[0]},Me.prototype.clone=function(){var t=new Me;return t.copyFrom(this),t.values=this.values.slice(),t},Me.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),t.font='10px "Lucida Console", Monaco, monospace',t.textAlign="left";for(var i=this.y-54,n=this.x-11,o=n+45,r=i,s=0;s<8;s++)t.fillText("r"+s+":"+b.toHex(this.values[s],4),this.x-10,r),r+=16;var a=i-4;null!==this.lastALU&&this.lastW&&this.jaggedLine(t,this.x-this.width/2+34,this.y-48,n,a+16*this.lastALU,.5),null!==this.lastA&&this.jaggedLine(t,o,a+16*this.lastA,this.x+this.width/2-14,this.y-48,.66),null!==this.lastB&&this.jaggedLine(t,o,a+16*this.lastB,this.x+this.width/2-14,this.y+48,.33),t.font="12px Times",t.textAlign="center",this.drawIO(t,e)},Me.prototype.testAsString=function(t,e){if(null!==t)if("reset"===t)this.values=[0,0,0,0,0,0,0,0],this.pending();else if("r"===t.substr(0,1)){var i=parseInt(t.substr(1,1));if(i<0||i>7)throw"Invalid register indicated in test "+t;var n=parseInt(t.substr(3));if(n!==+this.values[i])throw"Incorrect register values. Register r"+i+" expected=0x"+b.toHex(n,4)+" actual=0x"+b.toHex(this.values[i],4)}},Me.prototype.setAsString=function(t){this.testAsString(t)};var qe=function(){Y.call(this),this.height=96,this.width=32,this.valueR=void 0,this.valueY=void 0,this.valueG=void 0,this.red=new Te(0,-32,12),this.yellow=new Te(0,0,12),this.green=new Te(0,32,12),this.addIn(-16,-32,16),this.addIn(-16,0,16),this.addIn(-16,32,16)};(qe.prototype=Object.create(Y.prototype)).constructor=qe,qe.prototype.prefix="L",qe.prototype.nameRequired=!0,qe.type="TrafficLight",qe.label="Traffic Light",qe.desc="Traffic Light",qe.img="trafficlight.png",qe.description="<h2>Traffic Light</h2><p>The Traffic Light component has indicators \nfor Red, Yellow, and Green as in a conventional traffic light.</p>",qe.order=504,qe.help="trafficlight",qe.prototype.compute=function(t){this.valueR=t[0],this.valueY=t[1],this.valueG=t[2]},qe.prototype.clone=function(){var t=new qe;return t.copyFrom(this),t},qe.prototype.testAsString=function(t,e){if(null!==t){var i=t.split("=");if("?"!==i[1]){if(i.length<2)throw"Invalid traffic light test validation string "+t;var n;switch(i[0]){case"red":n=this.valueR;break;case"grn":case"green":n=this.valueG;break;case"yel":case"yellow":n=this.valueY;break;default:throw"Invalid traffic light test validation string "+t}if(void 0===n||"1"===i[1]&&!n||"0"===i[1]&&n){var o=void 0===n?"?":n?"1":"0";throw"Incorrect traffic light value. Expected "+t+" but got "+i[0]+"="+o}}}},qe.prototype.draw=function(t,e){this.selectStyle(t,e);var i="#feb51a";this.drawBox(t,i),this.red.color=void 0===this.valueR?"undefined":this.valueR?"red":"off",this.red.draw(t,this.x-.5,this.y,i),this.yellow.color=void 0===this.valueY?"undefined":this.valueY?"yellow":"off",this.yellow.draw(t,this.x-.5,this.y,i),this.green.color=void 0===this.valueG?"undefined":this.valueG?"green":"off",this.green.draw(t,this.x-.5,this.y,i),this.drawIO(t,e)};var Fe=function(){Y.call(this),this.height=134,this.width=64;this.width,this.height;var t=-56,e=16;this.addIn(-this.width/2,t,e,"I3"),t+=16,this.addIn(-this.width/2,t,e,"I2"),t+=16,this.addIn(-this.width/2,t,e,"I1"),t+=16,this.addIn(-this.width/2,t,e,"I0"),t+=32,this.addIn(-this.width/2,t,e,"I").bus=!0,t=-56,e=16,this.addOut(this.width/2,t,e,"a"),t+=16,this.addOut(this.width/2,t,e,"b"),t+=16,this.addOut(this.width/2,t,e,"c"),t+=16,this.addOut(this.width/2,t,e,"d"),t+=16,this.addOut(this.width/2,t,e,"e"),t+=16,this.addOut(this.width/2,t,e,"f"),t+=16,this.addOut(this.width/2,t,e,"g"),t+=16};(Fe.prototype=Object.create(Y.prototype)).constructor=Fe,Fe.prototype.prefix="D",Fe.type="HexToSevenSegment",Fe.label="Hex to Seven Segment",Fe.desc="Hexadecimal to Seven Segment Decoder",Fe.img=null,Fe.description="<h2>Hex to Seven Segement</h2><p>Decodes hexadecimal into the correct outputs for a seven-segment display. Accepts either single bit lines or bus input.</p>",Fe.order=506,Fe.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2],o=t[3];if((void 0===e||void 0===i||void 0===n||void 0===o)&&void 0!==t[4]){var r=t[4];e=r[3],i=r[2],n=r[1],o=r[0]}if(void 0!==e&&void 0!==i&&void 0!==n&&void 0!==o){var s=[[!0,!0,!0,!0,!0,!0,!1],[!1,!0,!0,!1,!1,!1,!1],[!0,!0,!1,!0,!0,!1,!0],[!0,!0,!0,!0,!1,!1,!0],[!1,!0,!0,!1,!1,!0,!0],[!0,!1,!0,!0,!1,!0,!0],[!0,!1,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!1,!0,!0],[!0,!0,!0,!1,!0,!0,!0],[!1,!1,!0,!0,!0,!0,!0],[!0,!1,!1,!0,!0,!0,!1],[!1,!0,!0,!0,!0,!1,!0],[!0,!1,!1,!0,!0,!0,!0],[!0,!1,!1,!1,!0,!0,!0]][(e?8:0)+(i?4:0)+(n?2:0)+(o?1:0)];for(e=0;e<7;e++)this.outs[e].set(s[e])}else for(e=0;e<7;e++)this.outs[e].set(void 0)},Fe.prototype.clone=function(){var t=new Fe;return t.copyFrom(this),t},Fe.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,3),this.drawText(t,"Hex-to-7",0,this.height/2-5),this.drawIO(t,e)},Fe.paletteImage=function(){var t=new ht(60,44);t.box(20,40),t.io(-10,-15.5,"w",4,5),t.io(10,-15.5,"e",7,5);var e=t.context.lineWidth;return t.context.lineWidth=2,t.io(-10,15.5,"w"),t.context.lineWidth=e,t.drawText("Hex-to-7",0,18,"4px Times"),t};var He=function(){Y.call(this),this.height=150,this.width=90,this.value=[void 0,void 0,void 0,void 0,void 0,void 0,void 0],this.color="green";var t=-64,e=11;this.addIn(-this.width/2,t,e,"a"),t+=16,this.addIn(-this.width/2,t,e,"b"),t+=16,this.addIn(-this.width/2,t,e,"c"),t+=16,this.addIn(-this.width/2,t,e,"d"),t+=16,this.addIn(-this.width/2,t,e,"e"),t+=16,this.addIn(-this.width/2,t,e,"f"),t+=16,this.addIn(-this.width/2,t,e,"g"),t+=16,t+=16,this.addIn(-this.width/2,t,e,"en")};(He.prototype=Object.create(Y.prototype)).constructor=He,He.prototype.prefix="L",He.prototype.nameRequired=!0,He.type="7seg",He.label="7 SEG",He.desc="7 Segment Display",He.img="7seg.png",He.order=508,He.description="<h2>7 Seg</h2><p>A 7 segment display has seven different display positions that can be set independently to make numbers and other characters. The en (enable) pin enables the display if true or if not connected.</p>",He.prototype.compute=function(t){if(!1===t[7])for(var e=0;e<7;e++)this.value[e]=!1;else for(e=0;e<7;e++)this.value[e]=t[e]},He.prototype.get=function(t){return this.ins[0].value[t]},He.prototype.clone=function(){var t=new He;return t.color=this.color,t.value=this.value.slice(),t.copyFrom(this),t},He.prototype.draw=function(t,e){var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;this.selectStyle(t,e);var s=t.fillStyle,a=t.strokeStyle;t.fillStyle="#cccccc",t.fillRect(i,o,this.width,this.height),t.fillStyle=s,t.beginPath(),t.rect(i,o,this.width,this.height),t.stroke();var l=.2*this.width,h=.02*this.width;i+=l+5,n-=l,o+=l,r-=l,t.font="11px Times",t.textAlign="center",this.drawSegment(t,this.value[0],{x:i+h,y:o},{x:n-h,y:o},"a"),this.drawSegment(t,this.value[1],{x:n,y:o+h},{x:n,y:this.y-h},"b"),this.drawSegment(t,this.value[2],{x:n,y:this.y+h},{x:n,y:r-h},"c"),this.drawSegment(t,this.value[3],{x:n-h,y:r},{x:i+h,y:r},"d"),this.drawSegment(t,this.value[4],{x:i,y:r-h},{x:i,y:this.y+h},"e"),this.drawSegment(t,this.value[5],{x:i,y:this.y-h},{x:i,y:o+h},"f"),this.drawSegment(t,this.value[6],{x:i+h,y:this.y},{x:n-h,y:this.y},"g"),t.lineWidth=1,t.fillStyle=s,t.strokeStyle=a,this.drawIO(t,e)},He.prototype.drawSegment=function(t,e,i,n,o){var r=new w(n.x-i.x,n.y-i.y),s=w.normalize(r);s=w.rotate(s,Math.PI/4);var a=w.rotate(s,Math.PI/2),l=10*.707;if(e)switch(this.color){case"red":t.fillStyle="#fe0501";break;case"blue":t.fillStyle="#15ddff";break;default:t.fillStyle="#00fb4a"}else t.fillStyle="#444444";t.strokeStyle="#222222",t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(i.x+l*s.x,i.y+l*s.y),t.lineTo(n.x+l*a.x,n.y+l*a.y),t.lineTo(n.x,n.y),t.lineTo(n.x-l*s.x,n.y-l*s.y),t.lineTo(i.x-l*a.x,i.y-l*a.y),t.lineTo(i.x,i.y),t.fill(),t.stroke();var h=new w((n.x+i.x)/2,(n.y+i.y)/2),c=w.rotate(w.normalize(r),Math.PI/2);t.fillStyle="#000000",t.fillText(o,h.x+10*c.x,h.y+10*c.y+2),void 0===e&&(t.fillStyle="#00ffff",t.fontWeight="bolder",t.fillText("?",h.x,h.y+3),t.fontWeight="normal")},He.prototype.load=function(t){this.color=t.color,Y.prototype.load.call(this,t)},He.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},He.prototype.properties=function(t){var e=this,i=new H(this,t,!1),n=i.uniqueId(),o='<div class="control1 center"><label for="'+n+'">Color: </label><select id="'+n+'">';["red","green","blue"].forEach((function(t){t===e.color?o+="<option selected>"+t+"</option>":o+="<option>"+t+"</option>"})),o+="</select></div>",i.extra(o,(function(){return null}),(function(){e.color=document.getElementById(n).value})),i.open()};var Xe=function(){Y.call(this),this.height=80,this.width=32,this.size=4,this.circuitOuts=[],this.addIn(-this.width/2,0,this.pinlength,"I").bus=!0,this.ensureIO()};(Xe.prototype=Object.create(Y.prototype)).constructor=Xe,Xe.prototype.prefix=null,Xe.prototype.indent=10,Xe.prototype.pinlength=8,Xe.type="FmBus",Xe.label="Fm Bus",Xe.desc="Bus to Single bits",Xe.img="fmbus.png",Xe.order=305,Xe.description="<h2>From Bus</h2><p>Converts a bus input into single bit outputs. This allows for simpler circuits.</p>",Xe.prototype.compute=function(t){if(Array.isArray(t[0])){for(var e=0;e<this.size&&e<t[0].length;e++)this.outs[e].set(t[0][e]);for(;e<this.size;e++)this.outs[e].set(void 0)}else for(e=0;e<this.size;e++)this.outs[e].set(void 0)},Xe.prototype.clone=function(){var t=new Xe;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},Xe.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},Xe.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},Xe.prototype.ensureIO=function(){this.height=16*this.size+16,this.height<48&&(this.height=48);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.outs.length);i++)this.outs[i].name="O"+i,this.outs[i].x=t,this.outs[i].y=e-16*i,this.outs[i].len=this.pinlength;for(;i<this.size;i++)this.addOut(t,e-16*i,this.pinlength,"O"+i);if(i<this.outs.length){for(;i<this.outs.length;i++)this.outs[i].clear();this.outs.splice(this.size)}},Xe.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawTrap(t,this.indent,0),this.drawIO(t,e)},Xe.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'+n+'">Size: </label><input class="number" type="text" id="'+n+'" value="'+this.size+'"></div>';i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO(),e.pending()})),i.open(),document.getElementById(n).select()};var We=function(){Y.call(this),this.height=80,this.width=32,this.size=4,this.circuitIns=[],this.addOut(this.width/2,0,this.pinlength,"O").bus=!0,this.ensureIO()};(We.prototype=Object.create(Y.prototype)).constructor=We,We.prototype.prefix=null,We.prototype.indent=10,We.prototype.pinlength=8,We.type="ToBus",We.label="To Bus",We.desc="Single bits to a Bus",We.img="tobus.png",We.order=306,We.description="<h2>To Bus</h2><p>Converts single bit inputs into a bus output to simplify circuits</p>",We.prototype.compute=function(t){this.outs[0].set(t)},We.prototype.clone=function(){var t=new We;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},We.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},We.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},We.prototype.ensureIO=function(){this.height=16*this.size+12,this.height<48&&(this.height=48);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.ins.length);i++)this.ins[i].name="I"+i,this.ins[i].x=-t,this.ins[i].y=e-16*i,this.ins[i].len=this.pinlength;for(;i<this.size;i++)this.addIn(-t,e-16*i,this.pinlength,"I"+i);if(i<this.ins.length){for(;i<this.ins.length;i++)this.ins[i].clear();this.ins.splice(this.size)}},We.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawTrap(t,0,this.indent),this.drawIO(t,e)},We.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'+n+'">Size: </label><input class="number" type="text" id="'+n+'" value="'+this.size+'"></div>';i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO(),e.pending()})),i.open(),document.getElementById(n).select()};var Ye=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,0,16,"D");var i=this.addIn(0,-e,11);i.orientation="n",i.clock=!0,this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(Ye.prototype=Object.create(Y.prototype)).constructor=Ye,Ye.type="DFF",Ye.label="D Flip-Flop",Ye.desc="D Flip-Flop",Ye.order=204,Ye.description="<h2>D Flip-Flop</h2><p>D Flip-Flop.</p>",Ye.prototype.compute=function(t){if(t[1]&&!this.lastClk){var e=t[0];this.outs[0].set(e),this.outs[1].set(e)}this.lastClk=t[1]},Ye.prototype.clone=function(){var t=new Ye;return t.copyFrom(this),t},Ye.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height;t.io(20,-18,"e"),t.io(20,18,"e"),t.io(-20,0,"w"),t.io(0,-40,"n"),t.circle(23,18,3);var o="20px Times";t.drawText("Q",10,-13,o),t.drawTextBar("Q",10,23,o),t.drawText("D",-12,5,o);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t};var Ve=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,-32,16,"D"),this.addIn(-t,32,16).clock=!0,this.addIn(0,-e,11,"S").orientation="n",this.addIn(0,e,11,"R").orientation="s",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(void 0),this.outs[1].set(void 0)};(Ve.prototype=Object.create(Y.prototype)).constructor=Ve,Ve.type="DFFsr",Ve.label="D Flip-Flop SR",Ve.desc="D Flip-Flop with Set/Reset",Ve.img="dffsr.png",Ve.order=206,Ve.description="<h2>D Flip-Flop with Set/Reset</h2><p>D Flip-Flop with Set and Reset. Set and Reset can be safely left unconnected.</p>",Ve.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2],o=t[3],r=this.outs[0],s=this.outs[1];!0===n&&!0===o?(r.set(void 0),s.set(void 0)):!0===n?(r.set(!0),s.set(!0)):!0===o?(r.set(!1),s.set(!1)):i&&!this.lastClk&&(r.set(e),s.set(e)),this.lastClk=i},Ve.prototype.clone=function(){var t=new Ve;return t.copyFrom(this),t};var Ze=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,-32,16,"J"),this.addIn(-t,32,16,"K"),this.addIn(-t,0,16).clock=!0,this.addIn(0,-e,11,"S").orientation="n",this.addIn(0,e,11,"R").orientation="s",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(void 0),this.outs[1].set(void 0)};(Ze.prototype=Object.create(Y.prototype)).constructor=Ze,Ze.type="JKFF",Ze.label="JK Flip-Flop",Ze.desc="JK Flip-Flop",Ze.img="jk.png",Ze.order=208,Ze.description="<h2>JK Flip-Flop</h2><p>JK Flip-Flop.</p>",Ze.prototype.compute=function(t){var e=t[3],i=t[4],n=this.outs[0],o=this.outs[1];if(!0===e&&!0===i)n.set(void 0),o.set(void 0);else if(!0===e)n.set(!0),o.set(!0);else if(!0===i)n.set(!1),o.set(!1);else if(t[2]&&!this.lastClk){var r=t[0],s=t[1];if(r&&s){var a=!this.outs[0].get();n.set(a),o.set(a)}else r?(a=!0,n.set(a),o.set(a)):s&&(a=!1,n.set(a),o.set(a))}this.lastClk=t[2]},Ze.prototype.clone=function(){var t=new Ze;return t.copyFrom(this),t};var Ge=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.addIn(-t,0,16,"D"),this.addIn(0,-e,11,"CLK").orientation="n",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(Ge.prototype=Object.create(Y.prototype)).constructor=Ge,Ge.type="DLatch",Ge.label="D  Latch",Ge.desc="D Latch",Ge.order=202,Ge.description="<h2>D Latch</h2>\n<p>A D latch passes the input D to the outputs Q and Q' when the clock input CLK is true, but\nlatches the value when CLK is false.</p>",Ge.prototype.compute=function(t){if(t[1]){var e=t[0];this.outs[0].set(e),this.outs[1].set(e)}},Ge.prototype.clone=function(){var t=new Ge;return t.copyFrom(this),t},Ge.paletteImage=function(){var t=new ht(120,120);t.context.lineWidth=1.5,t.box(40,80);t.io(20,-18,"e"),t.io(20,18,"e"),t.io(-20,0,"w"),t.io(0,-40,"n"),t.circle(23,18,3);var e="20px Times";return t.drawText("Q",10,-13,e),t.drawTextBar("Q",10,23,e),t.drawText("D",-12,5,e),t.drawText("CLK",0,-29,"12px Times"),t};var Je=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2;this.addIn(-t,-32,16,"R"),this.addIn(-t,32,16,"S"),this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(Je.prototype=Object.create(Y.prototype)).constructor=Je,Je.type="SRLatch",Je.label="SR Latch",Je.desc="SR Latch",Je.order=200,Je.description="<h2>SR Latch</h2><p>Set/Reset latch. The S input sets the output. The R input resets the output.</p>",Je.prototype.compute=function(t){this.outs[0].get(),this.outs[1].get();var e=t[0],i=t[1];e&&i?(this.outs[0].set(!0),this.outs[1].set(!1)):e?(this.outs[0].set(!1),this.outs[1].set(!1)):i&&(this.outs[0].set(!0),this.outs[1].set(!0))},Je.prototype.clone=function(){var t=new Je;return t.copyFrom(this),t},Je.paletteImage=function(){var t=new ht(120,100);t.context.lineWidth=1.5,t.box(40,70);var e=20;t.io(20,-20,"e"),t.io(20,e,"e"),t.io(-20,-20,"w"),t.io(-20,e,"w"),t.circle(23,e,3);var i="20px Times";return t.drawText("Q",10,-15,i),t.drawTextBar("Q",10,25,i),t.drawText("R",-12,-15,i),t.drawText("S",-12,25,i),t};var Qe=function(){Y.call(this),this.height=150,this.width=90,this.value=void 0;this.addIn(-this.width/2,0,11,"in").bus=!0};(Qe.prototype=Object.create(Y.prototype)).constructor=Qe,Qe.prototype.prefix="L",Qe.prototype.nameRequired=!0,Qe.type="letters16",Qe.label="16 Letter Display",Qe.desc="16 Letter Display",Qe.img="letters16.png",Qe.description='<h2>16 Letter Display</h2>\n<p>A special display used for Word Sequencing tasks. A 4-bit bus input value 0-15 (0 to f in hex) maps\nto the letters indicated in this table:</p>\n<table class="center">\n<tr><th>Value</th><th>Letter</th></tr>\n<tr><td>0</td><td>A</td></tr>\n<tr><td>1</td><td>C</td></tr>\n<tr><td>2</td><td>D</td></tr>\n<tr><td>3</td><td>E</td></tr>\n<tr><td>4</td><td>F</td></tr>\n<tr><td>5</td><td>H</td></tr>\n<tr><td>6</td><td>I</td></tr>\n<tr><td>7</td><td>L</td></tr>\n<tr><td>8</td><td>M</td></tr>\n<tr><td>9</td><td>N</td></tr>\n<tr><td>a</td><td>O</td></tr>\n<tr><td>b</td><td>R</td></tr>\n<tr><td>c</td><td>S</td></tr>\n<tr><td>d</td><td>T</td></tr>\n<tr><td>e</td><td>U</td></tr>\n<tr><td>f</td><td>W</td></tr>\n</table>\n',Qe.order=510,Qe.prototype.compute=function(t){if(Array.isArray(t[0])){var e=t[0];void 0===e[0]||void 0===e[1]||void 0===e[2]||void 0===e[3]?this.value=void 0:this.value=(e[0]?1:0)+(e[1]?2:0)+(e[2]?4:0)+(e[3]?8:0)}else this.value=void 0},Qe.prototype.get=function(t){return this.ins[0].value[t]},Qe.prototype.clone=function(){var t=new Qe;return t.value=this.value,t.copyFrom(this),t},Qe.prototype.draw=function(t,e){var i=this.x-this.width/2-.5,n=(this.x,this.width,this.y-this.height/2-.5);this.y,this.height;this.selectStyle(t,e);var o=t.fillStyle,r=t.strokeStyle;t.fillStyle="#cccccc",t.fillRect(i,n,this.width,this.height),t.fillStyle=o,t.beginPath(),t.rect(i,n,this.width,this.height),t.stroke();var s=void 0===this.value?"?":["A","C","D","E","F","H","I","L","M","N","O","R","S","T","U","W"][this.value];t.beginPath(),t.font="60px Arial",t.textAlign="center",t.strokeStyle="#008800",t.fillStyle=t.strokeStyle,t.fillText(s,this.x,this.y+20),t.stroke(),t.lineWidth=1,t.fillStyle=o,t.strokeStyle=r,this.drawName(t,0,this.height/2-8),this.drawIO(t,e)};var Ke=function(){Y.call(this),this.height=90,this.width=32;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,0,8,"D").bus=!0;var i=this.addIn(0,-e,11);i.orientation="n",i.clock=!0,this.addOut(t,0,8,"Q").bus=!0,this.outs[0].set(void 0)};(Ke.prototype=Object.create(Y.prototype)).constructor=Ke,Ke.type="Register",Ke.label="Register",Ke.desc="Register",Ke.description="<h2>Register</h2>\n<p>A bus register. Works like a D Flip-Flop for all bits on a bus input and output. \nWhen the clock input goes high, the output is set to the value of the input. Works for\nany bus size.</p>",Ke.order=404,Ke.prototype.compute=function(t){if(t[1]&&!this.lastClk){var e=t[0];this.outs[0].set(e)}this.lastClk=t[1]},Ke.prototype.clone=function(){var t=new Ke;return t.copyFrom(this),t},Ke.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,-16),this.drawIO(t,e)},Ke.paletteImage=function(){var t=new ht(60,44);return t.box(12,32),t.io(-6,0,"w"),t.io(6,0,"e"),t.drawText("D",-3,2,"7px Times"),t.drawText("Q",3,2,"7px Times"),t.clock(0,-16,"n"),t};var $e=function(){Y.call(this),this.height=128,this.width=64,this.shrink=15;var t=-this.width/2,e=this.width/2;this.addIn(t,-32,16,"A").bus=!0,this.addIn(t,32,16,"B").bus=!0;var i=.5*this.shrink,n=this.addIn(0,this.height/2-i,6+i,"C");n.orientation="s",n.bus=!0,this.addOut(e,0,16,"O").bus=!0,this.addOut(e,24,16,"CPSR").bus=!0};($e.prototype=Object.create(Y.prototype)).constructor=$e,$e.prototype.prefix="ALU",$e.prototype.nameRequired=!0,$e.type="alu4",$e.label="ALU 4",$e.desc="Simple 4-bit ALU",$e.img="alu.png",$e.description="<h2>4-bit ALU</h2><p>Simple example 4-bit ALU</p>\n<p>The operation is determined by the value of the C bus input. Operations \nsupported are:<p>\n<table>\n<tr><th>C</th><th>operation</th></tr>\n<tr><td>0</td><td>O&larr;B</td></tr>\n<tr><td>1</td><td>O&larr;A+B</td></tr>\n<tr><td>2</td><td>O&larr;A-B</td></tr>\n<tr><td>3</td><td>O&larr;A&amp;B</td></tr>\n<tr><td>4</td><td>O&larr;A|B</td></tr>\n<tr><td>5</td><td>O&larr;A&lt;&lt;B (logical)</td></tr>\n<tr><td>6</td><td>O&larr;A&lt;&lt;B (arithmetic)</td></tr>\n</table>\n<p>For the shift operations, negative values for B result in a right shift.<p>\n<p>The CPSR bits are VCZN (N is the lsb).</p>",$e.order=602,$e.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2];function o(t){if(void 0!==t){var e=1,i=0;return t.forEach((function(t){void 0!==t&&(t&&(8==e?i-=e:i+=e),e*=2)})),i}}var r=o(e),s=o(i),a=s,l=!1,h=!1;switch(o(n)){default:a=s;break;case 1:l=0!=(16&(15&r)+(15&s)),h=(a=r+s)<-8||a>7;break;case 2:l=0!=(16&(15&r)+(15&~s)+1),h=(a=r-s)<-8||a>7;break;case 3:a=r&s;break;case 4:a=r|s;break;case 5:a=s<0?(15&r)>>-s:(15&r)<<s;break;case 6:a=s<0?r>>-s:r<<s}if(void 0===a)this.outs[0].set([void 0,void 0,void 0,void 0]),this.outs[1].set([void 0,void 0,void 0,void 0]);else{var c=[1==(1&a),2==(2&a),4==(4&a),8==(8&a)];this.outs[0].set(c),this.outs[1].set([c[3],0==a,l,h])}},$e.prototype.clone=function(){var t=new $e;return t.copyFrom(this),t},$e.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-this.shrink/2),t.lineTo(i+20,this.y),t.lineTo(i,this.y+this.shrink/2),t.lineTo(i,r),t.lineTo(n,r-this.shrink),t.lineTo(n,o+this.shrink),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-15)),t.stroke(),this.drawIO(t,e)},$e.prototype.properties=function(t){new H(this,t).open()};var _e=function(t,e,i,n,o){this.label=t,this.value=e,this.x=i,this.y=n,this.size=void 0===o?30:o,this.state="off"};function ti(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return ei(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ei(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}_e.prototype.touch=function(t,e){var i=this.size;return t>this.x-i/2&&t<this.x+i/2&&e>this.y-i/2&&e<this.y+i/2&&(this.state="pressed",!0)},_e.prototype.setState=function(t){this.state=t},_e.prototype.untouch=function(){return"pressed"===this.state&&(this.state="on",!0)},_e.prototype.draw=function(t,e,i){var n=t.fillStyle,o=t.strokeStyle;e+=this.x,i+=this.y;var r=this.size,s=.85*r;switch(this.state){case"off":default:t.fillStyle="#3ab5de";break;case"pressed":t.fillStyle="#ff5255";break;case"on":t.fillStyle="#0000ff"}ut.roundedRect(t,e-r/2,i-r/2,r,r,3),t.fill(),t.lineWidth=2,t.strokeStyle="#f2f2f2",ut.roundedRect(t,e-r/2,i-r/2,r,r,3),t.stroke(),t.font=s+"px Arial",t.textAlign="center",t.fillStyle="#f2f2f2",t.fillText(this.label,e,i+.38*s),t.lineWidth=1,t.fillStyle=n,t.strokeStyle=o};var ii=function(){Y.call(this),this.height=150,this.width=150,this.value=new Yt,this.bus=!0,this.bits=4,this.clockDelay=0,this.pad=null,this.setType(16),this.setAsInteger(0),this.setPressedOut(!1)};(ii.prototype=Object.create(Y.prototype)).constructor=ii,ii.prototype.prefix="P",ii.prototype.nameRequired=!0,ii.type="Pad",ii.label="Pad",ii.desc="Configurable Keypad",ii.img="pad.png",ii.description="<h2>Configurable Keypad</h2>\n<p>Presents a keypad with from 4 to 16 buttons. If configured as a bus output, there are two outputs. \nThe top output is the bus output and is the \nmost recently pressed button value. If configured for single bit output, there will be 2-4 output bits\nthe represent the most recently pressed button. \nThe bottom output is the clock and is true when the button is pressed.</p>",ii.order=500,ii.help="pad",ii.prototype.setType=function(t){var e=this;if(this.pad!==t){var i=30;switch(t){case 16:case"16":default:!function(){e.pad=16;var t=-52.5,n=-17.5,o=17.5,r=52.5,s=-8;e.buttons=[new _e("0",0,t,t+s,i),new _e("1",1,n,t+s,i),new _e("2",2,o,t+s,i),new _e("3",3,r,t+s,i),new _e("4",4,t,n+s,i),new _e("5",5,n,n+s,i),new _e("6",6,o,n+s,i),new _e("7",7,r,n+s,i),new _e("8",8,t,9.5,i),new _e("9",9,n,9.5,i),new _e("A",10,o,9.5,i),new _e("B",11,r,9.5,i),new _e("C",12,t,44.5,i),new _e("D",13,n,44.5,i),new _e("E",14,o,44.5,i),new _e("F",15,r,44.5,i)],e.width=154,e.height=e.width+13+4,e.bits=4}();break;case 10:case"10":!function(){e.pad=10;var t=-52.5,n=-17.5,o=-8;e.buttons=[new _e("1",1,-35,t+o,i),new _e("2",2,0,t+o,i),new _e("3",3,35,t+o,i),new _e("4",4,-35,n+o,i),new _e("5",5,0,n+o,i),new _e("6",6,35,n+o,i),new _e("7",7,-35,9.5,i),new _e("8",8,0,9.5,i),new _e("9",9,35,9.5,i),new _e("0",0,0,44.5,i)],e.width=119,e.height=171,e.bits=4}();break;case 12:case"12":!function(){e.pad=12;var t=-35,n=-52.5,o=-17.5,r=-8;e.buttons=[new _e("1",1,t,n+r,i),new _e("2",2,0,n+r,i),new _e("3",3,35,n+r,i),new _e("4",4,t,o+r,i),new _e("5",5,0,o+r,i),new _e("6",6,35,o+r,i),new _e("7",7,t,9.5,i),new _e("8",8,0,9.5,i),new _e("9",9,35,9.5,i),new _e("*",10,t,44.5,i),new _e("0",0,0,44.5,i),new _e("#",11,35,44.5,i)],e.width=119,e.height=171,e.bits=4}();break;case 8:case"8":!function(){e.pad=8;var t=-17.5,n=17.5,o=-8;e.buttons=[new _e("0",0,-52.5,t+o,i),new _e("1",1,t,t+o,i),new _e("2",2,n,t+o,i),new _e("3",3,52.5,t+o,i),new _e("4",4,-52.5,9.5,i),new _e("5",5,t,9.5,i),new _e("6",6,n,9.5,i),new _e("7",7,52.5,9.5,i)],e.width=154,e.height=101,e.bits=3}();break;case 4:case"4":!function(){e.pad=4;var t=-17.5,n=17.5;e.buttons=[new _e("0",0,t,t+-8,i),new _e("1",1,n,t+-8,i),new _e("2",2,t,9.5,i),new _e("3",3,n,9.5,i)],e.width=84,e.height=101,e.bits=2}()}this.ensureIO()}else this.ensureIO()},ii.prototype.ensureIO=function(){var t=0;if(this.outs.length>0){var e=!1;if(this.outs[0].bus!==this.bus&&(e=!0),this.bus||this.outs.length===this.bits+1||(e=!0),!e){var i,n=ti(this.outs);try{for(n.s();!(i=n.n()).done;){i.value.x=this.width/2}}catch(t){n.e(t)}finally{n.f()}return}}for(t=0;t<this.outs.length;t++)this.outs[t].clear();this.outs=[];if(this.bus)this.addOut(this.width/2,-16,11).bus=!0;else for(t=0;t<this.bits;t++){var o=0-16*t;this.addOut(this.width/2,o,11)}this.addOut(this.width/2,32,11),this.setOuts(),this.setPressedOut(!1)},ii.prototype.clone=function(){var t=new ii;return t.value=this.value.clone(),t.bus=this.bus,t.setType(this.pad),t.copyFrom(this),t},ii.prototype.draw=function(t,e){var i=this,n=this.x-this.width/2-.5,o=this.y-this.height/2-.5,r=this.unselectedStyle;this.unselectedStyle="#f2f2f2",this.selectStyle(t,e);var s=t.fillStyle,a=t.strokeStyle;t.fillStyle="#111111",ut.roundedRect(t,n,o,this.width,this.height,6),t.fill();t.fillStyle=s,t.lineWidth=2,ut.roundedRect(t,n+3,o+3,this.width-6,this.height-6,6),t.stroke(),t.lineWidth=1,this.buttons.forEach((function(e){e.draw(t,i.x,i.y)})),this.drawName(t,0,this.height/2-8),t.lineWidth=1,t.fillStyle=s,t.strokeStyle=a,this.unselectedStyle=r,this.drawIO(t,e)},ii.prototype.touch=function(t,e){var i=this.size;if(!(t<this.x-i/2||t>this.x+i/2||e<this.y-i/2||e>this.y-i/2)){for(var n in this.buttons){var o=this.buttons[n];if(o.touch(t-this.x,e-this.y)){this.setAsInteger(o.value,4),this.setPressedOut(!0);break}}return Y.prototype.touch.call(this,t,e)}},ii.prototype.set=function(t){this.value.set(t),this.setOuts(),this.updateUI()},ii.prototype.setAsInteger=function(t){this.value.setAsInteger(t,this.bits),this.setOuts(),this.updateUI()},ii.prototype.updateUI=function(){var t=this.value.getAsInteger(),e=this.getPressedOut();void 0===e&&(e=!1),this.buttons.forEach((function(i){i.value!==t?i.setState("off"):e?i.setState("pressed"):i.setState("on")}))},ii.prototype.setAsString=function(t,e){"release"===t?this.mouseUp():"press:"===t.substr(0,6)?(this.value.setAsHex(t.substr(6)),this.setPressedOut(!0),this.updateUI()):(this.value.setAsString(t,e),this.updateUI()),e||this.setOuts()},ii.prototype.setOuts=function(){if(this.bus)this.outs[0].set(this.value.get());else for(var t=0;t<this.bits;t++)this.outs[t].set(this.value.getBit(t))},ii.prototype.advance=function(t){return!1},ii.prototype.compute=function(t){var e=!0===t[0];this.bus?this.outs[1].set(e):this.outs[this.bits].set(e),this.updateUI()},ii.prototype.setPressedOut=function(t){var e=this.getSimulation();null!==e&&e.queue(this,50,[t])},ii.prototype.getPressedOut=function(){return this.bus?this.outs[1].get():this.outs[this.bits].get()},ii.prototype.mouseUp=function(){this.buttons.forEach((function(t){t.untouch()})),this.setPressedOut(!1)},ii.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),t.pad=this.pad,t.bus=this.bus,t},ii.prototype.load=function(t){this.value.load(t),this.bus=!1!==t.bus,this.setType(t.pad),Y.prototype.load.call(this,t)},ii.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control center"><div class="choosers">';o+='\n<label><input type="radio" name="'.concat(n,'" value="16" ').concat(16===this.pad?"checked":"",'> 16 Buttons (Hex)</label>\n<label><input type="radio" name="').concat(n,'" value="10" ').concat(10===this.pad?"checked":"",'> 10 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="8" ').concat(8===this.pad?"checked":"",'> 8 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="4" ').concat(4===this.pad?"checked":"",'> 4 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="12" ').concat(12===this.pad?"checked":"","> Phone (12 buttons)</label>\n"),o+="<br>";var r=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(r,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Output</label>\n<label><input type="radio" name="').concat(r,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Outputs</label>'),o+="</div></div>",i.extra(o,(function(){return null}),(function(){e.bus="1"===document.querySelector("input[name=".concat(r,"]:checked")).value,e.setType(document.querySelector("input[name=".concat(n,"]:checked")).value)})),i.open()};var ni=function(){Y.call(this),this.height=50,this.width=20,this.leds=[],this.horz=!1,this.bus=!1,this.color="blue",this.lastState=[],this.setSize(4)};(ni.prototype=Object.create(Y.prototype)).constructor=ni,ni.prototype.prefix="L",ni.type="LEDBar",ni.label="LED Bar",ni.desc="LED Indicator Bar",ni.img="ledbar.png",ni.description="<h2>LED Bar</h2><p>The LED Bar component displays from two to \nsixteen LEDs in a vertical or horizontal bar that are lighted by values on discrete inputs\nor a single bus input. </p>",ni.order=502,ni.help="ledbar",ni.prototype.setSize=function(t){this.size=+t,this.ensureIO()},ni.prototype.compute=function(t){this.bus?(this.lastState=t[0],void 0===this.lastState&&(this.lastState=[])):this.lastState=t},ni.prototype.clone=function(){var t=new ni;return t.size=this.size,t.horz=this.horz,t.bus=this.bus,t.ensureIO(),t.copyFrom(this),t},ni.prototype.load=function(t){this.color=gt.sanitize(t.color),void 0!==t.horz&&(this.horz=!0===t.horz),void 0!==t.bus&&(this.bus=!0===t.bus),this.setSize(t.size),Y.prototype.load.call(this,t)},ni.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.color=this.color,t.horz=this.horz,t.bus=this.bus,t},ni.prototype.ensureIO=function(){var t=16,e=0;if(this.leds=[],this.ins.length>0&&this.ins[0].bus!==this.bus){for(e=0;e<this.ins.length;e++)this.ins[e].clear();this.ins=[]}if(this.horz){this.width=this.size*t,this.width<50&&(this.width=50),this.height=20;var i=this.size/2*t-8;for(e=0;e<this.size;e++){var n=i-e*t;this.leds.push(new Te(n,0,t,this.height))}if(this.bus){var o=null;e<this.ins.length?((o=this.ins[e]).x=-this.width/2,o.y=0,o.len=16):o=this.addIn(-this.width/2,0,16),o.orientation="w",o.bus=!0,o.autoLen()}else for(e=0;e<this.size;e++){var r=i-e*t,s=24-this.height/2,a=null;null!==(a=e<this.ins.length?this.ins[e]:this.addIn(r,this.height/2,s))&&(a.x=r,a.y=this.height/2,a.len=s,a.orientation="s",a.bus=!1)}}else{this.height=this.size*t,this.height<50&&(this.height=50),this.width=20;var l=this.size/2*t-8;for(e=0;e<this.size;e++){var h=l-e*t;this.leds.push(new Te(0,h,this.width,t))}if(this.bus){var c=null;e<this.ins.length?((c=this.ins[e]).x=0,c.y=this.height/2,c.len=16):c=this.addIn(0,this.height/2,16),c.orientation="s",c.bus=!0,c.autoLen()}else for(e=0;e<this.size;e++){var u=l-e*t,d=24-this.width/2,p=null;e<this.ins.length?((p=this.ins[e]).x=-this.width/2,p.y=u,p.len=d):p=this.addIn(-this.width/2,u,d),null!==p&&(p.orientation="w",p.bus=!1)}}if(!this.bus&&e<this.ins.length){for(;e<this.ins.length;e++)this.ins[e].clear();this.ins.splice(this.size)}},ni.prototype.draw=function(t,e){for(var i=0;i<this.lastState.length&&i<this.leds.length;i++){var n=this.lastState[i];this.leds[i].color=void 0===n?"undefined":n?this.color:"black"}for(;i<this.leds.length;i++)this.leds[i].color="undefined";var o="#444444";this.selectStyle(t,e),this.drawBox(t,o);for(var r=0;r<this.size;r++)this.leds[r].draw(t,this.x,this.y,o);this.drawBox(t,"none"),this.drawIO(t,e)},ni.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>'),r=i.uniqueId();o+=Te.colorSelector(r,this.color),o+='<div class="control center"><div class="choosers">';var s=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(s,'" ').concat(this.horz?"":"checked",' value="0"> Vertical</label>\n<label><input type="radio" name="').concat(s,'"  ').concat(this.horz?"checked":"",' value="1"> Horizontal</label>'),o+="<br>";var a=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(a,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Input</label>\n<label><input type="radio" name="').concat(a,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Inputs</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.color=gt.sanitize(document.getElementById(r).value),e.horz="1"===document.querySelector("input[name=".concat(s,"]:checked")).value,e.bus="1"===document.querySelector("input[name=".concat(a,"]:checked")).value,e.setSize(parseInt(document.getElementById(n).value))})),i.open()};var oi=function(){Y.call(this),this.height=128,this.width=64;var t=this.width/2,e=this.height/2;this.value=0,this.lastClk=!1,this.ba=0;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-32,16,"BA").bus=!0,this.addIn(-t,32,16,"B"),this.addIn(0,e,8,"R").orientation="s",this.addOut(t,-32,16,"PC").bus=!0,this.outs[0].set(void 0)};(oi.prototype=Object.create(Y.prototype)).constructor=oi,oi.prototype.prefix="PC",oi.type="Pc16",oi.label="Program Counter",oi.desc="Program Counter",oi.img="pc16.png",oi.description="<h2>Program Counter</h2><p>Simple 16-bit program counter (PC). If B is true when \nthe clock edge rises, the signed value in BA (branch address) plus 2 is added to the PC.</p>",oi.order=702,oi.help="pc16",oi.prototype.compute=function(t){t[3]?this.value=0:t[0]&&!this.lastClk&&(this.ba=T.busValueToDecimal(t[1]),this.value+=2,t[2]&&null!==this.ba&&(this.value+=this.ba+2)),this.value&=65535;for(var e=this.value,i=[],n=0;n<16;n++)i.push(1==(1&e)),e>>=1;this.outs[0].set(i),this.lastClk=t[0]},oi.prototype.clone=function(){var t=new oi;return t.copyFrom(this),t},oi.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t);var i=this.y-10;t.font='14px "Lucida Console", Monaco, monospace',t.textAlign="center",t.fillText(b.toHex(this.value,4),this.x,i),i+=20,t.font="12px Times",t.fillText("program",this.x,i),t.fillText("counter",this.x,i+15),this.drawIO(t,e)};var ri=function(){Y.call(this),this.height=132,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.data=[],this.lastAddress=0,this.lastData=0,this.write=0,this.addIn(-t,-32,16,"A").bus=!0,this.addIn(-t,32,16,"W").bus=!0;var i=this.addIn(0,-e,14);i.orientation="n",i.clock=!0,this.addOut(t,-32,16,"R").bus=!0};(ri.prototype=Object.create(Y.prototype)).constructor=ri,ri.prototype.prefix="M",ri.type="Memory16",ri.label="Memory",ri.desc="16-bit Memory",ri.img=null,ri.description="<h2>16-bit Memory Bank</h2><p>The Memory component implements a simple 16-bit Memory Bank.\nMemory is an array of bytes. The A (address) input selects a memory location that is output on the R\noutput. The component implements 16-bit memory,\nso all accesses are considered to be multiples of two and retrieve two bytes. Memory is retrieved in little-endian\nmode (first byte is the least significant byte).</p>\n<p>A clock cycle on the clock input writes the memory component with the value on the W (write) input.</p>",ri.order=704,ri.help="memory16",ri.prototype.compute=function(t){var e=T.busValueToDecimal(t[0]);if(null===e)this.outs[0].set(void 0);else{if(t[2]&&!this.lastClk&&(this.write=T.busValueToDecimal(t[1]),null!==this.write)){for(;this.data.length<e+2;)this.data.push(0);var i=this.write>>8,n=255&this.write;this.data[e]=n,this.data[e+1]=i}if(e<this.data.length-1)var o=this.data[e]+(this.data[e+1]<<8);else o=0;this.lastAddress=e,this.lastData=o;for(var r=[],s=0;s<16;s++)r.push(1==(1&o)),o>>=1;this.outs[0].set(r)}this.lastClk=t[2]},ri.prototype.setAsString=function(t,e){t=gt.sanitize(t),void 0===e&&(e=!0),e&&(this.data=[]);var i=t.split(/\s+/),n=0;for(var o in i){if((r=i[o]).indexOf(":")>=0){if(n=parseInt(r,16),isNaN(n))return"invalid input address"}else if(""!==r){var r=parseInt(r,16);if(isNaN(r))return"invalid input data";if(e){for(;this.data.length<n;)this.data.push(0);this.data[n]=r,n++}}}return e&&this.pending(),null},ri.prototype.clone=function(){var t=new ri;return t.data=this.data.slice(),t.copyFrom(this),t},ri.prototype.load=function(t){this.data=t.data,Y.prototype.load.call(this,t)},ri.prototype.save=function(){var t=Y.prototype.save.call(this);return t.data=this.data,t},ri.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText(b.toHex(this.lastAddress,4)+":"+b.toHex(this.lastData,4),this.x,this.y+this.height/2-18),t.fillText("memory",this.x,this.y+this.height/2-5),this.drawName(t,0,3),this.drawIO(t,e)},ri.prototype.properties=function(t){for(var e=this,i="",n=0;n<this.data.length;n++)n%8==0&&(i.length>0&&(i+="\n"),i+=b.toHex(n,4)+":"),i+=" "+b.toHex(this.data[n],2);var o=new H(this,t),r=o.uniqueId(),s='<div class="control"><label for="'.concat(r,'">Contents:</label>\n<textarea class="code1" type="text" rows="9" name="').concat(r,'" id="').concat(r,'" spellcheck="false">').concat(i,"</textarea>\n</div>");o.extra(s,(function(){var t=document.getElementById(r).value;return e.setAsString(t,!1)}),(function(){var t=document.getElementById(r).value;return e.setAsString(t)}),85),o.open()},ri.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height,o=18;t.io(0,-40,"n");var r=t.lineWidth(2);t.io(20,-18,"e"),t.io(-20,-18,"w"),t.io(-20,o,"w"),t.lineWidth(r);var s="20px Times";t.drawText("R",10,-13,s),t.drawText("A",-12,-13,s),t.drawText("W",-12,23,s);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t.drawText("memory",0,38,"8px Times"),t.drawText("0000:0000",0,32,"8px Times"),t};var si=function(){Y.call(this);var t=16;Object.defineProperties(this,{size:{get:function(){return t},set:function(e){switch(+e){case 8:t=8;break;default:t=16;break;case 32:t=32}}},badAddr:{writable:!0},height:{value:132},width:{value:64}});var e=this.width/2,i=this.height/2;this.lastClk=!1,this.data=[],this.lastAddress=null,this.lastData=null,this.write=0,this.addIn(-e,-32,16,"A").bus=!0,this.addIn(-e,32,16,"W").bus=!0;var n=this.addIn(0,-i,14);n.orientation="n",n.clock=!0,this.addOut(e,-32,16,"R").bus=!0};(si.prototype=Object.create(Y.prototype)).constructor=si,si.prototype.prefix="M",si.type="Memory",si.label="Memory",si.desc="Memory",si.img=null,si.description="<h2>Memory Bank</h2><p>The Memory component implements a simple Memory Bank.\nMemory is an array of bytes. The A (address) input selects a memory location that is output on the R\noutput. The component can be configured for 8-, 16-, or 32-bit memory. \n</p>\n<p>In the 16-bit configuration,\nall accesses are considered to be multiples of two and retrieve two bytes. Addresses with the lower bit set\nare considered erroneous. </p>\n<p>In the 32-bit configuration,\nall accesses are considered to be multiples of four and retrieve four bytes. Addresses with any of the lower \ntwo bits set are considered erroneous.</p>\n<p>Memory is retrieved in little-endian mode (first byte is the least significant byte). \nErroneous addresses are indicated by an X next to the A input on\n the component.</p>\n<p>A clock cycle on the clock input writes the memory component with the value on the W (write) input.</p>",si.order=705,si.help="memory",si.prototype.compute=function(t){var e=this.size/8,i=T.busValueToDecimal(t[0]),n=i;if(this.badAddr=!1,null===n)this.outs[0].set(void 0);else{switch(e){case 2:this.badAddr=0!=(1&n),n&=65534;break;case 4:this.badAddr=0!=(3&n),n&=65532}if(t[2]&&!this.lastClk&&(this.write=T.busValueToDecimal(t[1]),null!==this.write)){for(;this.data.length<n+e;)this.data.push(0);for(var o=this.write,r=0;r<e;r++)this.data[n+r]=o,o>>=8}var s=0;if(n<=this.data.length-e)for(var a=0;a<e;a++)s+=this.data[n+a]<<8*a;this.lastAddress=i,this.lastData=s;for(var l=[],h=0;h<this.size;h++)l.push(1==(1&s)),s>>=1;this.outs[0].set(l)}this.lastClk=t[2]},si.prototype.setAsString=function(t,e){t=gt.sanitize(t),void 0===e&&(e=!0),e&&(this.data=[]);var i=t.split(/\s+/),n=0;for(var o in i){if((r=i[o]).indexOf(":")>=0){if(n=parseInt(r,16),isNaN(n))return"invalid input address"}else if(""!==r){var r=parseInt(r,16);if(isNaN(r))return"invalid input data";if(e){for(;this.data.length<n;)this.data.push(0);this.data[n]=r,n++}}}return e&&this.pending(),null},si.prototype.clone=function(){var t=new si;return t.data=this.data.slice(),t.size=this.size,t.copyFrom(this),t},si.prototype.load=function(t){this.data=t.data,this.size=t.size,Y.prototype.load.call(this,t)},si.prototype.save=function(){var t=Y.prototype.save.call(this);return t.data=this.data,t.size=this.size,t},si.prototype.draw=function(t,e){var i=this.size/8;this.selectStyle(t,e),this.drawBox(t);var n=null!==this.lastAddress?b.toHex(this.lastAddress,4):"????",o=null!==this.lastData?b.toHex(this.lastData,2*i):"????????".substr(0,2*i);if(t.font="12px Times",t.textAlign="center",i<4?t.fillText(n+":"+o,this.x,this.y+this.height/2-18):(t.fillText(n+":",this.x,this.y+this.height/2-18-13),t.fillText(o,this.x,this.y+this.height/2-18)),t.fillText("memory",this.x,this.y+this.height/2-5),this.drawName(t,0,3),this.drawIO(t,e),this.badAddr){var r=t.strokeStyle;t.strokeStyle="#ff0000";var s=this.x-12,a=this.y-33;t.beginPath(),t.moveTo(s-6,a-6),t.lineTo(s+6,a+6),t.moveTo(s+6,a-6),t.lineTo(s-6,a+6),t.stroke(),t.strokeStyle=r}},si.prototype.properties=function(t){for(var e=this,i="",n=0;n<this.data.length;n++)n%8==0&&(i.length>0&&(i+="\n"),i+=b.toHex(n,4)+":"),i+=" "+b.toHex(this.data[n],2);for(var o=new H(this,t),r=o.uniqueId(),s=o.uniqueId(),a='<div class="control">\n<label for="'.concat(r,'">Contents:\n<textarea class="code1" type="text" rows="9" name="').concat(r,'" id="').concat(r,'" spellcheck="false">').concat(i,'</textarea>\n</label>\n</div>\n<div class="control center">\n<label>Size: \n<select name="').concat(s,'" id="').concat(s,'">\n'),l=0,h=[8,16,32];l<h.length;l++){var c=h[l],u=this.size===c?" selected":"";a+='<option value="'.concat(c,'"').concat(u,">").concat(c,"</option>")}a+="</select>\n</label>\n</div>",o.extra(a,(function(){var t=document.getElementById(r).value;return e.setAsString(t,!1)}),(function(){e.size=document.getElementById(s).value;var t=document.getElementById(r).value;return e.setAsString(t)}),85),o.open()},si.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height,o=18;t.io(0,-40,"n");var r=t.lineWidth(2);t.io(20,-18,"e"),t.io(-20,-18,"w"),t.io(-20,o,"w"),t.lineWidth(r);var s="20px Times";t.drawText("R",10,-13,s),t.drawText("A",-12,-13,s),t.drawText("W",-12,23,s);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t.drawText("memory",0,38,"8px Times"),t.drawText("0000:0000",0,32,"8px Times"),t};var ai=function(){Y.call(this),this.height=100,this.width=48,this.size=8,this.circuitOuts=[],this.addIn(-this.width/2,0,16,"In").bus=!0,this.ensureIO()};(ai.prototype=Object.create(Y.prototype)).constructor=ai,ai.prototype.prefix=null,ai.type="Decoder3",ai.label="3-to-8",ai.desc="3-to-8 Decoder",ai.img="decoder3.png",ai.description="<h2>3-to-8 decoder</h2>\n<p>Converts a 3-bit binary value on <strong>In</strong> to a true on one of eight output lines.</p>",ai.order=1e3,ai.prototype.compute=function(t){if(Array.isArray(t[0]))for(var e=(t[0][0]?1:0)+(t[0][1]?2:0)+(t[0][2]?4:0),i=0;i<this.size;i++)this.outs[i].set(i==e);else for(i=0;i<this.size;i++)this.outs[i].set(void 0)},ai.prototype.clone=function(){var t=new ai;return t.copyFrom(this),t},ai.prototype.ensureIO=function(){this.height=16*this.size+24,this.height<80&&(this.height=80);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.outs.length);i++)this.outs[i].name="O"+i,this.outs[i].x=t,this.outs[i].y=e-16*i,this.outs[i].len=16;for(;i<this.size;i++)this.addOut(t,e-16*i,16,"O"+i);if(i<this.outs.length){for(;i<this.outs.length;i++)this.outs[i].clear();this.outs.splice(this.size)}},ai.prototype.draw=function(t,e){this.selectStyle(t,e);this.x,this.width,this.x,this.width,this.y,this.height,this.y,this.height;this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText("decoder",this.x,this.y+this.height/2-2),this.drawIO(t,e)};var li=function(t){Y.call(this,t),this.height=120,this.width=80,this.instruction="";var e=-32;this.addOut(this.width/2,e,16,"Ae").bus=!0,e+=16,this.addOut(this.width/2,e,16,"Be").bus=!0,e+=16,this.addOut(this.width/2,e,16,"ALUe").bus=!0,e+=16,this.addOut(this.width/2,e,16,"Im").bus=!0,e+=16,this.addOut(this.width/2,e,16,"C").bus=!0,e+=16,this.setAsString("nop")};(li.prototype=Object.create(Y.prototype)).constructor=li,li.prototype.prefix="ID",li.prototype.nameRequired=!0,li.type="InstructionDecoder4",li.label="Instruction Decoder 4",li.desc="Instruction Decoder",li.img="insdecoder4.png",li.description="<h2>Instruction Decoder</h2><p>Simple example instruction decoder. Decodes assembly statements into register and ALU operations.</p>",li.help="instructiondecoder4",li.order=600,li.prototype.compute=function(t){},li.prototype.setAsString=function(t,e){this.instruction=t,void 0===e&&(e=!0);var i=this.instruction.toLowerCase().match(/\s*([a-zA-Z]*)(?:[\s,$]+([^\s,]+))?(?:[\s,$]+([^\s,]+))?(?:[\s,$]+([^\s,]+))?/);if(null===i||i.length<2)return"syntax error in input";var n=this.outs[0],o=this.outs[1],r=this.outs[2],s=this.outs[3],a=this.outs[4];function l(t){switch(t){case"r0":return"00";case"r1":return"01";case"r2":return"10";case"r3":return"11";default:return null}}function h(t){if(null==t)return null;if("#"!==t.substr(0,1))return null;var e=parseInt(t.substr(1));return e>7||e<-8?null:(0!=(8&e)?"1":"0")+(0!=(4&e)?"1":"0")+(0!=(2&e)?"1":"0")+(0!=(1&e)?"1":"0")}var c=i[1],u=i[2],d=i.length>3?i[3]:null,p=i.length>4?i[4]:null,f=l(u),v=l(d),m=l(p),y=h(d),g=h(p);function b(t){if(null===f||null===v||null===p)return null;if("#"===p.substr(0,1)){if(null===g)return"invalid immediate value";e&&(n.setAsString(v),o.setAsString("100"),r.setAsString("0"+f),a.setAsString(t),s.setAsString(g))}else null!==v&&e&&(n.setAsString(v),o.setAsString("0"+m),r.setAsString("0"+f),a.setAsString(t));return null}switch(c){case"nop":e&&(n.setAsString("00"),o.setAsString("000"),r.setAsString("100"),s.setAsString("0000"),a.setAsString("111"));break;case"mov":if(null===f)return null;if("#"===d.substr(0,1)){if(null===y)return"invalid immediate value";e&&(n.setAsString(f),o.setAsString("100"),r.setAsString("0"+f),a.setAsString("000"),s.setAsString(y))}else null!==v&&e&&(n.setAsString(f),o.setAsString("0"+v),r.setAsString("0"+f),a.setAsString("000"));break;case"add":return b("001");case"sub":return b("010");case"and":return b("011");case"or":return b("100");case"sll":return b("101");case"sla":return b("110");default:return"invalid opcode"}return null},li.prototype.clone=function(){var t=new li;return t.copyFrom(this),t},li.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,r),t.lineTo(n,r),t.lineTo(n,o),t.lineTo(i,o),t.font="12px Times",t.textAlign="center",t.fillText("instruction",this.x,this.y+this.height/2-14),t.fillText("decoder",this.x,this.y+this.height/2-2),t.fillText(this.instruction,this.x,this.y-this.height/2+11),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-15,this.y+3)),t.stroke(),this.drawIO(t,e)},li.prototype.properties=function(t){var e=this,i=this.instruction,n=new H(this,t),o=n.uniqueId(),r="<p>Value<br>"+'<input type="text" id="'.concat(o,'" spellcheck="false" value="').concat(i,'"></p>');n.extra(r,(function(){var t=document.getElementById(o).value;return e.setAsString(t,!1)}),(function(){var t=document.getElementById(o).value;e.setAsString(t)}),40),n.open();var s=document.getElementById(o);s.select(),s.focus()};var hi=function(t){Y.call(this,t),this.height=128,this.width=64,this.shrink=15,this.cin=!1;var e=-this.width/2,i=this.width/2;this.operator="";this.addIn(e,-32,16,"A").bus=!0,this.addIn(e,32,16,"B").bus=!0;var n=.5*this.shrink,o=this.addIn(0,this.height/2-n,8+n,"C");o.orientation="s",o.bus=!0,this.addIn(e,48,16,"Cin"),this.addOut(i,0,16,"O").bus=!0,this.addOut(i,24,16,"CPSR").bus=!0};(hi.prototype=Object.create(Y.prototype)).constructor=hi,hi.prototype.prefix="ALU",hi.prototype.nameRequired=!0,hi.type="Alu16",hi.label="ALU 16",hi.desc="Simple 16-bit ALU",hi.img="alu.png",hi.description="<h2>16-bit ALU</h2><p>Simple example 16-bit ALU. A and B are bus inputs to the ALU. C is the control input. Cin is the carry input for adc and sbc operations. O is a bus output result and CPSR is the status output bits for the current program status register.</p><p>If Cin is not connected, it is assumed to be false.</p><p>The status bits in CPSR are: 0:N, 1:Z, 2:C, 3:V</p>",hi.help="alu16",hi.order=706,hi.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2];function o(t){if(void 0!==t&&Array.isArray(t)){var e=1,i=0;return t.forEach((function(t){void 0!==t&&(t&&(32768==e?i-=e:i+=e),e*=2)})),i}}this.cin=void 0!==t[3]&&t[3];var r=o(e),s=o(i),a=s,l=!1,h=!1;switch(o(n)){case 8:case 0:a=r&s,this.operator="&";break;case 1:a=r^s,this.operator="xor";break;case 2:a=r<<s,this.operator="<<";break;case 3:a=(65535&r)>>s,this.operator=">>";break;case 4:var c=32768&r;a=r;for(var u=0;u<s;u++)a=r>>1,a|=c;this.operator="asr";break;case 5:a=r+s,this.cin&&a++,l=0!=(65536&(f=(65535&r)+(65535&s))),h=a<-32768||a>32768,this.operator="+";break;case 11:case 34:case 16:l=0!=(65536&(f=(65535&r)+(65535&s))),h=(a=r+s)<-32768||a>32768,this.operator="+";break;case 6:a=r-s,this.cin||a--,l=0!=(65536&(f=(65535&r)+(65535&~s)+1)),h=a<-32768||a>32768,this.operator="-";break;case 10:case 33:case 35:case 17:l=0!=(65536&(f=(65535&r)+(65535&~s)+1)),h=(a=r-s)<-32768||a>32768,this.operator="-";break;case 7:c=32768&r;a=65535&r;for(u=0;u<s;u++){var d=(1&a)<<15;a=(65535&r)>>1,a|=d}this.operator="ror";break;case 9:a=-s,this.operator="neg";break;case 12:a=r|s,this.operator="or";break;case 13:h=(a=r*s)<-32768||a>32768,this.operator="*";break;case 14:a=r&(65535^s),this.operator="bic";break;case 15:a=65535^r,this.operator="not";break;case 18:a=(r&=65535)*(s&=65535)>>16,this.operator="*^";break;default:a=s,this.operator="mov"}if(void 0===(a&=65535))this.outs[0].set([void 0,void 0,void 0,void 0]),this.outs[1].set([void 0,void 0,void 0,void 0]);else{var p=[],f=a;for(u=0;u<16;u++)p.push(1==(1&f)),f>>=1;this.outs[0].set(p),this.outs[1].set([p[15],0==a,l,h])}},hi.prototype.clone=function(){var t=new hi;return t.copyFrom(this),t},hi.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;if(t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-this.shrink/2),t.lineTo(i+20,this.y),t.lineTo(i,this.y+this.shrink/2),t.lineTo(i,r),t.lineTo(n,r-this.shrink),t.lineTo(n,o+this.shrink),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-16)),this.operator.length>1)t.font="bold 14px Times",t.textAlign="center",t.fillText(this.operator,this.x+1,this.y+4);else{t.font="bold 22px Times",t.textAlign="center";var s=6;switch(this.operator){case"+":s=6;break;case"-":s=5}t.fillText(this.operator,this.x+1,this.y+s)}t.stroke(),this.drawIO(t,e)};var ci=function(){Y.call(this),this.height=98,this.width=48;var t=this.width/2,e=this.height/2;this.value=0,this.size=16,this.lastClk=!1;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-24,8,"UP"),this.addIn(0,e,8,"R").orientation="s",this.addOut(t,-24,8,"C").bus=!0,this.set(0)};(ci.prototype=Object.create(Y.prototype)).constructor=ci,ci.prototype.prefix="C",ci.type="Counter",ci.label="Counter",ci.desc="Simple Counter",ci.description="<h2>Simple Counter</h2><p>Supports up and down counting for \narbitrary bit sizes. C is the count output. The optional UP input controls the counting\ndirection. True means up counting. If not connected, the counter counts up. R is an \nasynchronous reset. The counter increments or decrements on the clock leading edge.</p>",ci.order=406,ci.help="Counter",ci.prototype.compute=function(t){t[2]?this.set(0):t[0]&&!this.lastClk&&(!1!==t[1]?this.set(this.value+1):this.set(this.value-1)),this.lastClk=t[0]},ci.prototype.set=function(t){this.value=t;for(var e=0,i=0;i<this.size;i++)e=e<<1|1;this.value&=e;for(var n=this.value,o=[],r=0;r<this.size;r++)o.push(1==(1&n)),n>>=1;this.outs[0].set(o)},ci.prototype.clone=function(){var t=new ci;return t.size=this.size,t.copyFrom(this),t},ci.prototype.load=function(t){this.size=t.size,Y.prototype.load.call(this,t),this.set(0)},ci.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},ci.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t);var i=this.y;t.font='14px "Lucida Console", Monaco, monospace',t.textAlign="center",this.size>12?t.fillText(b.toHex(this.value,4),this.x,i):this.size>8?t.fillText(b.toHex(this.value,3),this.x,i):this.size>4?t.fillText(b.toHex(this.value,2),this.x,i):t.fillText(b.toBinary(this.value,this.size),this.x,i),i+=25,t.font="14px Times",t.fillText("counter",this.x,i),this.drawIO(t,e)},ci.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'.concat(n,'">Size in bits: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?(document.getElementById(n).select(),"Must be an integer from 2 to 16"):null}),(function(){e.size=parseInt(document.getElementById(n).value),e.set(e.value)})),i.open()},ci.paletteImage=function(){var t=new ht(60,44);return t.box(16,32),t.io(8,-8,"e"),t.io(-8,-8,"w"),t.io(0,16,"s"),t.clock(0,-16,"n"),t.drawText("0000",0,2,"6px Times"),t.drawText("Counter",0,10,"4px Times"),t};var ui=function(){Y.call(this),Object.defineProperties(this,{height:{value:32},width:{value:96},outputSize:{value:16,writable:!0},arithmetic:{value:!1,writable:!0},shift:{value:0,writable:!0}}),this.addIn(-48,8,16).bus=!0,this.addOut(48,0,16).bus=!0};(ui.prototype=Object.create(Y.prototype)).constructor=ui,ui.prototype.prefix=null,ui.type="Extend",ui.label="Extend",ui.desc="Bus Extend",ui.description="<h2>Extend</h2><p>The Extend component extends a \nbus to a larger size. A common use is to extend an immediate value \nfrom an instruction to 16 or 32 bits.</p>\n<p>The output can be optionally shifted left by a fixed number of bits.</p>",ui.order=311,ui.help="extend",ui.prototype.clone=function(){var t=new ui;return t.copyFrom(this),t.outputSize=this.outputSize,t.arithmetic=this.arithmetic,t.shift=this.shift,t},ui.prototype.compute=function(t){if(void 0!==t[0]){for(var e=[],i=0;i<this.shift;i++)e.push(0);for(var n=0,o=0;n<t[0].length&&i<this.outputSize;n++,i++)e.push(t[0][n]),o=t[0][n];for(;i<this.outputSize;i++)e.push(this.arithmetic?o:0);this.outs[0].set(e)}else this.outs[0].set(void 0)},ui.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#ffffff",t.fill(),this.selectStyle(t,e),t.stroke(),t.font="14px Times",t.textAlign="center",t.fillText("Extend",this.x,this.y+10),this.drawIO(t,e)},ui.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y-.5,r=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,o),t.lineTo(e,r),t.lineTo(i,r),t.lineTo(i,n),t.lineTo(e,o)},ui.prototype.save=function(){var t=Y.prototype.save.call(this);return t.outputSize=this.outputSize,t.arithmetic=this.arithmetic,t.shift=this.shift,t},ui.prototype.load=function(t){this.outputSize=t.outputSize,this.arithmetic=t.arithmetic,this.shift=t.shift,Y.prototype.load.call(this,t)},ui.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),r=i.uniqueId(),s='<div class="control1 center gap">\n<label>Output size (bits): \n<input class="number" type="text" name="'.concat(n,'" id="').concat(n,'" value="').concat(this.outputSize,'" spellcheck="false" onfocus="this.select()">\n</label>\n</div>\n<div class="control1 center gap">\n<label>Output shift (bits): \n<input class="number" type="text" name="').concat(r,'" id="').concat(r,'" value="').concat(this.shift,'" spellcheck="false" onfocus="this.select()">\n</label>\n</div>\n<div class="control1 center gap">\n<label for="').concat(o,'"><input type="checkbox" id="').concat(o,'" name="').concat(o,'"').concat(this.arithmetic?" checked":"","> Arithmetic extend</label>\n</div>");i.extra(s,(function(){var t=document.getElementById(n).value,e=parseInt(t);if(isNaN(e)||e<1||e>32)return document.getElementById(n).select(),"Invalid output size, must be 1 to 32";document.getElementById(r).value;var i=parseInt(t);return isNaN(i)||i<0||i>e?(document.getElementById(r).select(),"Invalid shift size, must be 0 to the bit size."):null}),(function(){e.arithmetic=document.getElementById(o).checked;var t=document.getElementById(n).value;e.outputSize=parseInt(t);var i=document.getElementById(r).value;e.shift=parseInt(i),e.pending()})),i.open(),document.getElementById(n).select()},ui.paletteImage=function(){var t=new ht(60,44),e=t.width/2,i=t.height/2,n=e-20-.5,o=e+20+.5,r=i-8-.5,s=i,a=i+8+.5;return t.context.beginPath(),t.context.moveTo(n,s),t.context.lineTo(o,r),t.context.lineTo(o,a),t.context.lineTo(n,a),t.context.lineTo(n,s),t.fillStroke(),t.io(20,0,"e"),t.io(-20,4,"w"),t.drawText("Extend",0,7,"8px Times"),t};var di=function t(e){this.message=e,"captureStackTrace"in Error?Error.captureStackTrace(this,t):this.stack=(new Error).stack};function pi(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return fi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return fi(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function fi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(di.prototype=Object.create(Error.prototype)).name="InvalidArgumentException",di.prototype.constructor=di;var vi=function t(e){var i=this;Y.call(this,e);var n=16,o=void 0;this.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,r=this.y+this.height/2+.5;if(t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-7.5),t.lineTo(i+20,this.y),t.lineTo(i,this.y+7.5),t.lineTo(i,r),t.lineTo(n,r-15),t.lineTo(n,o+15),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-16)),this.operator.length>1)t.font="bold 14px Times",t.textAlign="center",t.fillText(this.operator,this.x+1,this.y+4);else{t.font="bold 22px Times",t.textAlign="center";var s=6;switch(this.operator){case"+":s=6;break;case"-":s=5}t.fillText(this.operator,this.x+1,this.y+s)}t.stroke(),this.drawIO(t,e)},this.clone=function(){var e=new t;return e.copyFrom(this),e.size=this.size,e.output=this.output,e.control=this.control,e},this.load=function(t){this.size=t.size,this.output=t.output,this.control=t.control,Y.prototype.load.call(this,t)},this.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.output=this.output,t.control=this.control,t},this.controlMapping=function(e){if(this.control===t.CONTROL.ASAO)switch(e&=3){case 0:e=11;break;case 1:e=17;break;case 2:e=0;break;case 3:e=12}return e},function(){Object.defineProperties(i,{size:{get:function(){return n},set:function(t){if(![4,8,16,32].includes(+t))throw new di("Illegal size value "+t);n=+t}},height:{value:128},width:{value:64},output:{get:function(){return o},set:function(e){if(!t.OUTPUT.POSSIBLE.includes(+e))throw new di("Illegal output value "+e);if(o!==+e){o=+e;var i=this.outs[1];i.clear(),i.bus=o===t.OUTPUT.CPSR,i.name=t.OUTPUT.LABELS[o]}}},control:{value:t.CONTROL.THUMB,writable:!0}}),i.cin=!1;var e=-i.width/2,r=i.width/2;i.operator="";i.addIn(e,-32,16,"A").bus=!0,i.addIn(e,32,16,"B").bus=!0;var s=i.addIn(0,i.height/2-7.5,15.5,"C");s.orientation="s",s.bus=!0,i.addIn(e,48,16,"Cin"),i.addOut(r,0,16,"O").bus=!0,i.addOut(r,24,16,"CPSR").bus=!0,i.output=t.OUTPUT.CPSR}()};(vi.prototype=Object.create(Y.prototype)).constructor=vi,vi.prototype.prefix="ALU",vi.prototype.nameRequired=!0,vi.type="Alu",vi.label="ALU",vi.desc="Arithmetic Logic Unit",vi.img="alu.png",vi.description="<h2>Arithmetic Logic Unit</h2><p>A and B are bus inputs \nto the ALU. C is the control input. Cin is the carry input for adc and sbc \noperations. O is a bus output result.</p>\n<p>If Cin is not connected, it is assumed to be false.</p>\n<p>The status bits in CPSR are: 0:N, 1:Z, 2:C, 3:V</p>",vi.help="alu",vi.order=707,vi.OUTPUT={CPSR:0,N:1,Z:2,C:3,V:4,POSSIBLE:[0,1,2,3,4],NAMES:["CPSR","N - Negative","Z - Zero","C - Carry","V - Overflow"],LABELS:["CPSR","N","Z","Cout","V"]},vi.CONTROL={THUMB:0,ASAO:1,POSSIBLE:[0,1],NAMES:["Thumb (4 or 6 bits)","Add/subtract/and/or"]},vi.prototype.compute=function(t){for(var e=t[0],i=t[1],n=t[2],o=this.size,r=o/8,s=0,a=0;a<r;a++)s<<=8,s|=255;var l=1<<o-1,h=l-1,c=-h-1;function u(t){if(void 0!==t&&Array.isArray(t)){var e,i=1,n=0,o=pi(t);try{for(o.s();!(e=o.n()).done;){var r=e.value;if(void 0===r)return;r&&(i===l?n-=i:n+=i),i*=2}}catch(t){o.e(t)}finally{o.f()}return n}}this.cin=void 0!==t[3]&&t[3];var d,p=u(e),f=u(i),v=f,m=!1,y=!1;switch(this.controlMapping(u(n))){case 8:case 0:v=p&f,this.operator="&";break;case 1:v=p^f,this.operator="xor";break;case 2:v=p<<f,this.operator="<<";break;case 3:v=(p&s)>>f,this.operator=">>";break;case 4:d=p&1<<o-1,v=p;for(var g=0;g<f;g++)v=p>>1,v|=d;this.operator="asr";break;case 5:v=p+f,this.cin&&v++,m=0!=((p&s)+(f&s)&1<<o),y=v<c||v>h,this.operator="+";break;case 11:case 34:case 16:m=0!=((p&s)+(f&s)&1<<o),y=(v=p+f)<c||v>h,this.operator="+";break;case 6:v=p-f,this.cin||v--,m=0!=((p&s)+(~f&s)+1&1<<o),y=v<c||v>h,this.operator="-";break;case 10:case 33:case 35:case 17:m=0!=((p&s)+(~f&s)+1&1<<o),y=(v=p-f)<c||v>h,this.operator="-";break;case 7:d=p&l,v=p&s;for(var b=0;b<f;b++){var w=(1&v)<<o-1;v=(p&s)>>1,v|=w}this.operator="ror";break;case 9:v=-f,this.operator="neg";break;case 12:v=p|f,this.operator="or";break;case 13:y=(v=p*f)<c||v>h,this.operator="*";break;case 14:v=p&(f^s),this.operator="bic";break;case 15:v=p^s,this.operator="not";break;case 18:v=(p&s)*(f&s)>>o,this.operator="*^";break;default:v=f,this.operator="mov"}var x=[];if(void 0===(v&=s)){for(var T=0;T<o;T++)x.push(void 0);this.output===vi.OUTPUT.CPSR?this.outs[1].set([void 0,void 0,void 0,void 0]):this.outs[1].set(void 0)}else{for(var I=v,S=0;S<o;S++)x.push(1==(1&I)),I>>=1;switch(this.output){case vi.OUTPUT.CPSR:this.outs[1].set([x[o-1],0===v,m,y]);break;case vi.OUTPUT.N:this.outs[1].set(x[o-1]);break;case vi.OUTPUT.Z:this.outs[1].set(0===v);break;case vi.OUTPUT.C:this.outs[1].set(m);break;case vi.OUTPUT.V:this.outs[1].set(y)}}this.outs[0].set(x)},vi.prototype.properties=function(t){for(var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),r=i.uniqueId(),s='<div class="control-table"><div class="control">\n<label for="'.concat(n,'">Size:</label>\n<select name="').concat(n,'" id="').concat(n,'">'),a=0,l=[4,8,16,32];a<l.length;a++){var h=l[a],c=this.size===h?" selected":"";s+='<option value="'.concat(h,'"').concat(c,">").concat(h,"</option>")}s+='</select>\n</div>\n<div class="control">\n        <label>Secondary Output:</label>\n        <select class="auto" name="'.concat(o,'" id="').concat(o,'">');var u,d=pi(vi.OUTPUT.POSSIBLE);try{for(d.s();!(u=d.n()).done;){var p=u.value,f=this.output===p?" selected":"",v=vi.OUTPUT.NAMES[p];s+='<option value="'.concat(p,'"').concat(f,">").concat(v,"</option>")}}catch(t){d.e(t)}finally{d.f()}s+='</select>\n</div>\n<div class="control">\n<label>Control:</label>\n<select class="auto" name="'.concat(r,'" id="').concat(r,'">');var m,y=pi(vi.CONTROL.POSSIBLE);try{for(y.s();!(m=y.n()).done;){var g=m.value,b=this.control===g?" selected":"",w=vi.CONTROL.NAMES[g];s+='<option value="'.concat(g,'"').concat(b,">").concat(w,"</option>")}}catch(t){y.e(t)}finally{y.f()}s+="</select>\n</div></div>",i.extra(s,(function(){return null}),(function(){return e.size=document.getElementById(n).value,e.output=document.getElementById(o).value,null}),85),i.open()};var mi=function(){};mi.go=function(t){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?t():document.addEventListener("DOMContentLoaded",t)};var yi=function(t,e){var n,o=this,r=i(75456);this.version=r.version,this.root=i.p,this.sel=t,this.options=new ce(e),this.components=new ue,(n=this.components).add(de),n.add(pe),n.add(Ie),n.add(Se),n.add(fe),n.add(be),n.add(we),n.add(xe),n.add(ve),n.add(me),n.add(ye),n.add(ge),n.add(Ce),n.add(Oe),n.add(Ue),n.add(Ae),n.add(ke),n.add(De),n.add(Je),n.add(Ge),n.add(Ye),n.add(Ve),n.add(Ze),n.add(Ee),n.add(Be),n.add(ze),n.add(Xe),n.add(We),n.add(Ne),n.add(Le),n.add(ui),n.add(Pe),n.add(Re),n.add(Ke),n.add(ci),n.add(ii),n.add(ni),n.add(qe),n.add(Fe),n.add(He),n.add(Qe),n.add(li),n.add($e),n.add(Me),n.add(oi),n.add(ri),n.add(si),n.add(hi),n.add(vi),n.add(ai),n.addPalette("combinatorial",[ve,fe,Oe,Ce,xe,ge]),n.addPalette("sequential",[Ye,Ve,Ze,Ge,Je]),n.addPalette("bus",[Ee,ze,Ne,Le,Pe,Re]),n.addPalette("all",[de,pe,Ie,Se,ke,Ue,Ae,De,ve,me,ye,ge,fe,be,we,xe,ni,Oe,Ce,Ye,Ve,Ze,Ge,Je,Ee,ze,Be,Ne,Pe,Le,ui,Re,qe,Fe,He,Xe,We,Ke,Qe,$e,Me,oi,si,li,ii,vi,ci]);var s=[],a=[];this.start=function(){if(null===t)return o.startNow();mi.go((function(){o.startNow()}))},this.startNow=function(){if(null===t){o.options.display="none";var e=new he(o,null,a);return s.push(e),e}if(t instanceof Element){var n=new he(o,t,a);s.push(n)}else for(var r=document.querySelectorAll(t),l=0;l<r.length;l++){var h=r[l],c=new he(o,h,a);s.push(c)}return 1===s.length?(null!==o.options.global&&(i.g[o.options.global]=s[0]),s[0]):null},this.getInstances=function(){return s},this.addTest=function(t){a.push(t)},this.runTest=function(t){s.forEach((function(e){e.runTest(t)}))}},gi=i(70802),bi={};bi.styleTagTransform=f(),bi.setAttributes=c(),bi.insert=l().bind(null,"head"),bi.domAPI=s(),bi.insertStyleElement=d();o()(gi.Z,bi);gi.Z&&gi.Z.locals&&gi.Z.locals;yi.Cirsim=yi,mi.go((function(){for(var t=document.querySelectorAll("div.cirsim-install"),e=0;e<t.length;e++){var i=t[e];i.classList.remove("cirsim-install");var n=JSON.parse(i.textContent);i.innerHTML="",new yi(i,n).startNow(),i.style.display="block"}})),i.g.Cirsim=yi;var wi=function(){};wi.create=function(t){function e(){for(var t=document.querySelectorAll("div.cirsim-install"),e=0;e<t.length;e++){var i=t[e],n=JSON.parse(i.textContent);i.innerHTML="",new yi(i,n).startNow(),i.style.display="block",i.classList.remove("cirsim-install")}}t.start((function(){e()})),t.messageListener((function(t,i){switch(t){case"cl-quiz-after-installed":case"cl-grades-grader-installed":e()}}))};wi.create(Site.Site)},70802:(t,e,i)=>{"use strict";i.d(e,{Z:()=>d});var n=i(78018),o=i.n(n),r=i(14104),s=i.n(r),a=i(54129),l=i.n(a),h=new URL(i(84324),i.b),c=s()(o()),u=l()(h);c.push([t.id,'div.cirsim div.toast{position:absolute;bottom:0;visibility:hidden;transform:translateY(2.3em);z-index:400;transition:all .4s ease-in-out 0s,visibility 0s linear .4s,z-index 0s linear .01s;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:1.1em;left:calc(50% - 30em/2);width:30em;background-color:#151515;color:#fff;text-align:center;border-top-left-radius:10px;border-top-right-radius:10px;padding:.5em}div.cirsim div.toast.toast-active{visibility:visible;transform:translateY(0%);transition-delay:0s,0s,.4s;z-index:400}div.cirsim nav.menubar{position:relative;z-index:100;margin:0;border:0;padding:0;background-color:#f0f3f0;border-bottom:thin solid gray;font-size:.9rem}div.cirsim nav.menubar li:hover{background:#00796b}div.cirsim nav.menubar li{user-select:none;cursor:pointer}div.cirsim nav.menubar li a,div.cirsim nav.menubar li a:link,div.cirsim nav.menubar li a:visited{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.9rem;color:#000;text-decoration:none}div.cirsim nav.menubar>ul{list-style-type:none;margin:0;border:0;padding:0}div.cirsim nav.menubar>ul img.check{vertical-align:baseline;width:19px;height:16px;content:url('+u+')}div.cirsim nav.menubar>ul>li{display:inline-block;margin:0;border:0;padding:.25em 2em .25em .5em;position:relative}div.cirsim nav.menubar>ul>li a,div.cirsim nav.menubar>ul>li a:link,div.cirsim nav.menubar>ul>li a:visited{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.9rem;color:#000;text-decoration:none}div.cirsim nav.menubar>ul ul{visibility:hidden;opacity:0;transform:translateY(-2em);z-index:-1;transition:all .2s ease-in-out 0s,visibility 0s linear .2s,z-index 0s linear .01s;list-style-type:none;position:absolute;overflow:hidden;left:0;top:100%;margin:1px 0 0 0;background-color:#f0f3f0;padding:0;border:1px solid gray;border-top-width:0}div.cirsim nav.menubar>ul ul>li{padding:0 5px;margin:0;overflow:hidden}div.cirsim nav.menubar>ul ul>li a{display:inline-block;width:8em;padding-top:5px;padding-bottom:5px}div.cirsim nav.menubar>ul ul>li.menu-disabled a{opacity:.3}div.cirsim nav.menubar>ul ul.menu-open{visibility:visible;opacity:1;z-index:100;transform:translateY(0%);transition-delay:0s,0s,.2s}div.cirsim nav.menubar>ul ul.edit-menu a{width:6em}div.cirsim nav.menubar>ul ul.option-menu a{width:11em}div.cirsim nav.menubar>ul ul.help-menu a{width:7.5em}div.cirsim nav.menubar>ul .ul-state-active{color:red}div.cirsim nav.menubar>ul li.menu-divider{height:1px;border:0 solid #000;border-top-width:1px}div.cirsim div.cs-palette{position:absolute;left:0;top:0;bottom:0;box-sizing:border-box;width:83px;background:#fff;border-right:1px solid #000;padding:1em 5px;z-index:5;overflow-y:scroll;overflow-x:hidden;cursor:pointer;-moz-user-select:-moz-none;-webkit-user-select:none;-ms-user-select:none;user-select:none}div.cirsim div.cs-palette div.cs-item{position:relative;min-height:60px;border-bottom:thin solid #ddd;align-items:center;display:flex}div.cirsim div.cs-palette div.cs-item div.cs-box{vertical-align:middle;margin:0;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none}div.cirsim div.cs-palette div.cs-item div.cs-box div.cs-img{margin:0;padding:0;border:0;line-height:0}div.cirsim div.cs-palette div.cs-item div.cs-box img{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border:0;margin:0}div.cirsim div.cs-palette div.cs-item div.cs-box div.cs-desc{display:block;font-style:normal;font-weight:bold;padding:0;margin:0;text-align:center;font-size:.8em}div.cirsim div.cs-palette div.cs-item div.cs-box div.long{font-size:.65em}div.cirsim div.cs-palette figure{position:relative;top:50%;transform:translateY(-50%);margin:0;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border-bottom:thin solid #ddd}div.cirsim div.cs-palette figure img{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border:0;margin:0}div.cirsim div.cs-palette figure figcaption{font-style:normal;font-weight:bold;padding:0;margin:0;text-align:center}div.cirsim div.cs-palette figure figcaption.long{font-size:.65em}.cirsim-dialog-titlebar{position:absolute;top:50%;width:20px;margin:-10px 0 0 0;padding:1px;height:20px}.cirsim-home{right:calc(.6em + 20px)}.cirsim-back{right:calc(.9em + 40px)}.cirsim-help{position:relative;width:100%;max-width:100%;padding:.5em}.cirsim-help p:first-child{margin-top:0}.cirsim-help figure{text-align:center;overflow-x:auto;margin:1em 0}.cirsim-help figure img{box-shadow:none;border:0;padding:0;margin:0}.cirsim .help-div{padding:0;border-left:1px solid #aaa;border-right:1px solid #aaa;background-color:#fff}.cirsim .help-div div.header{box-sizing:border-box;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:bold;background-color:#009688;color:#000;width:100%;padding:0;margin:0;border:0;z-index:20;height:25px;display:flex;flex-direction:row;flex-wrap:nowrap}.cirsim .help-div div.header h1{flex-grow:1;margin:0;padding:4px 4px 0 10px;font-family:"Trebuchet MS",Helvetica,sans-serif;font-size:16px;line-height:16px;user-select:none}.cirsim .help-div div.header button{box-size:border-box;flex:0 0 25px;width:25px;height:25px;padding:0;margin:0;border:0;background:none;outline:none}.cirsim .help-div div.header button:hover{background-color:#e81123;cursor:pointer}div.cirsim div.work{position:absolute;width:100%;left:0;top:1.53em;right:0;bottom:0;background:#000}div.cirsim-install{display:none}div.cirsim .cirsim-overlay{position:absolute;left:0;right:0;top:0;bottom:0;background:#a00;opacity:.05;z-index:2000;display:none}div.cirsim div.main{line-height:normal;font-size:1rem;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}div.cirsim div.help-div{line-height:normal;font-size:1rem;display:none}div.cirsim.docked-help .main{position:absolute;top:0;left:0;right:325px;bottom:0}div.cirsim.docked-help .help-div{display:block;box-sizing:border-box;position:absolute;top:0;bottom:0;right:0;width:325px;overflow:auto}div.cirsim-full{position:absolute;left:0;right:0;top:0;bottom:0;background:#fff}div.cirsim-inline{position:relative;margin:0;border:0;padding:0;background:#fff;overflow:hidden}div.cirsim-inline div{text-align:center}div.cirsim-inline canvas{margin:0 auto}div.cirsim-window{position:relative;width:100%;height:600px;margin:0;border-left:0;border-right:0;padding:0;border-top:thin solid #aaa;background:#fff;min-height:100px;min-width:800px}div.cirsim.height300{height:300px}div.cirsim div.cirsim-dlg-content{position:relative;padding:.5em;font-size:.95em}div.cirsim div.cirsim-dlg-content input{padding:3px;box-sizing:border-box;font-size:1.1em}div.cirsim div.cirsim-dlg-content h2{margin:.75em 0}div.cirsim div.cirsim-dlg-content form{position:relative;height:100%}div.cirsim div.cirsim-dlg-content .large{font-size:1.2em}div.cirsim div.cirsim-dlg-content fieldset{position:relative;border:0;margin:0;padding:0;height:100%;min-width:0;max-width:100%}div.cirsim div.cirsim-dlg-content p.error{margin:1em 0 0 0;text-align:center;color:red;font-size:.9em;font-style:italic}div.cirsim div.cirsim-dlg-content div.control{position:relative;margin:0 0 1em 0}div.cirsim div.cirsim-dlg-content div.control div.left{text-align:left}div.cirsim div.cirsim-dlg-content div.control label{display:block;font-style:italic;margin:.2em 0 .1em 0}div.cirsim div.cirsim-dlg-content div.control input{display:block}div.cirsim div.cirsim-dlg-content div.control input[type=text],div.cirsim div.cirsim-dlg-content div.control input[type=file]{width:100%}div.cirsim div.cirsim-dlg-content div.control input[type=radio]{display:inline-block}div.cirsim div.cirsim-dlg-content div.control input[type=range]{width:100%}div.cirsim div.cirsim-dlg-content div.control p.selector{text-align:center}div.cirsim div.cirsim-dlg-content div.control select{width:6em}div.cirsim div.cirsim-dlg-content div.control select.auto{width:auto}div.cirsim div.cirsim-dlg-content div.control select.files{width:100%}div.cirsim div.cirsim-dlg-content div.control div.notice{position:absolute;width:100%;left:0;top:45%;text-align:center;font-style:italic;color:#8b4513}div.cirsim div.cirsim-dlg-content div.control textarea{width:100%}div.cirsim div.cirsim-dlg-content div.control div.choosers{display:inline-block;text-align:left}div.cirsim div.cirsim-dlg-content div.control1{margin:0 0 1em 0}div.cirsim div.cirsim-dlg-content div.control1 label{display:inline-block;font-style:italic;padding-right:.5em}div.cirsim div.cirsim-dlg-content div.control1 select{width:6em}div.cirsim div.cirsim-dlg-content div.control1 input.number{width:2em;text-align:center}div.cirsim div.cirsim-dlg-content div.control1 input.compname{width:4em}div.cirsim div.cirsim-dlg-content div.control1 input.tabname{width:6em}div.cirsim div.cirsim-dlg-content div.control1 select.auto{width:auto}div.cirsim div.cirsim-dlg-content div.control-table{margin:0 auto;display:table}div.cirsim div.cirsim-dlg-content div.control-table div.control{display:table-row;height:2em}div.cirsim div.cirsim-dlg-content div.control-table div.control label{display:table-cell;text-align:right;padding-right:.5em}div.cirsim div.cirsim-dlg-content div.control-table div.control select{display:table-cell}div.cirsim div.cirsim-dlg-content div.center{text-align:center}div.cirsim div.cirsim-dlg-content div.indent{margin-left:20px;margin-right:20px}div.cirsim div.cirsim-dlg-content h1{margin:0 0 .5em 0}div.cirsim div.cirsim-dlg-content p,div.cirsim div.cirsim-dlg-content li{color:#606060}div.cirsim div.cirsim-dlg-content .gap{margin-top:1em}div.cirsim.about{width:400px;text-align:center}div.cirsim.about img{width:171px;height:75px}div.cirsim.about div.cirsim-dlg-content{padding:1em}div.cirsim.about figure img{box-shadow:none}div.cirsim.help{width:500px;height:600px}div.cirsim.component a.helper{display:block;position:absolute;right:.5em;top:.5em;float:right;color:#606060;font-style:italic;text-decoration:underline;cursor:pointer;font-size:.85em;padding:0}div.cirsim .cirsim-error{color:red}div.cirsim-dialog{padding:1em;font-size:.95em}div.cirsim table{margin-left:auto;margin-right:auto;border-collapse:separate;border-spacing:0;font-size:.9em}div.cirsim table th{color:#fff;background:#18453b;background:linear-gradient(#18453B, #73d189);text-shadow:rgba(0,0,0,.4) 0 1px 0;border-right:1px solid #c1dad7;border-bottom:1px solid #c1dad7;border-top:1px solid #c1dad7;letter-spacing:1px;text-align:left;padding:2px 6px;font-family:Helvetica,Arial,sans-serif;text-decoration:none;vertical-align:bottom}div.cirsim table th a:link{color:#f5f3eb}div.cirsim table th a:visited{color:#e3dcc5}div.cirsim table th a:hover{color:#fff}div.cirsim table th.width40{width:20%}div.cirsim table th.width40em{width:40em}div.cirsim table th.width20em{width:20em}div.cirsim table td{border-right:1px solid #c1dad7;border-bottom:1px solid #c1dad7;background:#fff;padding:.25em .75em;color:#4f6b72}div.cirsim table td a,div.cirsim table td a:link,div.cirsim table td a:visited,div.cirsim table td a:hover{text-decoration:underline}div.cirsim table td a:link{color:#8a8a8a}div.cirsim table td a:visited{color:#b09d5b}div.cirsim table td a:hover{color:#36c}div.cirsim table.center td,div.cirsim table.center th{text-align:center}div.cirsim table.truth-table th{color:#000;background:#fff;text-shadow:none;border:none;border-bottom:1px solid #000;text-align:center}div.cirsim table.truth-table td{border:0}div.cirsim table.truth-table th:last-child,div.cirsim table.truth-table td:last-child{border-left:thin solid #000}div.cirsim div.tabs{position:absolute;left:83px;top:0;bottom:0;right:0;font-size:.8rem;padding:0;background:#ddd;border:0}div.cirsim div.tabs>ul{margin:0;padding:3px 0 0 2px;background:rgba(0,0,0,0);border:0;list-style:none}div.cirsim div.tabs>ul>li{position:relative;display:inline-block;font-size:.8rem;padding:.25em 1em .45em 1em;min-width:6em;text-align:center;cursor:pointer;background:#ccc;border:1px solid #000;border-bottom:none;border-radius:5px 5px 0 0;margin:1px 3px -1px 0;white-space:nowrap;z-index:18}div.cirsim div.tabs>ul>li a{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;text-decoration:none;color:#000;outline:0;user-select:none}div.cirsim div.tabs>ul>li.selected{background:#fff;z-index:22}div.cirsim div.tabs>ul>li.selected a{color:#000}div.cirsim div.tabs div.tab{position:absolute;display:none;left:0;top:29px;right:0;bottom:0;z-index:20;overflow:auto}div.cirsim div.tabs div.tab canvas{position:absolute;top:0;left:0;width:500px;height:500px;cursor:pointer}div.cirsim div.tabs div.tab.selected{display:block;background:#fff;border-top:1px solid #000}div.cirsim-test-result p.cs-result{text-align:center;color:#000}div.cirsim-test-result p.cs-info{text-align:center;font-size:.9em;font-style:italic}',""]);const d=c},70959:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(78018),o=i.n(n),r=i(14104),s=i.n(r)()(o());s.push([t.id,"div.cl-cirsim{display:none}div.cl-cirsim-gap-before,div.cl-cirsim-gap-after{margin-top:0;margin-bottom:0;height:1px}div.cl-cirsim-gap-after{height:1em}",""]);const a=s},43096:function(t,e){var i,n,o;n=[],i=function(){"use strict";var t={defaultCompare:function(t,e){return t<e?-1:t===e?0:1},defaultEquals:function(t,e){return t===e},defaultToString:function(e){return null===e?"BUCKETS_NULL":t.isUndefined(e)?"BUCKETS_UNDEFINED":t.isString(e)?e:e.toString()},isFunction:function(t){return"function"==typeof t},isUndefined:function(t){return void 0===t},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},reverseCompareFunction:function(e){return t.isFunction(e)?function(t,i){return-1*e(t,i)}:function(t,e){return t<e?1:t===e?0:-1}},compareToEquals:function(t){return function(e,i){return 0===t(e,i)}},arrays:{}};return t.arrays.indexOf=function(e,i,n){var o,r=n||t.defaultEquals,s=e.length;for(o=0;o<s;o+=1)if(r(e[o],i))return o;return-1},t.arrays.lastIndexOf=function(e,i,n){var o,r=n||t.defaultEquals;for(o=e.length-1;o>=0;o-=1)if(r(e[o],i))return o;return-1},t.arrays.contains=function(e,i,n){return t.arrays.indexOf(e,i,n)>=0},t.arrays.remove=function(e,i,n){var o=t.arrays.indexOf(e,i,n);return!(o<0||(e.splice(o,1),0))},t.arrays.frequency=function(e,i,n){var o,r=n||t.defaultEquals,s=e.length,a=0;for(o=0;o<s;o+=1)r(e[o],i)&&(a+=1);return a},t.arrays.equals=function(e,i,n){var o,r=n||t.defaultEquals,s=e.length;if(e.length!==i.length)return!1;for(o=0;o<s;o+=1)if(!r(e[o],i[o]))return!1;return!0},t.arrays.copy=function(t){return t.concat()},t.arrays.swap=function(t,e,i){var n;return!(e<0||e>=t.length||i<0||i>=t.length||(n=t[e],t[e]=t[i],t[i]=n,0))},t.arrays.forEach=function(t,e){var i,n=t.length;for(i=0;i<n;i+=1)if(!1===e(t[i]))return},t.Bag=function(e){var i={},n=e||t.defaultToString,o=new t.Dictionary(n),r=0;return i.add=function(e,n){var s;return(isNaN(n)||t.isUndefined(n))&&(n=1),!(t.isUndefined(e)||n<=0||(i.contains(e)?o.get(e).copies+=n:(s={value:e,copies:n},o.set(e,s)),r+=n,0))},i.count=function(t){return i.contains(t)?o.get(t).copies:0},i.contains=function(t){return o.containsKey(t)},i.remove=function(e,n){var s;return(isNaN(n)||t.isUndefined(n))&&(n=1),!(t.isUndefined(e)||n<=0||!i.contains(e)||(s=o.get(e),r-=n>s.copies?s.copies:n,s.copies-=n,s.copies<=0&&o.remove(e),0))},i.toArray=function(){var t,e,i,n,r,s=[],a=o.values(),l=a.length;for(n=0;n<l;n+=1)for(e=(t=a[n]).value,i=t.copies,r=0;r<i;r+=1)s.push(e);return s},i.toSet=function(){var e,i=new t.Set(n),r=o.values(),s=r.length;for(e=0;e<s;e+=1)i.add(r[e].value);return i},i.forEach=function(t){o.forEach((function(e,i){var n,o=i.value,r=i.copies;for(n=0;n<r;n+=1)if(!1===t(o))return!1;return!0}))},i.size=function(){return r},i.isEmpty=function(){return 0===r},i.clear=function(){r=0,o.clear()},i.equals=function(e){var n;return!t.isUndefined(e)&&"function"==typeof e.toSet&&i.size()===e.size()&&(n=!0,e.forEach((function(t){return n=i.count(t)===e.count(t)})),n)},i},t.BSTree=function(e){function i(t,e){for(var i,n=t;void 0!==n&&0!==i;)(i=s(e,n.element))<0?n=n.leftCh:i>0&&(n=n.rightCh);return n}function n(t){for(var e=t;void 0!==e.leftCh;)e=e.leftCh;return e}var o,r={},s=e||t.defaultCompare,a=0;return r.add=function(e){function i(t){for(var e,i,n=o;void 0!==n;){if(0===(i=s(t.element,n.element)))return;i<0?(e=n,n=n.leftCh):(e=n,n=n.rightCh)}return t.parent=e,void 0===e?o=t:s(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t}return!t.isUndefined(e)&&void 0!==i({element:e,leftCh:void 0,rightCh:void 0,parent:void 0})&&(a+=1,!0)},r.clear=function(){o=void 0,a=0},r.isEmpty=function(){return 0===a},r.size=function(){return a},r.contains=function(e){return!t.isUndefined(e)&&void 0!==i(o,e)},r.remove=function(t){function e(t,e){void 0===t.parent?o=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,void 0!==e&&(e.parent=t.parent)}function r(t){if(void 0===t.leftCh)e(t,t.rightCh);else if(void 0===t.rightCh)e(t,t.leftCh);else{var i=n(t.rightCh);i.parent!==t&&(e(i,i.rightCh),i.rightCh=t.rightCh,i.rightCh.parent=i),e(t,i),i.leftCh=t.leftCh,i.leftCh.parent=i}}var s;return void 0!==(s=i(o,t))&&(r(s),a-=1,!0)},r.inorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(e(t.leftCh,i,n),n.stop||(n.stop=!1===i(t.element),n.stop||e(t.rightCh,i,n)))}e(o,t,{stop:!1})},r.preorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(n.stop=!1===i(t.element),n.stop||(e(t.leftCh,i,n),n.stop||e(t.rightCh,i,n)))}e(o,t,{stop:!1})},r.postorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(e(t.leftCh,i,n),n.stop||(e(t.rightCh,i,n),n.stop||(n.stop=!1===i(t.element))))}e(o,t,{stop:!1})},r.levelTraversal=function(e){function i(e,i){var n=t.Queue();for(void 0!==e&&n.enqueue(e);!n.isEmpty();){if(!1===i((e=n.dequeue()).element))return;void 0!==e.leftCh&&n.enqueue(e.leftCh),void 0!==e.rightCh&&n.enqueue(e.rightCh)}}i(o,e)},r.minimum=function(){if(!r.isEmpty())return n(o).element},r.maximum=function(){function t(t){for(;void 0!==t.rightCh;)t=t.rightCh;return t}if(!r.isEmpty())return t(o).element},r.forEach=function(t){r.inorderTraversal(t)},r.toArray=function(){var t=[];return r.inorderTraversal((function(e){t.push(e)})),t},r.height=function(){function t(e){return void 0===e?-1:Math.max(t(e.leftCh),t(e.rightCh))+1}function e(e){return void 0===e?-1:Math.max(t(e.leftCh),t(e.rightCh))+1}return e(o)},r.equals=function(e){var i;return!t.isUndefined(e)&&"function"==typeof e.levelTraversal&&r.size()===e.size()&&(i=!0,e.forEach((function(t){return i=r.contains(t)})),i)},r},t.Dictionary=function(e){var i={},n={},o=0,r=e||t.defaultToString,s="/$ ";return i.get=function(e){var i=n[s+r(e)];if(!t.isUndefined(i))return i.value},i.set=function(e,i){var a,l,h;if(!t.isUndefined(e)&&!t.isUndefined(i))return l=s+r(e),h=n[l],t.isUndefined(h)?(o+=1,a=void 0):a=h.value,n[l]={key:e,value:i},a},i.remove=function(e){var i=s+r(e),a=n[i];if(!t.isUndefined(a))return delete n[i],o-=1,a.value},i.keys=function(){var t,e=[];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(n[t].key);return e},i.values=function(){var t,e=[];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(n[t].value);return e},i.forEach=function(t){var e,i;for(e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&!1===t((i=n[e]).key,i.value))return},i.containsKey=function(e){return!t.isUndefined(i.get(e))},i.clear=function(){n={},o=0},i.size=function(){return o},i.isEmpty=function(){return o<=0},i.equals=function(e,n){var o,r;return!t.isUndefined(e)&&"function"==typeof e.keys&&i.size()===e.size()&&(o=n||t.defaultEquals,r=!0,e.forEach((function(t,e){return r=o(i.get(t),e)})),r)},i},t.Heap=function(e){function i(e){function i(t){return Math.floor((t-1)/2)}var n;for(n=i(e);e>0&&s(r[n],r[e])>0;)t.arrays.swap(r,n,e),n=i(e=n)}function n(e){function i(t){return 2*t+1}function n(t){return 2*t+2}function o(t,e){return e>=r.length?t>=r.length?-1:t:s(r[t],r[e])<=0?t:e}var a;for(a=o(i(e),n(e));a>=0&&s(r[e],r[a])>0;)t.arrays.swap(r,a,e),a=o(i(e=a),n(e))}var o={},r=[],s=e||t.defaultCompare;return o.peek=function(){if(r.length>0)return r[0]},o.add=function(e){if(!t.isUndefined(e))return r.push(e),i(r.length-1),!0},o.removeRoot=function(){var t;if(r.length>0)return t=r[0],r[0]=r[r.length-1],r.splice(r.length-1,1),r.length>0&&n(0),t},o.contains=function(e){var i=t.compareToEquals(s);return t.arrays.contains(r,e,i)},o.size=function(){return r.length},o.isEmpty=function(){return r.length<=0},o.clear=function(){r.length=0},o.forEach=function(e){t.arrays.forEach(r,e)},o.toArray=function(){return t.arrays.copy(r)},o.equals=function(e){var i,n,r;return!t.isUndefined(e)&&"function"==typeof e.removeRoot&&o.size()===e.size()&&(i=o.toArray(),n=e.toArray(),r=t.compareToEquals(s),i.sort(s),n.sort(s),t.arrays.equals(i,n,r))},o},t.LinkedList=function(){function e(t){var e,o;if(!(t<0||t>=r)){if(t===r-1)return n;for(e=i,o=0;o<t;o+=1)e=e.next;return e}}var i,n,o={},r=0;return o.add=function(o,s){var a,l;return t.isUndefined(s)&&(s=r),!(s<0||s>r||t.isUndefined(o)||(a={element:o,next:void 0},0===r?(i=a,n=a):s===r?(n.next=a,n=a):0===s?(a.next=i,i=a):(l=e(s-1),a.next=l.next,l.next=a),r+=1,0))},o.first=function(){if(void 0!==i)return i.element},o.last=function(){if(void 0!==n)return n.element},o.elementAtIndex=function(t){var i=e(t);if(void 0!==i)return i.element},o.indexOf=function(e,n){var o=n||t.defaultEquals,r=i,s=0;if(t.isUndefined(e))return-1;for(;void 0!==r;){if(o(r.element,e))return s;s+=1,r=r.next}return-1},o.contains=function(t,e){return o.indexOf(t,e)>=0},o.remove=function(e,o){var s,a=o||t.defaultEquals,l=i;if(r<1||t.isUndefined(e))return!1;for(;void 0!==l;){if(a(l.element,e))return l===i?(i=i.next,l===n&&(n=void 0)):l===n?(n=s,s.next=l.next,l.next=void 0):(s.next=l.next,l.next=void 0),r-=1,!0;s=l,l=l.next}return!1},o.clear=function(){i=void 0,n=void 0,r=0},o.equals=function(e,n){var r=n||t.defaultEquals,s=!0,a=i;return!t.isUndefined(e)&&"function"==typeof e.elementAtIndex&&o.size()===e.size()&&(e.forEach((function(t){return s=r(t,a.element),a=a.next,s})),s)},o.removeElementAtIndex=function(t){var o,s;if(!(t<0||t>=r))return 1===r?(o=i.element,i=void 0,n=void 0):(void 0===(s=e(t-1))?(o=i.element,i=i.next):s.next===n&&(o=n.element,n=s),void 0!==s&&(o=s.next.element,s.next=s.next.next)),r-=1,o},o.forEach=function(t){for(var e=i;void 0!==e&&!1!==t(e.element);)e=e.next},o.reverse=function(){for(var t,e,o=i;void 0!==o;)e=o.next,o.next=t,t=o,o=e;e=i,i=n,n=e},o.toArray=function(){var t=[];return o.forEach((function(e){t.push(e)})),t},o.size=function(){return r},o.isEmpty=function(){return r<=0},o},t.MultiDictionary=function(e,i){var n={},o=new t.Dictionary(e),r=i||t.defaultEquals;return n.get=function(e){var i=o.get(e);return t.isUndefined(i)?[]:t.arrays.copy(i)},n.set=function(e,i){var s;return!(t.isUndefined(e)||t.isUndefined(i)||(n.containsKey(e)?(s=o.get(e),t.arrays.contains(s,i,r)||(s.push(i),0)):(o.set(e,[i]),0)))},n.remove=function(e,i){var n,s;return t.isUndefined(i)?(n=o.remove(e),!t.isUndefined(n)):(s=o.get(e),!!t.arrays.remove(s,i,r)&&(0===s.length&&o.remove(e),!0))},n.keys=function(){return o.keys()},n.values=function(){var t,e,i,n=o.values(),r=[];for(t=0;t<n.length;t+=1)for(i=n[t],e=0;e<i.length;e+=1)r.push(i[e]);return r},n.containsKey=function(t){return o.containsKey(t)},n.clear=function(){return o.clear()},n.size=function(){return o.size()},n.isEmpty=function(){return o.isEmpty()},n.forEach=function(t){return o.forEach(t)},n.equals=function(e){var i,o=!0;return!t.isUndefined(e)&&"function"==typeof e.values&&n.size()===e.size()&&(e.forEach((function(e,s){return(i=n.get(e)||[]).length!==s.length?o=!1:t.arrays.forEach(i,(function(e){return o=t.arrays.contains(s,e,r)})),o})),o)},n},t.PriorityQueue=function(e){var i={},n=t.reverseCompareFunction(e),o=new t.Heap(n);return i.enqueue=function(t){return o.add(t)},i.add=function(t){return o.add(t)},i.dequeue=function(){var t;if(0!==o.size())return t=o.peek(),o.removeRoot(),t},i.peek=function(){return o.peek()},i.contains=function(t){return o.contains(t)},i.isEmpty=function(){return o.isEmpty()},i.size=function(){return o.size()},i.clear=function(){o.clear()},i.forEach=function(t){o.forEach(t)},i.toArray=function(){return o.toArray()},i.equals=function(e){var o,r,s;return!t.isUndefined(e)&&"function"==typeof e.dequeue&&i.size()===e.size()&&(o=i.toArray(),r=e.toArray(),s=t.compareToEquals(n),o.sort(n),r.sort(n),t.arrays.equals(o,r,s))},i},t.Queue=function(){var e={},i=new t.LinkedList;return e.enqueue=function(t){return i.add(t)},e.add=function(t){return i.add(t)},e.dequeue=function(){var t;if(0!==i.size())return t=i.first(),i.removeElementAtIndex(0),t},e.peek=function(){if(0!==i.size())return i.first()},e.size=function(){return i.size()},e.contains=function(t,e){return i.contains(t,e)},e.isEmpty=function(){return i.size()<=0},e.clear=function(){i.clear()},e.forEach=function(t){i.forEach(t)},e.toArray=function(){return i.toArray()},e.equals=function(i,n){var o,r,s;return!t.isUndefined(i)&&"function"==typeof i.dequeue&&e.size()===i.size()&&(o=n||t.defaultEquals,r=!0,i.forEach((function(t){return s=e.dequeue(),e.enqueue(s),r=o(s,t)})),r)},e},t.Set=function(e){var i={},n=new t.Dictionary(e);return i.contains=function(t){return n.containsKey(t)},i.add=function(e){return!i.contains(e)&&!t.isUndefined(e)&&(n.set(e,e),!0)},i.intersection=function(t){i.forEach((function(e){t.contains(e)||i.remove(e)}))},i.union=function(t){t.forEach((function(t){i.add(t)}))},i.difference=function(t){t.forEach((function(t){i.remove(t)}))},i.isSubsetOf=function(t){var e=!0;return!(i.size()>t.size())&&(i.forEach((function(i){if(!t.contains(i))return e=!1,!1})),e)},i.remove=function(t){return!!i.contains(t)&&(n.remove(t),!0)},i.forEach=function(t){n.forEach((function(e,i){return t(i)}))},i.toArray=function(){return n.values()},i.isEmpty=function(){return n.isEmpty()},i.size=function(){return n.size()},i.clear=function(){n.clear()},i.equals=function(e){var n;return!t.isUndefined(e)&&"function"==typeof e.isSubsetOf&&i.size()===e.size()&&(n=!0,e.forEach((function(t){return n=i.contains(t)})),n)},i},t.Stack=function(){var e={},i=new t.LinkedList;return e.push=function(t){return i.add(t,0)},e.add=function(t){return i.add(t,0)},e.pop=function(){return i.removeElementAtIndex(0)},e.peek=function(){return i.first()},e.size=function(){return i.size()},e.contains=function(t,e){return i.contains(t,e)},e.isEmpty=function(){return i.isEmpty()},e.clear=function(){i.clear()},e.forEach=function(t){i.forEach(t)},e.toArray=function(){return i.toArray()},e.equals=function(n,o){var r,s,a;return!t.isUndefined(n)&&"function"==typeof n.peek&&e.size()===n.size()&&(r=o||t.defaultEquals,s=!0,n.forEach((function(t){return a=e.pop(),i.add(a),s=r(a,t)})),s)},e},t},void 0===(o="function"==typeof i?i.apply(e,n):i)||(t.exports=o)},84324:t=>{"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAOCAYAAADNGCeJAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAAVdJREFUOI2V0bFrU1EUB+DvRWNsIJNQu6t1E8ykuDgKBQlIFwdHkQ7+AwU7url0FMQ5cXFwsoMguIhSqoPtJA51EHGohedQfg55SV9jaeKFw71wDt89hyOJesx60u83srR0LlwKvdArJoGiKKZDq6vzBoOunZ1ruIgfGPwXlm73lIODW7a3l5XlIn7hNfrYNcuY2duTXm8uPAgfQj/cD4uhGQRTsezvy8pKJzwMX8KzcCGcHiGHGHPhSlgIRZrNVjY3h1BZytpap+roU3ga5v9Bxj8PkRdhN7wLd8LltNvtrK93wt3wMQzC+WORGiYU4XrYCl8r9F64HTbC+3CzqjseqmGjOBOehO/hW3hZ4Y9D60RovICjYCM8Cj8r9HO4OhUaY6M4BFvhTfgd3oaz49zE9uvRmJBHrz/YQInn1V3Pz9DZ0Q674VW17aldJTmhYDjajVmhJP4Cy1ZU6+dCg3AAAAAASUVORK5CYII="},75456:t=>{"use strict";t.exports=JSON.parse('{"name":"cirsim","version":"2.1.17","description":"Cirsim Circuit Simulator","main":"dist/cirsim.min.js","module":"index.js","scripts":{"build:dev":"webpack --config webpack.dev.js","build:prod":"webpack --config webpack.prod.js","build:all":"$npm_execpath run build:dev && $npm_execpath run build:prod","test":"karma start karma.conf.js","serve":"webpack serve --config webpack.dev.js --open","build:docs":"documentation build src/Cirsim/**/*.js --sort-order source -f html -o doc/js"},"keywords":["Education","Circuits","Computer Architecture"],"author":"Charles B. Owen","license":"MIT","devDependencies":{"@babel/core":"^7.18.13","@babel/plugin-transform-runtime":"^7.18.10","@babel/preset-env":"^7.18.10","@babel/runtime":"7.18.9","babel-loader":"^8.2.5","clean-webpack-plugin":"^4.0.0","copy-webpack-plugin":"^11.0.0","css-loader":"^6.7.1","css-minimizer-webpack-plugin":"^4.0.0","file-loader":"^6.2.0","html-webpack-plugin":"^5.5.0","html-webpack-tags-plugin":"^3.0.2","jasmine-core":"^4.3.0","karma":"^6.4.0","karma-chrome-launcher":"^3.1.1","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.0.0","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^5.0.0","resolve-url-loader":"^5.0.0","sass":"^1.54.5","sass-loader":"^13.0.2","style-loader":"^3.3.1","terser-webpack-plugin":"^5.3.5","webpack":"^5.74.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.10.0","webpack-merge":"^5.8.0"},"dependencies":{"buckets-js":"^1.98.2","dialog-cl":"^1.0.6","dompurify":"^2.3.10","icons-cl":"~1.1.3","promise-polyfill":"^8.2.3","resizer-cl":"^2.4.4"}}')}},i={};function n(t){var o=i[t];if(void 0!==o)return o.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,n.amdO={},t=[],n.O=(e,i,o,r)=>{if(!i){var s=1/0;for(c=0;c<t.length;c++){for(var[i,o,r]=t[c],a=!0,l=0;l<i.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((t=>n.O[t](i[l])))?i.splice(l--,1):(a=!1,r<s&&(s=r));if(a){t.splice(c--,1);var h=o();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[i,o,r]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.j=635,n.p="/cl/dist/",(()=>{n.b=document.baseURI||self.location.href;var t={635:0};n.O.j=e=>0===t[e];var e=(e,i)=>{var o,r,[s,a,l]=i,h=0;if(s.some((e=>0!==t[e]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var c=l(n)}for(e&&e(i);h<s.length;h++)r=s[h],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},i=self.webpackChunkcourselib=self.webpackChunkcourselib||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),n.nc=void 0;var o=n.O(void 0,[592,736],(()=>n(50400)));o=n.O(o)})();