/*! For license information please see cirsim.min.js.LICENSE.txt */
(self.webpackChunkcourselib=self.webpackChunkcourselib||[]).push([[635],{31511:function(){!function(t){"use strict";if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(t){}var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},i=function(){this.data=[]},n=function(t,e,i){this.data=t,this.size=t.length,this.type=e,this.encoding=i},o=i.prototype,s=n.prototype,r=t.FileReaderSync,a=function(t){this.code=this[this.name=t]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),h=l.length,c=t.URL||t.webkitURL||t,u=c.createObjectURL,d=c.revokeObjectURL,p=c,f=t.btoa,v=t.atob,m=t.ArrayBuffer,y=t.Uint8Array,g=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(n.fake=s.fake=!0;h--;)a.prototype[l[h]]=h+1;return c.createObjectURL||(p=t.URL=function(t){var e,i=document.createElementNS("http://www.w3.org/1999/xhtml","a");return i.href=t,"origin"in i||("data:"===i.protocol.toLowerCase()?i.origin=null:(e=t.match(g),i.origin=e&&e[1])),i}),p.createObjectURL=function(t){var e,i=t.type;return null===i&&(i="application/octet-stream"),t instanceof n?(e="data:"+i,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):f?e+";base64,"+f(t.data):e+","+encodeURIComponent(t.data)):u?u.call(c,t):void 0},p.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&d&&d.call(c,t)},o.append=function(t){var i=this.data;if(y&&(t instanceof m||t instanceof y)){for(var o="",s=new y(t),l=0,h=s.length;l<h;l++)o+=String.fromCharCode(s[l]);i.push(o)}else if("Blob"===e(t)||"File"===e(t)){if(!r)throw new a("NOT_READABLE_ERR");var c=new r;i.push(c.readAsBinaryString(t))}else t instanceof n?"base64"===t.encoding&&v?i.push(v(t.data)):"URI"===t.encoding?i.push(decodeURIComponent(t.data)):"raw"===t.encoding&&i.push(t.data):("string"!=typeof t&&(t+=""),i.push(unescape(encodeURIComponent(t))))},o.getBlob=function(t){return arguments.length||(t=null),new n(this.data.join(""),t,"raw")},o.toString=function(){return"[object BlobBuilder]"},s.slice=function(t,e,i){var o=arguments.length;return o<3&&(i=null),new n(this.data.slice(t,o>1?e:this.data.length),i,this.encoding)},s.toString=function(){return"[object Blob]"},s.close=function(){this.size=0,delete this.data},i}(t);t.Blob=function(t,i){var n=i&&i.type||"",o=new e;if(t)for(var s=0,r=t.length;s<r;s++)Uint8Array&&t[s]instanceof Uint8Array?o.append(t[s].buffer):o.append(t[s]);var a=o.getBlob(n);return!a.slice&&a.webkitSlice&&(a.slice=a.webkitSlice),a};var i=Object.getPrototypeOf||function(t){return t.__proto__};t.Blob.prototype=i(new t.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this)},96e3:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o}),t=i.hmd(t);var n=n||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,i=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,s=/constructor/i.test(t.HTMLElement),r=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},l=function(t){setTimeout((function(){"string"==typeof t?i().revokeObjectURL(t):t.remove()}),4e4)},h=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},c=function(e,c,u){u||(e=h(e));var d,p=this,f="application/octet-stream"===e.type,v=function(){!function(t,e,i){for(var n=(e=[].concat(e)).length;n--;){var o=t["on"+e[n]];if("function"==typeof o)try{o.call(t,i||t)}catch(t){a(t)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,o)return d=i().createObjectURL(e),void setTimeout((function(){var t,e;n.href=d,n.download=c,t=n,e=new MouseEvent("click"),t.dispatchEvent(e),v(),l(d),p.readyState=p.DONE}));!function(){if((r||f&&s)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=r?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,p.readyState=p.DONE,v()},n.readAsDataURL(e),void(p.readyState=p.INIT)}(d||(d=i().createObjectURL(e)),f)?t.location.href=d:t.open(d,"_blank")||(t.location.href=d);p.readyState=p.DONE,v(),l(d)}()},u=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=h(t)),navigator.msSaveOrOpenBlob(t,e)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,e,i){return new c(t,e||t.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);t.exports?t.exports.saveAs=n:"undefined"!=typeof define&&null!==define&&null!==i.amdO&&define([],(function(){return n}));const o=n},25698:()=>{"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])}return i},writable:!0,configurable:!0})},11105:()=>{String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t})},62170:(t,e,i)=>{i.p=function(){var t=/^(http.*\/.*\/)[^\/]+.js.*$/,e=document.currentScript.src.match(t);if(null!==e)return e[1];if(t=/^.*\/([^\/]+.js)$/,null!==(e=document.currentScript.src.match(t)))for(var i=e[1],n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var s=n[o].getAttribute("src"),r=s.indexOf(i);if(r>-1)return s.substring(0,r)}return""}()},54463:(t,e,i)=>{"use strict";var n=i(68572),o=i.n(n),s=i(84879),r=i.n(s),a=i(55438),l=i.n(a),h=i(59425),c=i.n(h),u=i(37930),d=i.n(u),p=i(76686),f=i.n(p),v=i(16251),m={};m.styleTagTransform=f(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=d();o()(v.Z,m);v.Z&&v.Z.locals&&v.Z.locals;i(62170),i(6621),i(11105),i(25698);var y=i(31217),g=function(){this.circuit=null,this.x=0,this.y=0,this.moveX=0,this.moveY=0,this.selectedStyle="#ff0000",this.unselectedStyle="#000000"};g.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.moveX=t.moveX,this.moveY=t.moveY},g.prototype.single=function(){return!1},g.prototype.selectStyle=function(t,e){return e.selection.isSelected(this)?(t.strokeStyle=this.selectedStyle,t.fillStyle=this.selectedStyle,!0):(t.strokeStyle=this.unselectedStyle,t.fillStyle=this.unselectedStyle,!1)},g.prototype.grab=function(){this.moveX=this.x,this.moveY=this.y},g.prototype.move=function(t,e){this.moveX+=t,this.moveY+=e,this.x=this.moveX,this.y=this.moveY,null!==this.circuit&&this.circuit.snapIt(this)},g.prototype.place=function(t,e){this.moveX=t,this.moveY=e,this.x=this.moveX,this.y=this.moveY,null!==this.circuit&&this.circuit.snapIt(this)},g.prototype.delete=function(){},g.prototype.drop=function(){},g.prototype.spawn=function(t,e){return null};var b=function(){};b.toHex=function(t,e){for(var i=Number(t).toString(16);i.length<e;)i="0"+i;return i},b.toBinary=function(t,e){for(var i=Number(t).toString(2);i.length<e;)i="0"+i;return i},b.inArray=function(t,e){for(var i=0;i<e.length;i++)if(e[i].toLowerCase()===t.toLowerCase())return!0;return!1};var w=function(t,e){this.x=t,this.y=e};w.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);this.x/=t,this.y/=t},w.normalize=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return new w(t.x/e,t.y/e)},w.rotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return new w(n*t.x-i*t.y,i*t.x+n*t.y)},w.distanceToLine=function(t,e,i,n){return 0==e?Math.abs((i*t.y+n)/i):0==i?Math.abs((e*t.x+n)/e):Math.abs(e*t.x+i*t.y+n)/Math.sqrt(e*e+i*i)},w.distanceToLineP2=function(t,e,i){return w.distanceToLine(t,e.y-i.y,i.x-e.x,e.x*i.y-i.x*e.y)},w.nearestOnLine=function(t,e,i,n){return 0==e?{x:t.x,y:-n/i}:0==i?{x:-n/e,y:t.y}:{x:(i*(i*t.x-e*t.y)-e*n)/(e*e+i*i),y:(e*(-i*t.x+e*t.y)-i*n)/(e*e+i*i)}},w.nearestOnLineP2=function(t,e,i){return w.nearestOnLine(t,e.y-i.y,i.x-e.x,e.x*i.y-i.x*e.y)},w.computeT=function(t,e,i){var n=i.x-e.x,o=i.y-e.y;return Math.abs(n)>Math.abs(o)?(t.x-e.x)/n:(t.y-e.y)/o},w.distance=function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},w.distanceToLineSegment=function(t,e,i){var n=w.nearestOnLineP2(t,e,i),o=w.computeT(n,e,i);if(o>=0&&o<=1)return{d:w.distance(t,n),p:n};var s=w.distance(t,e),r=w.distance(t,i);return s<r?{d:s,p:e}:{d:r,p:i}};var x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.left=t,this.top=e,this.right=i,this.bottom=n};x.prototype.setRightBottom=function(t,e){this.right=t,this.bottom=e},x.prototype.normalize=function(){if(this.left>this.right){var t=this.left;this.left=this.right,this.right=t}if(this.top>this.bottom){var e=this.top;this.top=this.bottom,this.bottom=e}},x.prototype.isEmpty=function(){return this.left>=this.right||this.top>=this.bottom},x.prototype.contains=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},x.prototype.expand=function(t){t.left<this.left&&(this.left=t.left),t.right>this.right&&(this.right=t.right),t.top<this.top&&(this.top=t.top),t.bottom>this.bottom&&(this.bottom=t.bottom)},x.prototype.expandXY=function(t,e){t<this.left&&(this.left=t),t>this.right&&(this.right=t),e<this.top&&(this.top=e),e>this.bottom&&(this.bottom=e)};var T=function(t,e,i,n,o,s){this.component=t,this.x=e,this.y=i,this.len=void 0!==n?n:16,this.index=void 0,this.name=o,this.inv=s,this.value=void 0,this.touchRange=8,this.bus=!1,this.reference=null,this.clock=!1};function I(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}T.prototype.orientation="w",T.prototype.single=function(){return!0},T.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.len=t.len,this.index=t.index,this.name=t.name,this.inv=t.inv,this.value=t.value,this.touchRange=t.touchRange,this.bus=t.bus,this.reference=t.reference},T.prototype.get=function(){return this.value},T.prototype.getAsString=function(){return function t(e){if(Array.isArray(e)){var i="";return e.forEach((function(e){i=t(e)+i})),i}return void 0===e?"?":e?"1":"0"}(this.value)},T.parseBusValue=function(t){for(var e=[],i=t.length-1;i>=0;i--){switch(t.substr(i,1)){case"0":e.push(!1);break;case"1":e.push(!0);break;case"?":e.push(void 0);break;default:return null}}return e},T.busValueToDecimal=function(t,e){if(void 0===t)return null;var i=0,n=1;for(var o in t){if(void 0===t[o])return null;t[o]&&(i+=n),n*=2}return void 0!==e&&(i%=e),i},T.prototype.touch=function(t,e){var i=this.getLoc(),n=this.touchRange;return t>=i.x-n&&t<=i.x+n&&e>=i.y-n&&e<=i.y+n},T.prototype.getLoc=function(){switch(this.orientation){case"w":return new w(this.component.x+this.x-this.len,this.component.y+this.y);case"n":return new w(this.component.x+this.x,this.component.y+this.y-this.len);case"s":return new w(this.component.x+this.x,this.component.y+this.y+this.len);case"e":return new w(this.component.x+this.x+this.len,this.component.y+this.y)}},T.prototype.draw=function(t,e){var i=this.component.x+this.x,n=this.component.y+this.y;switch(this.bus?t.lineWidth=2:t.lineWidth=1,this.orientation){case"e":if(t.beginPath(),t.moveTo(i,n+.5),t.lineTo(i+this.len,n+.5),t.fillRect(i+this.len-1,n-1,3,3),this.component.circuit.circuits.model.main.options.showOutputStates){t.font="11px Times",t.textAlign="left";var o=this.getAsString();o.length>8&&(o=parseInt(o,2),o=isNaN(o)?"?":b.toHex(o,4)),t.fillText(o,i+5,n-2)}void 0!==this.name&&(t.font="12px Times",t.textAlign="right",t.fillText(this.name,i-3,n+3)),t.stroke();break;case"w":if(t.beginPath(),t.moveTo(i,n+.5),t.lineTo(i-this.len,n+.5),t.fillRect(i-this.len-1,n-1,3,3),this.clock){var s=7;t.moveTo(i,n-s),t.lineTo(i+s,n),t.lineTo(i,n+s)}void 0!==this.name&&(t.font="12px Times",t.textAlign="left",t.fillText(this.name,i+2,n+3)),t.stroke();break;case"n":if(t.beginPath(),t.moveTo(i+.5,n),t.lineTo(i+.5,n-this.len),t.fillRect(i-1,n-this.len-1,3,3),this.clock){s=7;t.moveTo(i-s,n),t.lineTo(i,n+s),t.lineTo(i+s,n)}t.stroke(),void 0!==this.name&&(n+=this.clock?12+s:12,t.font="12px Times",t.textAlign="center",t.fillText(this.name,i,n));break;case"s":if(t.beginPath(),t.moveTo(i+.5,n),t.lineTo(i+.5,n+this.len),t.fillRect(i-1,n+this.len-1,3,3),this.clock){s=7;t.moveTo(i-s,n),t.lineTo(i,n-s),t.lineTo(i+s,n)}t.stroke(),void 0!==this.name&&(n-=this.clock?6+s:6,t.font="12px Times",t.textAlign="center",t.fillText(this.name,i,n))}t.lineWidth=1},T.prototype.autoLen=function(){if("s"===this.orientation)for(this.len=8*Math.floor(this.y/8)+8-this.y;this.len<12;)this.len+=8},T.prototype.bounds=function(){var t=this.component.x+this.x,e=this.component.y+this.y,i=new x(t,e,t,e);switch(this.orientation){case"e":i.expandXY(t+this.len,e);break;case"w":i.expandXY(t-this.len,e);break;case"n":i.expandXY(t,e-this.len);break;case"s":i.expandXY(t,e+this.len)}return i};var k=function(t,e,i,n,o,s){T.call(this,t,e,i,n,o,s),this.to=[],this.orientation="e"};(k.prototype=Object.create(T.prototype)).constructor=k,k.prototype.clone=function(){var t=new k(this.component,this.x,this.y,this.len,this.name,this.inv);return t.orientation=this.orientation,t.copyFrom(this),t},k.prototype.set=function(t){var e=!0;if(Array.isArray(t)){if(Array.isArray(this.value)&&t.length===this.value.length)for(var i in e=!1,t)if(t[i]!==this.value[i]){e=!0;break}}else e=this.value!==t;if(e){this.value=t;for(var n=0;n<this.to.length;n++){var o=this.to[n].to;null!==o&&o.set()}}},k.prototype.setAsString=function(t){if(this.bus)this.set(T.parseBusValue(t));else switch(t){default:this.set(!1);break;case"1":this.set(!0);break;case"?":this.set(void 0)}},k.prototype.get=function(){return this.value},k.prototype.draw=function(t,e){T.prototype.draw.call(this,t,e),this.bus?t.lineWidth=2:t.lineWidth=1;for(var i=0;i<this.to.length;i++)this.to[i].draw(t,e);t.lineWidth=1},k.prototype.add=function(t){this.to.push(t)},k.prototype.remove=function(t){var e=[];this.to.forEach((function(i){i!==t&&e.push(i)})),this.to=e},k.prototype.clear=function(){this.to.forEach((function(t){t.delete(this)})),this.to=[]},k.prototype.touchConnections=function(t,e){for(var i=0;i<this.to.length;i++){var n=this.to[i].touch(t,e);if(null!=n)return n}return null},k.prototype.selectRect=function(t,e){for(var i=0;i<this.to.length;i++)this.to[i].selectRect(t,e)},k.prototype.bounds=function(){var t,e=T.prototype.bounds.call(this),i=I(this.to);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.expand(n.bounds())}}catch(t){i.e(t)}finally{i.f()}return e};var A=function(t,e,i,n,o,s){T.call(this,t,e,i,n,o,s),this.from=[],this.orientation="w"};(A.prototype=Object.create(T.prototype)).constructor=A,A.prototype.clone=function(){var t=new A(this.component,this.x,this.y,this.len,this.name,this.inv);return t.orientation=this.orientation,t.copyFrom(this),t},A.prototype.set=function(){var t=this.from.length>0&&null!==this.from[0].from?this.from[0].from.value:void 0;this.value!==t&&(this.value=t,this.component.pending())},A.prototype.testAsString=function(t){this.component.testAsString(t,this)},A.prototype.setConnection=function(t){this.from.forEach((function(t){t.delete(this)})),t.to=this,this.from=[t],this.set()},A.prototype.clear=function(){this.from.forEach((function(t){t.delete(this)})),this.from=[]},A.prototype.add=function(t){this.from.push(t)},A.prototype.remove=function(t){var e=[];this.from.forEach((function(i){i!==t&&e.push(i)})),this.from=e},A.prototype.draw=function(t,e){T.prototype.draw.call(this,t,e);for(var i=0;i<this.from.length;i++)null===this.from[i].from&&this.from[i].draw(t,e)},A.prototype.bounds=function(){return T.prototype.bounds.call(this)};var O=function(t,e,i,n,o,s){k.call(this,t,e,i,n,o,s)};(O.prototype=Object.create(k.prototype)).constructor=O,O.prototype.draw=function(t,e){var i=this.component.x+this.x,n=this.component.y+this.y;t.beginPath(),t.arc(i+4+.5,n,4,0,2*Math.PI),t.moveTo(i+8,n+.5),t.lineTo(i+this.len,n+.5),t.fillRect(i+this.len-1,n-1,3,3),this.component.circuit.circuits.model.main.options.showOutputStates&&(t.font="11px Times",t.fillText(void 0===this.value?"?":this.value?"1":"0",i+7+8,n-2)),t.stroke(),void 0!==this.name&&(t.font="12px Times",t.textAlign="right",t.fillText(this.name,i-3,n+3),this.inv&&(n-=8,t.beginPath(),t.moveTo(i-3,n),t.lineTo(i-13,n),t.stroke()));for(var o=0;o<this.to.length;o++)this.to[o].draw(t,e)},O.prototype.set=function(t){void 0===t?k.prototype.set.call(this,t):k.prototype.set.call(this,!t)};var C=function(t,e){g.call(this),this.connection=null,void 0!==t&&(this.x=t,this.moveX=t),void 0!==e&&(this.y=e,this.moveY=e)};function E(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return z(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return z(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(C.prototype=Object.create(g.prototype)).constructor=C,C.prototype.touchRange=12,C.prototype.size=4,C.prototype.clone=function(){var t=new C;return t.copyFrom(this),t},C.prototype.draw=function(t,e){e.selection.isSelected(this)&&(this.selectStyle(t,e),t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill())},C.prototype.touch=function(t,e){return Math.abs(t-this.x)+Math.abs(e-this.y)<=this.touchRange},C.prototype.delete=function(t){this.connection.removeBend(this)},C.prototype.save=function(){return{x:this.x,y:this.y}};var B=function(t,e,i){if(g.call(this),this.touchRange=8,this.bends=[],null!==t){if(this.circuit=t.component.circuit,this.from=t,this.from.add(this),null===e){var n=t.getLoc();this.x=n.x,this.y=n.y}}else this.from=null;if(void 0===e&&console.log(this),null!==e){if(this.circuit=e.component.circuit,this.to=e,this.to.add(this),null===t){n=e.getLoc();this.x=n.x,this.y=n.y}!0!==i&&e.set()}else this.to=null};(B.prototype=Object.create(g.prototype)).constructor=B,B.prototype.clone=function(){if(null===this.from||null===this.to)return null;var t=this.from.component.prev,e=this.to.component.prev,i=this.from.index,n=this.to.index;void 0===e.ins[n]&&console.log(this);for(var o=new B(t.outs[i],e.ins[n],!0),s=0;s<this.bends.length;s++){var r=this.bends[s].clone();o.addBend(r)}return o},B.prototype.delete=function(t){var e=this.to;null!==this.to&&this.to!==t&&this.to.remove(this),null!==this.from&&this.from!==t&&this.from.remove(this),null!==e&&e.set()},B.prototype.removeBend=function(t){var e=[];this.bends.forEach((function(i){i!==t&&e.push(i)})),this.bends=e},B.prototype.getCircuit=function(){return null!==this.from?this.from.component.circuit:null!==this.to?this.to.component.circuit:null},B.prototype.drop=function(){if(null!==this.from&&null===this.to){var t=this.from.component.circuit.touchIn(this.x,this.y);null!==t&&this.from.bus===t.bus?t.setConnection(this):this.from.remove(this)}else if(null===this.from&&null!==this.to){var e=this.to.component.circuit.touchOut(this.x,this.y);null!==e&&this.to.bus===e.bus?(this.to.clear(),this.to.from=[this],this.from=e,e.add(this),this.to.set()):this.to.remove(this)}},B.prototype.draw=function(t,e){if(this.selectStyle(t,e),t.beginPath(),null!==this.from){var i=this.from.getLoc();t.moveTo(i.x+.5,i.y+.5)}else t.moveTo(this.x+.5,this.y+.5);for(var n=0;n<this.bends.length;n++){var o=this.bends[n];t.lineTo(o.x+.5,o.y+.5)}if(null!==this.to){i=this.to.getLoc();t.lineTo(i.x+.5,i.y+.5)}else t.lineTo(this.x+.5,this.y+.5);t.stroke();for(n=0;n<this.bends.length;n++)this.bends[n].draw(t,e)},B.prototype.bounds=function(){var t=null;if(null!==this.from){var e=this.from.getLoc();t=new x(e.x,e.y,e.x,e.y)}else t=new x(this.x,this.y,this.x,this.y);var i,n=E(this.bends);try{for(n.s();!(i=n.n()).done;){var o=i.value;t.expandXY(o.x,o.y)}}catch(t){n.e(t)}finally{n.f()}if(null!==this.to){var s=this.to.getLoc();t.expandXY(s.x,s.y)}else t.expandXY(this.x,this.y);return t},B.prototype.touch=function(t,e){for(var i=null!==this.from?this.from:new w(t,e),n=null!==this.to?this.to:new w(t,e),o=0;o<this.bends.length;o++){var s=this.bends[o];if(s.touch(t,e))return s}var r=i.getLoc();for(o=0;o<this.bends.length;o++){var a=this.bends[o];if(w.distanceToLineSegment({x:t,y:e},r,a).d<=this.touchRange)return this;r=a}return w.distanceToLineSegment({x:t,y:e},r,n.getLoc()).d<=this.touchRange?this:null},B.prototype.selectRect=function(t,e){for(var i=0;i<this.bends.length;i++){var n=this.bends[i];t.contains(n.x,n.y)&&e.push(n)}},B.prototype.spawn=function(t,e){if(null!==this.to&&null!==this.from){for(var i=0,n=1e10,o=this.from.getLoc(),s=0;s<this.bends.length;s++){var r=this.bends[s];(a=w.distanceToLineSegment({x:t,y:e},o,r)).d<=n&&(i=s,n=a.d),o=r}var a;(a=w.distanceToLineSegment({x:t,y:e},o,this.to.getLoc())).d<=n&&(i=s,n=a.d);var l=new C;return i<this.bends.length?this.insertBend(i,l):this.addBend(l),l.place(t,e),l}return null},B.prototype.insertBend=function(t,e){e.connection=this,e.circuit=this.circuit,this.bends.splice(t,0,e)},B.prototype.addBend=function(t){t.connection=this,t.circuit=this.circuit,this.bends.push(t)},B.prototype.save=function(){if(null===this.from||null===this.to)return null;for(var t=this.from.component,e=this.to.component,i=this.from.index,n=this.to.index,o=[],s=0;s<this.bends.length;s++){var r=this.bends[s];o.push(r.save())}return{from:t.id,out:i,to:e.id,in:n,bends:o}},B.prototype.load=function(t){var e=this;t.bends.forEach((function(t){var i=new C(t.x,t.y);e.addBend(i)}))};var N=function(){};N.unique=1,N.uniqueId=function(){return N.unique++},N.uniqueName=function(){return"cirsim-id-"+N.unique++};const L=N;var P=i(56161);function R(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var D=function(){};D.isVisible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},D.addClass=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},D.addClasses=function(t,e){null!=e&&e.split(" ").forEach((function(e){D.addClass(t,e)}))},D.removeClass=function(t,e){var i=new RegExp("\\b"+e+"\\b","g");t.className=t.className.replace(i,"")},D.createClassedDiv=function(t,e){var i=document.createElement("div");return D.addClass(i,t),void 0!==e&&D.addContent(i,e),i},D.addContent=function(t,e){D.isString(e)?t.innerHTML+=e:D.isElement(e)&&t.appendChild(e)},D.isString=function(t){return"string"==typeof t||!!t&&"object"===(0,P.Z)(t)&&"[object String]"===Object.prototype.toString.call(t)},D.isElement=function(t){return null!=t&&void 0!==t.nodeValue},D.offset=function(t){var e=t.getBoundingClientRect();return{left:e.left+t.scrollLeft+window.pageXOffset,top:e.top+t.scrollTop+window.pageYOffset}},D.child=function(t,e){var i,n=R(t.childNodes);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(o.tagName===e)return o}}catch(t){n.e(t)}finally{n.f()}return null};var U=i(78099),M=i.n(U),q=i(34659),F=function(t){this.classes=void 0!==t?"cirsim "+t:"cirsim",this.buttonOk="Ok",this.buttonCancel="Cancel",this.resize="none;",this.titleBarButtons=null};F.prototype.contents=function(t,e){this.html=t,this.title=e},F.prototype.open=function(){var t=this,e=document.createElement("form"),i=D.createClassedDiv("cirsim-dlg-content");e.appendChild(i);var n="".concat(this.html,'<p class="error"></p>\n<input type="submit" tabindex="-1" style="position:absolute; top:-1000px">');i.innerHTML=n,this.element=i;var o=[];null!==this.buttonOk&&o.push({contents:"Ok",click:function(e){t.ok()},focus:!0,class:"cs-ok"}),null!==this.buttonCancel&&o.push({contents:"Cancel",click:function(t){t.close()},class:"cs-cancel"});var s=new q.Z({addClass:this.classes,title:this.title,content:e,buttons:o,resize:this.resize,titleBarButtons:this.titleBarButtons});this.dialog=s,this.onOpen(),this.close=function(){s.close()},e.addEventListener("submit",(function(e){e.preventDefault(),t.ok()})),this.buttonOk=function(){return this.dialog.div.querySelector("button.cs-ok")}},F.prototype.ok=function(){this.close()},F.prototype.error=function(t){void 0!==t&&(this.element.querySelector(".error").innerHTML=t)},F.prototype.cancel=function(){},F.prototype.onOpen=function(){},F.prototype.sanitize=function(t){return M().sanitize(t)},F.prototype.uniqueId=function(){return N.uniqueName()};var H=function(t,e){var i=this;F.call(this,"component"),this.resize="both";var n=null,o="",s=function(){},r=function(){return null},a=function(){return null};this.open=function(){var r="";"help"in t.constructor&&(r+='<a class="helper">help</a>'),"description"in t.constructor&&(r+='<div class="description">',r+=t.constructor.description+"</div>");var a="";if(null!==t.naming)a=t.naming;else if(null!==t.prefix)for(var l=1;;l++){if(a=t.prefix+l,null===t.circuit.getComponentByNaming(a))break}var h="";null!==t.prefix&&(h+='<div class="control1 center gap"><label for="'+(n=N.uniqueName())+'">Name: </label><input type="text" name="'+n+'" id="'+n+'" value="'+a+'" spellcheck="false" class="compname text ui-widget-content ui-corner-all"></div>'),h+=o+r,i.contents(h,"Cirsim Component Properties"),F.prototype.open.call(i),s(),null!==n&&document.getElementById(n).select();var c=i.element.querySelector("a.helper");null!==c&&c.addEventListener("click",(function(i){i.preventDefault();var n=t.constructor.help;e.menu.helpMenu.componentHelp(n)}))},this.ok=function(){var o="";if(null!==t.prefix){var s=document.getElementById(n);if(0!==(o=s.value.replace(/^\s+|\s+$/gm,"")).length){var l=t.circuit.getComponentByNaming(o);if(null!==l&&l!==t)return D.addClass(s,"cirsim-error"),void i.error("Name already exists")}D.removeClass(s,"cirsim-error"),o=i.sanitize(o)}var h=r();null===h?(e.backup(),null!==t.prefix&&(t.naming=o.length>0?o:null),a(),i.close(),e.currentView().draw()):i.error(h)},this.extra=function(t,e,i){o=t,r=e,a=i},this.extraCreate=function(t){s=t}};function X(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return W(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return W(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(H.prototype=Object.create(F.prototype)).constructor=H;var Y=function(){g.call(this);var t=null;Object.defineProperty(this,"circuit",{get:function(){return t},set:function(e){t=e}}),this.height=10,this.width=10,this.prev=null,this.id="",this.circuit=null,this.naming=null,this.ins=[],this.outs=[]};(Y.prototype=Object.create(g.prototype)).constructor=Y,Y.prototype.prefix="U",Y.prototype.nameRequired=!1,Y.prototype.delay=11,Y.prototype.brand=function(){this.id="c"+ ++Y.maxId},Y.maxId=1e3,Y.prototype.copyFrom=function(t){this.height=t.height,this.width=t.width,this.prev=t.prev,this.naming=t.naming,this.id=t.id,t.prev=this,g.prototype.copyFrom.call(this,t);for(var e=0;e<this.ins.length;e++)this.ins[e].copyFrom(t.ins[e]);for(var i=0;i<this.outs.length;i++)this.outs[i].copyFrom(t.outs[i])},Y.prototype.drop=function(){this.x<this.width/2&&(this.x=this.width/2),this.y<this.height/2&&(this.y=this.height/2)},Y.prototype.grab=function(){g.prototype.grab.call(this),this.circuit.moveToFront(this)},Y.prototype.mouseUp=function(){},Y.prototype.added=function(t){if(this.circuit=t,null===this.naming&&this.nameRequired)for(var e=1;;e++){var i=void 0;if(i="*"===this.prefix.charAt(0)?e<=26?"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e-1):this.prefix.charAt(1)+(e-26):this.prefix+e,null===this.circuit.getComponentByNaming(i)){this.naming=i;break}}},Y.prototype.addIn=function(t,e,i,n){var o=new A(this,t,e,i,n);return o.index=this.ins.length,this.ins.push(o),o},Y.prototype.addOut=function(t,e,i,n,o){var s=new k(this,t,e,i,n,o);return s.index=this.outs.length,this.outs.push(s),s},Y.prototype.addOutInv=function(t,e,i,n,o){var s=new O(this,t,e,i,n,o);return s.index=this.outs.length,this.outs.push(s),s},Y.prototype.touch=function(t,e){var i=this.touchOut(t,e);if(null!==i)return new B(i,null);if(null!==(i=this.touchIn(t,e)))return new B(null,i);if(t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y-this.height/2&&e<=this.y+this.height/2)return this;for(var n=0;n<this.outs.length;n++){var o=this.outs[n].touchConnections(t,e);if(null!==o)return o}return null},Y.prototype.touchOut=function(t,e){for(var i=0;i<this.outs.length;i++)if(this.outs[i].touch(t,e))return this.outs[i];return null},Y.prototype.touchIn=function(t,e){for(var i=0;i<this.ins.length;i++)if(this.ins[i].touch(t,e))return this.ins[i];return null},Y.prototype.inRect=function(t,e){t.contains(this.x,this.y)&&e.push(this),this.outs.forEach((function(i){i.selectRect(t,e)}))},Y.prototype.delete=function(){for(var t=0;t<this.ins.length;t++)this.ins[t].clear();for(t=0;t<this.outs.length;t++)this.outs[t].clear();this.circuit.delete(this)},Y.prototype.bounds=function(){var t,e=new x(this.x-this.width/2,this.y-this.height/2,this.x+this.width/2,this.y+this.height/2),i=X(this.ins);try{for(i.s();!(t=i.n()).done;){var n=t.value;e.expand(n.bounds())}}catch(t){i.e(t)}finally{i.f()}var o,s=X(this.outs);try{for(s.s();!(o=s.n()).done;){var r=o.value;e.expand(r.bounds())}}catch(t){s.e(t)}finally{s.f()}return e},Y.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,3),this.drawIO(t,e)},Y.prototype.drawIO=function(t,e){for(var i=0;i<this.ins.length;i++)this.selectStyle(t,e),this.ins[i].draw(t,e);for(i=0;i<this.outs.length;i++)this.selectStyle(t,e),this.outs[i].draw(t,e)},Y.prototype.save=function(){var t=this.constructor.type,e=this.naming;return null!==e&&(e=e.replace(/'/g,"`")),{id:this.id,x:this.x,y:this.y,name:e,type:t}},Y.prototype.load=function(t){this.id=this.sanitize(t.id);var e=+this.id.substr(1);e>Y.maxId&&(Y.maxId=e),this.x=+t.x,this.y=+t.y,this.moveX=this.x,this.moveY=this.y;var i=t.name;this.naming=null!==i?this.sanitize(i).replace(/`/g,"'"):null},Y.prototype.saveConnections=function(){for(var t=[],e=0;e<this.outs.length;e++)for(var i=this.outs[e],n=0;n<i.to.length;n++){var o=i.to[n].save();null!==o&&t.push(o)}return t},Y.prototype.properties=function(t){new H(this,t).open()},Y.prototype.advance=function(t){return!1},Y.prototype.pending=function(){for(var t=.1*this.delay,e=[],i=0;i<this.ins.length;i++)e.push(this.ins[i].value);null!==this.circuit.circuits&&this.circuit.circuits.simulation.queue(this,t,e)},Y.prototype.getSimulation=function(){return null!==this.circuit?this.circuit.circuits.simulation:null},Y.prototype.getDelay=function(){return this.delay},Y.prototype.compute=function(t){},Y.prototype.newTab=function(){},Y.prototype.drawName=function(t,e,i,n){null!==this.naming&&(t.beginPath(),t.font=void 0!==n?n:"14px Times",t.textAlign="center",t.fillText(this.naming,this.x+e,this.y+i),t.stroke())},Y.prototype.drawText=function(t,e,i,n,o){t.beginPath(),t.font=void 0!==o?o:"14px Times",t.textAlign="center",t.fillText(e,this.x+i,this.y+n),t.stroke()},Y.prototype.drawBox=function(t,e){if("none"!==e){var i=t.fillStyle;t.fillStyle=void 0!==e?e:"#ffffff",t.fillRect(this.x-this.width/2-.5,this.y-this.height/2-.5,this.width,this.height),t.fillStyle=i}t.beginPath(),t.rect(this.x-this.width/2-.5,this.y-this.height/2-.5,this.width,this.height),t.stroke()},Y.prototype.drawTrap=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=20);var n=this.x-this.width/2-.5,o=this.x+this.width/2+.5,s=this.y-this.height/2-.5,r=this.y+this.height/2+.5;t.fillStyle="#ffffff",t.beginPath(),t.moveTo(n,s+e),t.lineTo(n,r-e),t.lineTo(o,r-i),t.lineTo(o,s+i),t.lineTo(n,s+e),t.fill(),t.beginPath(),t.moveTo(n,s+e),t.lineTo(n,r-e),t.lineTo(o,r-i),t.lineTo(o,s+i),t.lineTo(n,s+e),t.stroke()},Y.prototype.command=function(t){if(!("string"==typeof t||t instanceof String)||"type:"!==t.substr(0,5))return null;var e=t.substr(5);if(e!==this.constructor.type){var i=this.circuit.circuits.model.main.components.get(e);return i=null!==i?i.label:e,{ok:!1,msg:"Component "+this.naming+" should be type <strong>"+i+"</strong> but is <strong>"+this.constructor.label+"</strong>"}}return{ok:!0}},Y.prototype.setAsString=function(t){},Y.prototype.testAsString=function(t,e){console.log(t)},Y.prototype.jaggedLine=function(t,e,i,n,o,s){var r=Math.round(e+(n-e)*s)+.5;i+=.5,o+=.5,t.moveTo(e,i),t.lineTo(r,i),t.lineTo(r,o),t.lineTo(n,o),t.stroke()},Y.prototype.sanitize=function(t){return M().sanitize(t)},Y.prototype.update=function(){};var V=function(t,e){var i=e.options;this.html=function(){var t="",e=i.getAPI("save"),o=i.getAPI("open");if(null!==o&&void 0===o.name&&(t+='<li><a class="file-open"><span class="icons-cl icons-cl-folder-open"></span>Open...</a></li>'),null!==e&&(t+='<li><a class="file-save"><span class="icons-cl icons-cl-disk"></span>Save</a></li>'),null!==e&&void 0===e.name&&(t+='<li><a class="file-saveas"><span class="icons-cl icons-cl-disk"></span>Save As...</a></li>'),i.loadMenu.length>0){t+=n(t);for(var s=0;s<i.loadMenu.length;s++){t+='<li><a class="cs-file-load-menu" data-index="'+s+'"><span class="icons-cl icons-cl-arrowthickstop-1-n"></span>'+i.loadMenu[s].name+"</a></li>"}}return"none"!==i.export&&(t+=n(t),"both"!==i.export&&"import"!==i.export||(t+='<li><a class="cs-file-import"><span class="icons-cl icons-cl-arrowthickstop-1-n"></span>Import</a></li>'),"both"!==i.export&&"export"!==i.export||(t+='<li><a class="cs-file-export"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Export</a></li>')),i.exportPNG&&(t+='<li><a class="cs-file-export-png"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Export PNG</a></li>'),i.imports.length>0&&(t+=n(t)+'<li><a class="cs-file-import-tab"><span class="icons-cl icons-cl-arrowthickstop-1-s"></span>Import Tab</a></li>'),null!==i.exit&&(t.length>0&&(t+='<li class="menu-divider">&nbsp;</li>'),t+='<li><a class="file-exit">Exit</a></li>'),""!==t?'<li><a>File</a><ul class="file-menu">'+t+"</ul></li>":""};var n=function(t){return t.length>0?'<li class="menu-divider">&nbsp;</li>':""};this.activate=function(){t.click(".cs-file-import",(function(){e.import()})),t.click(".cs-file-export",(function(){e.export()})),t.click(".cs-file-load-menu",(function(t){var n=t.target.dataset.index;e.load(i.loadMenu[n].json)})),t.click(".cs-file-export-png",(function(t){e.currentView().exportPNG()})),t.click(".file-saveas",(function(){e.saveAs()})),t.click(".file-save",(function(){e.save()})),t.click(".file-open",(function(){e.open()})),t.click(".cs-file-import-tab",(function(){e.importTab()})),t.click(".file-exit",(function(){null!==i.exit&&(window.location.href=i.exit)}))},this.opening=function(){var i=!1,n=e.currentView().circuit;if(null!==n)for(var o=n.name,s=0;s<e.options.imports.length;s++){if(e.options.imports[s].into===o){i=!0;break}}t.enable(".cs-file-import-tab",i)}},Z=function(t,e){this.html=function(){return'<li><a>Edit</a><ul class="edit-menu"><li><a class="edit-undo"><span class="icons-cl icons-cl-arrowreturnthick-1-w"></span>Undo</a></li><li><a class="edit-delete"><span class="icons-cl icons-cl-trash"></span>Delete</a></li><li class="menu-divider">&nbsp;</li><li><a class="edit-properties">Properties</a></li></ul></li>'},this.activate=function(){t.click(".edit-delete",(function(t){console.log("delete"),e.backup(),e.currentView().delete()})),t.click(".edit-undo",(function(t){e.undo()})),t.click(".edit-properties",(function(t){1===e.currentView().selection.selection.length&&e.currentView().selection.selection[0]instanceof Y&&e.currentView().selection.selection[0].properties(e)})),document.addEventListener("keydown",(function(i){"Delete"===i.key?(t.closeAll(),e.backup(),e.currentView().delete()):"z"!==i.key||!i.ctrlKey||i.altKey||i.shiftKey||(t.closeAll(),e.undo())}))}},G=function(t){F.call(this);var e;this.open=function(){e=this.uniqueId();var t='<div class="control1 center"><label for="'.concat(e,'">New tab name: </label>\n<input class="tabname" type="text" id="').concat(e,'" spellcheck="false"></div>\n<p>Enter the name for the new tab.</p>');this.contents(t,"New Tab"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=document.getElementById(e).value;if(i=i.replace(/^\s+|\s+$/gm,""),(i=this.sanitize(i)).length<1)return this.error("Must provide a tab name"),void document.getElementById(e).select();if(i.length>8)return this.error("Name must be no longer than 8 characters"),void document.getElementById(e).select();var n=t.validateName(i);if(null!==n)return this.error(n),void document.getElementById(e).select();t.add(i),this.close()}};(G.prototype=Object.create(F.prototype)).constructor=G;var J=function(t,e,i){F.call(this),this.open=function(i,n){this.contents(e,t),!0!==n&&(this.buttonCancel=null),this.ok=function(){void 0!==i&&i(),this.close()},F.prototype.open.call(this)}};(J.prototype=Object.create(F.prototype)).constructor=J;var Q=function(t){F.call(this);var e;this.open=function(){var i=t.currentCircuit(),n=i.getName(),o=i.stats();e=this.uniqueId();var s='\n<div class="control1 center"><label for="'.concat(e,'">Tab name: </label>\n<input class="tabname" type="text" id="').concat(e,'" value="').concat(n,'" spellcheck="false" ').concat("main"===n?"disabled":"","></div>");s+="main"===n?'<p class="center"><em>The main tab cannot be renamed.</em></p>':"<p>This page presents information for the currently selected tab. Enter a new name to rename the tab.</p>",s+="<table>\n<tr><th>Property</th><th>Value</th></tr>\n<tr><td>Components</td><td>".concat(o.numComponents,"</td></tr>\n<tr><td>Connections</td><td>").concat(o.numConnections,"</td></tr>\n<tr><td>Width</td><td>").concat(o.width," pixels</td></tr>\n<tr><td>Height</td><td>").concat(o.height," pixels</td></tr>\n</table>"),this.contents(s,"New Tab"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=t.currentCircuit();if("main"!==i.getName()){var n=document.getElementById(e).value;if(n=n.replace(/^\s+|\s+$/gm,""),(n=this.sanitize(n)).length<1)return this.error("Must provide a tab name"),void document.getElementById(e).select();if(n.length>8)return this.error("Name must be no longer than 8 characters"),void document.getElementById(e).select();var o=t.validateName(n,i);if(null!==o)return this.error(o),void document.getElementById(e).select();n!==i.getName()&&t.rename(n),this.close()}else this.close()}};(Q.prototype=Object.create(F.prototype)).constructor=Q;var K=function(t,e){this.html=function(){return'<li><a>Tabs</a>\n<ul class="tabs-menu">\n<li><a class="tabs-properties"><span class="icons-cl icons-cl-wrench"></span>Properties...</a></li>\n<li><a class="tabs-add"><span class="icons-cl icons-cl-play"></span>Add...</a></li>\n<li><a class="tabs-delete"><span class="icons-cl icons-cl-close"></span>Delete...</a></li>\n<li><a class="tabs-left"><span class="icons-cl icons-cl-arrowthick-1-w"></span>Move Left</a></li>\n<li><a class="tabs-right"><span class="icons-cl icons-cl-arrowthick-1-e"></span>Move Right</a></li>\n</ul>\n</li>'};this.activate=function(){t.click(".tabs-add",(function(){new G(e.tabs).open()})),t.click(".tabs-delete",(function(){var t;null!==(t=e.tabs.currentCircuit())&&new J("Are you sure?",'<p class="large">Are you sure you want to delete the tab <em>'+t.getName()+"</em>?</p>",200).open((function(){e.tabs.delActive()}),!0)})),t.click(".tabs-properties",(function(){new Q(e.tabs).open()})),t.click(".tabs-left",(function(){var t=e.tabs;e.model.circuits.moveLeft(t.active)&&t.sync()})),t.click(".tabs-right",(function(){var t=e.tabs;e.model.circuits.moveRight(t.active)&&t.sync()}))},this.opening=function(){var i=e.tabs,n=e.model.circuits;t.enable(".tabs-delete",n.canDelete(i.active)),t.enable(".tabs-left",n.canMoveLeft(i.active)),t.enable(".tabs-right",n.canMoveRight(i.active))}},$=function(t,e){this.html=function(){return'<li><a>Options</a>\n<ul class="option-menu">\n<li><a class="option-showoutputstates">Show Output States<img></a></li>\n</ul></li>'},this.activate=function(){t.click(".option-showoutputstates",(function(t){e.options.showOutputStates=!e.options.showOutputStates,e.currentView().draw()}))},this.opening=function(){e.options.showOutputStates?D.addClass(t.find(".option-showoutputstates img"),"check"):D.removeClass(t.find(".option-showoutputstates img"),"check")}},_=function(t){F.call(this,"about"),this.open=function(){this.buttonCancel=null;var e=t.cirsim.root,i='<figure><img src="'.concat(e,'cirsim/img/logo-icon.png" alt="Cirsim Logo"></figure>\n<h1>Cirsim Circuit Simulator</h1>\n<p>Version: ').concat(t.cirsim.version,"</p>\n<p>Written by: Charles B. Owen</p>");t.cirsim.root.indexOf("cirsim-dev")>=0&&(i+='<p class="gap">Running from the development site.</p>'),this.contents(i,"About Cirsim"),F.prototype.open.call(this)}};(_.prototype=Object.create(F.prototype)).constructor=_;var tt=function(){};function et(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return it(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}tt.do=function(t){var e=new XMLHttpRequest;if("GET"===t.method){var i=[];for(var n in t.data)t.data.hasOwnProperty(n)&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(t.data[n]));e.open("GET",t.url+"?"+i.join("&"),!0)}else e.open(t.method,t.url,!0);if(e.onload=function(){if(e.status>=200&&e.status<400)if("json"===t.dataType)try{t.success(JSON.parse(e.responseText))}catch(t){console.log(t),console.log(e.responseText)}else t.success(e.responseText);else t.error(e.xhr,e.statusText,"invalid URL")},e.onerror=function(){t.error(e.xhr,e.statusText,"server not found")},"POST"===t.method)if("application/json"===t.contentType)e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(t.data));else{e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");var o=[];for(var s in t.data)t.data.hasOwnProperty(s)&&o.push(encodeURIComponent(s)+"="+encodeURIComponent(t.data[s]));e.send(o.join("&"))}else e.send()};var nt=function(t,e){var i=this,n=[];this.html=function(){return'<div class="cirsim-help">Fetching...</div>'},this.present=function(e){""===e&&(e="cirsim/help/index.html"),e=t.cirsim.root+e,this.presentAbsolute(e)},this.presentAbsolute=function(e){n.push(e),tt.do({url:e,data:{},method:"GET",success:function(t){o(t)},error:function(e,i,n){t.toast.message("Unable to communicate with server: "+n)}})};var o=function(n){if(n.indexOf("{{components}}")>0){t.cirsim.root;var o="<ul>";t.palette.palette.forEach((function(t){if(void 0!==t.help){var e=t.label;switch(e){case"0":e="Zero";break;case"1":e="One"}o+='<li><a href="'.concat(t.help,'.html">').concat(e,"</a> <em>").concat(t.desc,"</em></li>")}})),o+="</ul>",n=n.replace("{{components}}",o)}var s=t.cirsim.root;n=(n=n.replace(/src="img\//g,'src="'+s+"cirsim/help/img/")).replace(/href="/g,'href="'+s+"cirsim/help/");var r=e.element.querySelector(".cirsim-help");if(null!==r){r.innerHTML=n;var a,l=et(r.querySelectorAll("a"));try{for(l.s();!(a=l.n()).done;){a.value.addEventListener("click",(function(t){t.preventDefault(),i.presentAbsolute(t.target.href)}))}}catch(t){l.e(t)}finally{l.f()}}};this.home=function(){this.present("")},this.back=function(){if(!(n.length<2)){n.pop();var t=n[n.length-1];n.pop(),this.presentAbsolute(t)}}},ot=function(t){F.call(this,"help"),this.open=function(e){this.buttonCancel=null,this.resize="both";var i=new nt(t,this),n=i.html();this.contents(n,"Cirsim Help"),this.titleBarButtons=[{type:"custom",contents:'<span class="icons-cl icons-cl-arrowthick-1-w">',click:function(){i.back()}},{type:"custom",contents:'<span class="icons-cl icons-cl-home">',click:function(){i.home()}},{type:"close"}],F.prototype.open.call(this),i.present(e)}};(ot.prototype=Object.create(F.prototype)).constructor=ot;var st=function(t,e){this.html=function(){return'<li><a>Help</a><ul class="help-menu"><li><a class="help-help">Help</a></li><li><a class="help-docked-help">Docked Help<img></a></li><li><a class="help-about">About...</a></li></ul></li>'},this.componentHelp=function(t){(t="cirsim/help/"+t+".html",e.isHelpDocked())?e.help.url(t):new ot(e).open(t)},this.activate=function(){t.click(".help-about",(function(t){new _(e).open()})),t.click(".help-help",(function(t){e.isHelpDocked()?e.help.home():new ot(e).open("")})),t.click(".help-docked-help",(function(t){e.dockedHelp(!e.isHelpDocked())}))},this.opening=function(){e.isHelpDocked()?D.addClass(t.find(".help-docked-help img"),"check"):D.removeClass(t.find(".help-docked-help img"),"check")}};function rt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return at(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return at(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function at(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var lt=function(t){var e=this,i=new V(this,t),n=new Z(this,t),o=new K(this,t),s=new $(this,t),r=new st(this,t);this.helpMenu=r,this.nav=null,this.ul=null;var a=function(t){for(var i=t.target.parentNode;null!==i;i=i.parentNode)if(i===e.nav)return;e.closeAll()},l=function(t){var n,l=rt(e.ul.childNodes);try{for(l.s();!(n=l.n()).done;){var u=n.value;if("LI"===u.tagName){var d=D.child(u,"UL");null!==d&&D.removeClass(d,"menu-open")}}}catch(t){l.e(t)}finally{l.f()}h(".edit-delete"),c(".edit-properties"),i.opening(),o.opening(),s.opening(),r.opening();var p=D.child(t,"UL");null!==p&&D.addClass(p,"menu-open"),document.addEventListener("click",a),document.addEventListener("mousedown",a)};this.closeAll=function(){var t,i=rt(e.ul.childNodes);try{for(i.s();!(t=i.n()).done;){var n=t.value;if("LI"===n.tagName){var o=D.child(n,"UL");null!==o&&D.removeClass(o,"menu-open")}}}catch(t){i.e(t)}finally{i.f()}document.removeEventListener("click",a),document.removeEventListener("mousedown",a)},this.enable=function(t,i){var n=e.ul.querySelector(t);null!==n&&(i?D.removeClass(n.parentNode,"menu-disabled"):D.addClass(n.parentNode,"menu-disabled"))};var h=function(i){e.enable(i,t.currentView().selection.selection.length>0)},c=function(i){1===t.currentView().selection.selection.length&&t.currentView().selection.selection[0]instanceof Y?e.enable(i,!0):e.enable(i,!1)};this.find=function(t){return e.ul.querySelector(t)},this.click=function(t,i){var n=e.find(t);null!==n&&n.addEventListener("click",(function(t){t.preventDefault(),e.closeAll(),i(t)}))},function(){e.nav=document.createElement("nav"),D.addClass(e.nav,"menubar"),t.div.appendChild(e.nav);var a=document.createElement("ul");e.nav.appendChild(a),e.ul=a;var h="";h+=i.html(),h+=n.html(),t.options.tabsMenu&&(h+=o.html()),h+=s.html(),h+=r.html();var c,u=0,d=rt(t.test.tests);try{for(d.s();!(c=d.n()).done;){var p=c.value;h+='<li><a class="cirsim-test-'+u+'">'+p.name+"</a></li>",u++}}catch(t){d.e(t)}finally{d.f()}a.innerHTML=h;var f,v=rt(a.childNodes);try{var m=function(){var t=f.value;"LI"===t.tagName&&t.addEventListener("click",(function(i){i.preventDefault();var n=D.child(t,"UL");null!==n&&("hidden"===getComputedStyle(n).getPropertyValue("visibility")?l(t):e.closeAll())}))};for(v.s();!(f=v.n()).done;)m()}catch(t){v.e(t)}finally{v.f()}u=0;var y,g=rt(t.test.tests);try{var b=function(){var i=y.value,n=".cirsim-test-"+u;e.click(n,(function(e){e.preventDefault(),t.test.runTestDlg(i)})),u++};for(g.s();!(y=g.n()).done;)b()}catch(t){g.e(t)}finally{g.f()}i.activate(),n.activate(),o.activate(),s.activate(),r.activate()}()},ht=function(t,e){this.width=t,this.height=e,this.scale=t/60;var i=e/this.scale;this.element=document.createElement("canvas"),this.element.style.width="60px",this.element.style.height=i+"px",this.element.style.backgroundColor="transparent",this.canvas=this.element,this.canvas.height=this.height,this.canvas.width=this.width,this.context=this.canvas.getContext("2d"),this.context.lineWidth=this.scale};ht.prototype.box=function(t,e){var i=this.width/2,n=this.height/2,o=i-t/2-.5,s=i+t/2+.5,r=n-e/2-.5,a=n+e/2+.5;this.context.beginPath(),this.context.moveTo(o,r),this.context.lineTo(s,r),this.context.lineTo(s,a),this.context.lineTo(o,a),this.context.lineTo(o,r),this.fillStroke()},ht.prototype.circle=function(t,e,i){t+=this.width/2,e+=this.height/2;var n=this.context.fillStyle;this.context.fillStyle="#ffffff",this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.fill(),this.context.fillStyle=n,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.stroke()},ht.prototype.io=function(t,e,i,n,o){n=void 0!==n?n:1,o=void 0!==o?o:1,t+=this.width/2,e+=this.height/2;for(var s=0;s<n;s++){this.context.beginPath(),this.context.moveTo(t,e);var r=6*this.scale;switch(i){case"w":case"W":this.context.lineTo(t-r,e);break;case"e":case"E":this.context.lineTo(t+r,e);break;case"n":case"N":this.context.lineTo(t,e-r);break;case"s":case"S":this.context.lineTo(t,e+r)}this.context.stroke(),e+=o}},ht.prototype.clock=function(t,e,i){this.io(t,e,i),this.context.beginPath();switch(t+=this.width/2,e+=this.height/2,i){case"n":case"N":this.context.moveTo(t-3,e),this.context.lineTo(t,e+3),this.context.lineTo(t+3,e)}this.context.stroke()},ht.prototype.drawText=function(t,e,i,n){var o=this.context;o.beginPath(),o.font=void 0!==n?n:"14px Times",o.textAlign="center",o.fillText(t,e+this.width/2,i+this.height/2),o.stroke()},ht.prototype.drawTextBar=function(t,e,i,n){var o=this.context,s=o.lineWidth;this.drawText(t,e,i,n),o.lineWidth=1;var r=o.measureText(t);o.beginPath(),i+=this.height/2-16,o.moveTo(e+this.width/2-r.width/2,i),o.lineTo(e+this.width/2+r.width/2,i),o.stroke(),o.lineWidth=s},ht.prototype.fillStroke=function(t){void 0===t&&(t="white");var e=this.context.fillStyle;this.context.fillStyle=t,this.context.fill(),this.context.fillStyle=e,this.context.stroke()},ht.prototype.lineWidth=function(t){var e=this.context.lineWidth;return this.context.lineWidth=t,e};var ct=function(t,e,i){this.palette=t,this.obj=e,this.circuit=void 0!==i?i.name:null;var n=this.paletteImage(e),o=D.createClassedDiv("cs-item"),s=D.createClassedDiv("cs-box");o.appendChild(s);var r=D.createClassedDiv("cs-img");s.appendChild(r),r.appendChild(n);var a=D.createClassedDiv("cs-desc");e.label.length>7&&D.addClass(a,"long"),a.innerText=void 0!==i?i.name:e.label,s.appendChild(a),this.element=o,t.main.dragAndDrop.draggable(this)};ct.prototype.paletteImage=function(){var t=this.obj;if(null!==t.img&&void 0!==t.img){var e=this.palette.cirsim.root,i=document.createElement("img");return i.setAttribute("src",e+"cirsim/img/"+t.img),i.setAttribute("alt",t.desc),i.setAttribute("title",t.desc),i.setAttribute("draggable","false"),i}if(void 0!==t.paletteImage)return t.paletteImage().element;var n=new ht(60,60);return n.box(30,40),n.io(15,20,"w",2,20),n.io(45,20,"e",2,20),n.drawText(t.label,0,0,"6px Times"),n.element};var ut=function(){};ut.roundedRect=function(t,e,i,n,o,s){n<2*s&&(s=n/2),o<2*s&&(s=o/2),t.beginPath(),t.moveTo(e+s,i),t.arcTo(e+n,i,e+n,i+o,s),t.arcTo(e+n,i+o,e,i+o,s),t.arcTo(e,i+o,e,i,s),t.arcTo(e,i,e+n,i,s),t.closePath()},ut.fillWith=function(t,e){var i=t.fillStyle;t.fillStyle=void 0!==e?e:"#ffffff",t.fill(),t.fillStyle=i},ut.fillTextWith=function(t,e,i,n,o){var s=t.fillStyle;t.fillStyle=void 0!==o?o:"#ffffff",t.fillText(e,i,n),t.fillStyle=s};function dt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return pt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ft=function(t){Y.call(this),this.height=160,this.width=80,this.circuitName=void 0!==t?t.circuit:void 0,this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[]};function vt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return mt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(ft.prototype=Object.create(Y.prototype)).constructor=ft,ft.type="CircuitRef",ft.label="REF",ft.desc="Circuit Component",ft.img="circuitref.png",ft.order=99,ft.description="<h2>Circuit Component</h2><p>A Circuit Component uses anotherCirsim circuit as a component in the current circuit</p>",ft.prototype.compute=function(t){this.getCircuitRef();for(var e=0;e<this.ins.length&&e<this.circuitIns.length;e++)this.circuitIns[e].set(t[e]);for(var i=0;i<this.outs.length&&i<this.circuitOuts.length;i++)this.outs[i].set(this.circuitOuts[i].get())},ft.prototype.advance=function(t){null!==this.circuitRef&&this.circuitRef.advance(t);for(var e=0;e<this.outs.length&&e<this.circuitOuts.length;e++)this.outs[e].set(this.circuitOuts[e].get());return!0},ft.prototype.getCircuitRef=function(){return null!==this.circuitRef?(this.circuitRef.circuits=this.circuit.circuits,this.circuitRef):null===this.circuit.circuits.getCircuit(this.circuitName)?null:(this.circuitRef=this.circuit.circuits.getCircuit(this.circuitName).copy_clone(),this.circuitRef.circuits=this.circuit.circuits,this.circuitRef.newTab(),this.circuitRef.pending(),this.ensureIO(),this.circuitRef)},ft.prototype.newTab=function(){this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[]},ft.prototype.update=function(){this.circuitRef=null,this.circuitIns=[],this.circuitOuts=[],this.ensureIO()},ft.prototype.ensureIO=function(){var t=this.circuitRef;if(null!==t){var e=function(e,i){var n,o=t.getComponentsByType(e),s=dt(t.getComponentsByType(i));try{for(s.s();!(n=s.n()).done;){var r=n.value;o.push(r)}}catch(t){s.e(t)}finally{s.f()}return o.sort((function(t,e){return t.y===e.y?t.x-e.x:t.y-e.y})),o},i=function(t){var e,i={},n=dt(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;i[o.id]=o}}catch(t){n.e(t)}finally{n.f()}return i},n=e("InPin","InPinBus"),o=i(n);if(0===this.circuitIns.length)for(var s=0;s<n.length;s++)n[s].set(void 0);this.circuitIns=n;var r=e("OutPin","OutPinBus"),a=i(r);if(this.circuitOuts=r,n.length===this.ins.length&&r.length===this.outs.length){for(var l=!1,h=0;h<n.length;h++)if(this.ins[h].name!==n[h].naming||this.ins[h].bus!==("InPinBus"===n[h].constructor.type)){l=!0;break}for(var c=0;c<r.length;c++)if(this.outs[c].name!==r[c].naming||this.outs[c].bus!==("OutPinBus"===r[c].constructor.type)){l=!0;break}if(!l)return}var u=n.length>r.length?n.length:r.length;this.height=16*u+32,this.height<48&&(this.height=48);var d=this.width/2,p=-this.height/2+8,f=function(t,e){var i,n={},o=dt(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;null!==s.reference&&void 0!==e[s.reference]?n[e[s.reference].naming]=s:n[s.name]=s}}catch(t){o.e(t)}finally{o.f()}return n},v=f(this.ins,o);this.ins=[];var m=0;for(m=0;m<n.length;m++){var y=void 0;void 0!==v[n[m].naming]?(y=v[n[m].naming],this.ins.push(y),y.name=n[m].naming,y.x=-d,y.y=p+16*m,y.len=16,v[n[m].naming]=null):y=this.addIn(-d,p+16*m,16,n[m].naming),y.bus="InPinBus"===n[m].constructor.type,y.index=m,y.reference=n[m].id}for(var g in v)null!==v[g]&&v[g].clear();var b=f(this.outs,a);for(this.outs=[],m=0;m<r.length;m++){var w=void 0;void 0!==b[r[m].naming]?(w=b[r[m].naming],this.outs.push(w),w.name=r[m].naming,w.x=d,w.y=p+16*m,w.len=16,b[r[m].naming]=null):w=this.addOut(d,p+16*m,16,r[m].naming),w.index=m,w.bus="OutPinBus"===r[m].constructor.type,w.reference=r[m].id}for(var x in b)null!==b[x]&&b[x].clear()}},ft.prototype.clone=function(){var t=new ft;t.circuitName=this.circuitName;for(var e=0;e<this.ins.length;e++){var i=this.ins[e].clone();i.component=t,t.ins.push(i)}for(var n=0;n<this.outs.length;n++){var o=this.outs[n].clone();o.component=t,t.outs.push(o)}return null!==this.circuitRef&&(t.circuitRef=this.circuitRef.copy_clone(),t.ensureIO()),t.copyFrom(this),t},ft.prototype.load=function(t){this.circuitName=t.circuitName,Y.prototype.load.call(this,t),this.getCircuitRef()},ft.prototype.save=function(){var t=Y.prototype.save.call(this);return t.circuitName=this.circuitName,t},ft.prototype.draw=function(t,e){this.getCircuitRef(),this.ensureIO(),this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=(this.x,this.width,this.y-this.height/2-.5);this.y,this.height;t.beginPath(),t.rect(i,n,this.width,this.height),ut.fillWith(t),t.stroke(),t.font="14px Times",t.textAlign="center",null!==this.naming&&t.fillText(this.naming,this.x,this.y-10),t.fillText(this.circuitName,this.x,this.y+this.height/2-5),t.stroke(),this.drawIO(t,e)};var yt=function(t,e){var i=this;this.main=t,this.cirsim=t.cirsim,this.palette=[];var n=null,o=[],s=function(e){var s=e.type;if(b.inArray(s,o)||b.inArray(s,t.options.always)){i.palette.push(e);var r=new ct(i,e);n.appendChild(r.element)}};this.refresh=function(){var e,i=vt(n.querySelectorAll(".cs-circuitref"));try{for(i.s();!(e=i.n()).done;){var o=e.value;n.removeChild(o)}}catch(t){i.e(t)}finally{i.f()}for(var s=t.currentView().tabnum+1;s<t.model.circuits.circuits.length;s++){var r=t.model.circuits.circuits[s],a=new ct(this,ft,r);a.element.classList.add("cs-circuitref"),n.appendChild(a.element)}},function(){if(n=D.createClassedDiv("cs-palette"),e.appendChild(n),"string"==typeof t.options.components){if(null===(o=t.components.getPalette(t.options.components)))throw new Error("options.components invalid name "+t.options.components)}else t.options.components.forEach((function(e){var i=t.components.getPalette(e);null!==i?o=o.concat(i):("not"===e.toLowerCase()&&(e="Inverter"),"decoder"===e.toLowerCase()&&(e="BusDecoder"),o.push(e))}));t.components.components.forEach((function(t){s(t)}))}()},gt=function(){};gt.sanitize=function(t){return M().sanitize(t)},gt.boolean=function(t){return!0===t},gt.htmlentities=function(t){return t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")};var bt=i(43096),wt=i.n(bt),xt=0,Tt=function(){var t=this;this.time=1,this.view=null,this.speed=1e-6,this.instance=++xt,this.order=1,this.priorityQueue=new(wt().PriorityQueue)((function(t,e){return t.time===e.time?e.order-t.order:e.time-t.time})),this.setView=function(t){this.view=t,null===this.view||e||(e=!0,requestAnimationFrame(o))};var e=!1,i=null,n=!1,o=function o(s){e=!1,null===i&&(i=s);var r=.001*(s-i);for(i=s,r>1&&(r=1);r>0;){var a=r;a>.03&&(a=.03),t.advance(a*t.speed)&&null!==t.view&&t.view.draw(),r-=a}null===t.view||n||(e=!0,requestAnimationFrame(o))};this.kill=function(){n=!0}};function It(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return St(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return St(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tt.prototype.queue=function(t,e,i){var n=1e-9*e;this.priorityQueue.add({time:this.time+n,order:this.order,component:t,state:i}),this.order++},Tt.prototype.advance=function(t){for(var e=!1;!this.priorityQueue.isEmpty()&&this.priorityQueue.peek().time<=this.time+t;){var i=this.priorityQueue.dequeue(),n=i.time-this.time;t-=n,this.time=i.time,n>0&&null!==this.view&&this.view.advance(n)&&(e=!0),i.component.compute(i.state),e=!0}return this.time+=t,t>0&&null!==this.view&&this.view.advance(t)&&(e=!0),e};var kt=function(t,e){this.model=t,this.circuits=[],this.grid=8,this.snap=!0,this.id=null!==t?t.id:void 0,this.simulation=e||new Tt,this.prev=null};function At(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Ot(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ot(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}kt.prototype.add=function(t){return this.circuits.push(t),t.circuits=this,t},kt.prototype.insert=function(t){return this.circuits.unshift(t),t.circuits=this,t},kt.prototype.getCircuits=function(){return this.circuits.slice()},kt.prototype.getCircuit=function(t){for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e];if(i.name===t)return i}return null},kt.prototype.advance=function(t){for(var e=!1,i=0;i<this.circuits.length;i++){this.circuits[i].advance(t)&&(e=!0)}return e},kt.prototype.canDelete=function(t){if(0===t)return!1;for(var e=this.circuits[t],i=0;i<t;i++){if(this.circuits[i].references(e).length>0)return!1}return!0},kt.prototype.canMoveLeft=function(t){if(t<2)return!1;var e=this.circuits[t];return 0===this.circuits[t-1].references(e).length},kt.prototype.canMoveRight=function(t){if(0===t||t===this.circuits.length-1)return!1;var e,i=this.circuits[t+1].name,n=It(this.circuits[t].references());try{for(n.s();!(e=n.n()).done;){if(e.value.circuitName===i)return!1}}catch(t){n.e(t)}finally{n.f()}return!0},kt.prototype.moveLeft=function(t){if(this.canMoveLeft(t)){this.model.backup();var e=this.circuits[t-1];return this.circuits[t-1]=this.circuits[t],this.circuits[t]=e,!0}return!1},kt.prototype.moveRight=function(t){if(this.canMoveRight(t)){this.model.backup();var e=this.circuits[t+1];return this.circuits[t+1]=this.circuits[t],this.circuits[t]=e,!0}return!1},kt.prototype.rename=function(t,e){this.model.backup();for(var i=this.circuits[t],n=0;n<t;n++){var o,s=It(this.circuits[n].references(i));try{for(s.s();!(o=s.n()).done;){o.value.circuitName=e}}catch(t){s.e(t)}finally{s.f()}}i.setName(e)},kt.prototype.newTab=function(){for(var t=this.circuits.length-1;t>=0;t--)this.circuits[t].newTab()},kt.prototype.recompute=function(){for(var t=this.circuits.length-1;t>=0;t--)this.circuits[t].recompute()},kt.prototype.clone=function(){var t=new kt(this.model,this.simulation);t.grid=this.grid,t.snap=this.snap,t.prev=this.prev,this.prev=t;for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e];t.add(i.clone())}return t},kt.prototype.update=function(t){var e,i=It(this.circuits);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n===t)break;n.update()}}catch(t){i.e(t)}finally{i.f()}},kt.prototype.toJSON=function(){return JSON.stringify(this.save())},kt.prototype.fmJSON=function(t){var e=JSON.parse(t);this.load(e)},kt.prototype.save=function(){for(var t=[],e=0;e<this.circuits.length;e++){var i=this.circuits[e];t.push(i.save())}var n={grid:this.grid,circuits:t,id:this.id};return this.snap&&(n.snap=!0),n},kt.prototype.load=function(t){this.grid=+t.grid,this.snap=gt.boolean(t.snap),this.prev=null,this.circuits=[],void 0!==t.id&&(this.id=gt.sanitize(t.id));for(var e=t.circuits.length-1;e>=0;e--){var i=t.circuits[e],n=new Ct(i.name);this.insert(n),n.load(i)}for(var o=this.circuits.length-1;o>=0;o--)this.circuits[o].pending()},kt.prototype.addCircuit=function(t){var e=new Ct(t);this.add(e)},kt.prototype.deleteCircuitByIndex=function(t){this.circuits.splice(t,1)},kt.prototype.getComponentByNaming=function(t){for(var e=0;e<this.circuits.length;e++){var i=this.circuits[e].getComponentByNaming(t);if(null!==i)return i}return null},kt.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.circuits.length;i++){var n=this.circuits[i].getComponentsByType(t);e=e.concat(n)}return e},kt.prototype.replaceCircuit=function(t){t.circuits=this;for(var e=0;e<this.circuits.length;e++)if(this.circuits[e].name===t.name){this.circuits[e]=t,t.components.forEach((function(t){t.pending()})),this.model.newTab();break}};var Ct=function(t){this.circuits=null,this.components=[],this.name=t,this.width=this.defWidth,this.height=this.defHeight,this.prev=null,this.touch=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touch(t,e);if(null!==n)return n}return null},this.advance=function(t){for(var e=!1,i=0;i<this.components.length;i++){this.components[i].advance(t)&&(e=!0)}return e}};function Et(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return zt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Ct.prototype.defWidth=1920,Ct.prototype.defHeight=1080,Ct.prototype.clone=function(){var t=new Ct(this.name);t.width=this.width,t.height=this.height,t.prev=this.prev,this.prev=t;for(var e=0;e<this.components.length;e++){var i=(o=this.components[e]).clone();t.add(i)}for(var n=0;n<this.components.length;n++)for(var o=this.components[n],s=0;s<o.outs.length;s++)for(var r=o.outs[s],a=0;a<r.to.length;a++)r.to[a].clone();return t},Ct.prototype.copy_clone=function(){var t=new Ct(this.name);t.width=this.width,t.height=this.height;for(var e=0;e<this.components.length;e++){var i=(n=this.components[e]).clone();t.add(i)}for(e=0;e<this.components.length;e++)for(var n=this.components[e],o=0;o<n.outs.length;o++)for(var s=n.outs[o],r=0;r<s.to.length;r++)s.to[r].clone();return t},Ct.prototype.update=function(){var t,e=At(this.components);try{for(e.s();!(t=e.n()).done;){t.value.update()}}catch(t){e.e(t)}finally{e.f()}},Ct.prototype.draw=function(t,e){this.components.forEach((function(i,n,o){i.draw(t,e)}))},Ct.prototype.newTab=function(){for(var t=0;t<this.components.length;t++){this.components[t].newTab()}},Ct.prototype.recompute=function(){for(var t=0;t<this.components.length;t++)this.components[t].pending()},Ct.prototype.inRect=function(t){for(var e=[],i=this.components.length-1;i>=0;i--)this.components[i].inRect(t,e);return e},Ct.prototype.snapIt=function(t){this.circuits.snap&&(t.x=this.circuits.grid*Math.round(t.x/this.circuits.grid),t.y=this.circuits.grid*Math.round(t.y/this.circuits.grid))},Ct.prototype.add=function(t){return this.components.push(t),t.added(this),t},Ct.prototype.delete=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e]===t){this.components.splice(e,1);break}},Ct.prototype.touchIn=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touchIn(t,e);if(null!==n)return n}return null},Ct.prototype.touchOut=function(t,e){for(var i=this.components.length-1;i>=0;i--){var n=this.components[i].touchOut(t,e);if(null!==n)return n}return null},Ct.prototype.save=function(){for(var t=[],e=0;e<this.components.length;e++){var i=this.components[e];t.push(i.save())}for(var n=[],o=0;o<this.components.length;o++){var s=this.components[o];n=n.concat(s.saveConnections())}return{name:this.name,width:this.width,height:this.height,components:t,connections:n}},Ct.prototype.load=function(t){this.name=gt.sanitize(t.name),this.width=+t.width,this.height=+t.height;for(var e={},i=0;i<t.components.length;i++){var n=t.components[i],o=void 0;if(null!==(o="CircuitRef"===n.type?ft:this.circuits.model.main.components.get(n.type))){var s=new o;s.circuit=this,s.load(n),e[s.id]=s,this.add(s)}else console.log(n)}for(var r=0;r<t.connections.length;r++){var a=t.connections[r],l=e[a.from];if(void 0!==l){var h=e[a.to];if(void 0!==h){var c=a.out,u=a.in,d=this.connect(l,c,h,u);null!==d&&d.load(a)}else console.log("To object undefined"),console.log(this),console.log(a)}else console.log("From object undefined"),console.log(this),console.log(a)}},Ct.prototype.getComponentByNaming=function(t){for(var e=0;e<this.components.length;e++){var i=this.components[e];if(i.naming===t)return i}return null},Ct.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.components.length;i++){var n=this.components[i];n.constructor.type===t&&e.push(n)}return e},Ct.prototype.mouseUp=function(){for(var t=0;t<this.components.length;t++){this.components[t].mouseUp()}},Ct.prototype.connect=function(t,e,i,n){return t.outs.length<=e||i.ins.length<=n?null:new B(t.outs[e],i.ins[n])},Ct.prototype.getComponentsByType=function(t){for(var e=[],i=0;i<this.components.length;i++){var n=this.components[i];n.constructor.type===t&&e.push(n)}return e},Ct.prototype.maxXY=function(){for(var t=1,e=1,i=0;i<this.components.length;i++){var n=this.components[i].bounds();n.right>t&&(t=n.right),n.bottom>e&&(e=n.bottom)}return{x:t+16,y:e+16}},Ct.prototype.bounds=function(){if(0===this.components.length)return new x;for(var t=this.components[0].bounds(),e=0;e<this.components.length;e++){var i=this.components[e].bounds();t.expand(i)}return t},Ct.prototype.pending=function(){for(var t=0;t<this.components.length;t++){this.components[t].pending()}},Ct.prototype.getName=function(){return this.name},Ct.prototype.setName=function(t){this.name=t},Ct.prototype.stats=function(){var t=0;return this.components.forEach((function(e){e.outs.forEach((function(e){t+=e.to.length}))})),{name:this.name,numComponents:this.components.length,numConnections:t,width:this.width,height:this.height}},Ct.prototype.moveToFront=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e]===t){this.components.splice(e,1),this.components.push(t);break}},Ct.prototype.references=function(t){var e,i=[],n=At(this.components);try{for(n.s();!(e=n.n()).done;){var o=e.value;o instanceof ft&&(void 0!==t?o.circuitName===t.name&&i.push(o):i.push(o))}}catch(t){n.e(t)}finally{n.f()}return i};var Bt=function(t){this.main=t,this.circuits=new kt(this),this.circuits.add(new Ct("main"))};Bt.prototype.getCircuit=function(t){return this.circuits.getCircuit(t)},Bt.prototype.undo=function(){null!==this.circuits.prev&&(this.circuits=this.circuits.prev)},Bt.prototype.backup=function(){this.circuits.clone()},Bt.prototype.status=function(){var t,e=0,i=this.circuits,n=Et(i.circuits);try{for(n.s();!(t=n.n()).done;){for(var o=t.value,s=0,r=o;null!==r;)s++,r=r.prev;console.log("circuit depth: "+s)}}catch(t){n.e(t)}finally{n.f()}for(;null!==i;)e++,i=i.prev;console.log("circuits depth: "+e)},Bt.prototype.update=function(t){this.circuits.update(t)},Bt.prototype.toJSON=function(){return this.circuits.toJSON()},Bt.prototype.fmJSON=function(t){this.circuits.simulation.setView(null),this.circuits=new kt(this),this.circuits.fmJSON(t)},Bt.prototype.getSimulation=function(){return this.circuits.simulation},Bt.prototype.newTab=function(){this.circuits.newTab(),this.recompute()},Bt.prototype.recompute=function(){this.circuits.recompute()},Bt.prototype.addCircuit=function(t){this.backup(),this.circuits.addCircuit(t)},Bt.prototype.deleteCircuitByIndex=function(t){this.backup(),this.circuits.deleteCircuitByIndex(t)},Bt.prototype.getComponentByNaming=function(t){return this.circuits.getComponentByNaming(t)},Bt.prototype.getComponentsByType=function(t){return this.circuits.getComponentsByType(t)},Bt.prototype.replaceCircuit=function(t){this.circuits.replaceCircuit(t)},Bt.prototype.kill=function(){this.getSimulation().kill()};var Nt=function(t){var e=this;this.selection=[];var i=!1,n=!1,o=null;this.mouseDown=function(e,s,r){i=!0,n=!0;var a=t.circuit.touch(e,s);null!==a?a.single()?this.selection=[a]:this.isSelected(a)||(r.shiftKey||(this.selection=[]),this.selection.push(a)):(r.shiftKey||(this.selection=[]),o=new x(e,s,e,s));for(var l=0;l<this.selection.length;l++)this.selection[l].grab()},this.mouseMove=function(e,s,r,a){if(i){if(n){if(null===o&&this.selection.length>0&&t.model.backup(),1===this.selection.length){var l=this.selection[0].spawn(e,s);null!==l&&(this.selection=[l])}n=!1}if(null!==o)o.setRightBottom(e,s);else for(var h=0;h<this.selection.length;h++)this.selection[h].move(r,a);t.model.update(t.circuit)}},this.mouseUp=function(e,n){if(i){for(var r=!1,a=0;a<this.selection.length;a++)this.selection[a].single()&&(r=!0),this.selection[a].drop();r&&(this.selection=[])}i=!1,null!==o&&(s(),o=null),t.circuit.mouseUp()};var s=function(){if(o.normalize(),!o.isEmpty()){var i=t.circuit.inRect(o);if(i.length>0){for(var n=e.selection.slice(),s=0;s<i.length;s++)e.isSelected(i[s])||n.push(i[s]);e.selection=n}}};this.isSelected=function(t){for(var e=0;e<this.selection.length;e++)if(t===this.selection[e])return!0;return!1},this.draw=function(t){null!==o&&(t.setLineDash||(t.setLineDash=function(){}),t.strokeStyle="#888888",t.setLineDash([2,3]),t.beginPath(),t.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),t.stroke(),t.setLineDash([]))},this.getSelection=function(){return this.selection},this.clear=function(){this.selection=[]}};Nt.prototype.delete=function(){this.selection.forEach((function(t){t.delete()})),this.clear()};function Lt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Pt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Pt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Rt=function(t){this.api=t};Rt.prototype.errors=function(){return void 0!==this.api.errors?this.api.errors:null},Rt.prototype.fetch=function(t){if(void 0===this.api.data)return[];var e=[];return this.api.data.forEach((function(i){i.type===t&&e.push(i)})),e},Rt.prototype.getData=function(t){if(void 0===this.api.data)return[];var e,i=Lt(this.api.data);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n.type===t)return n}}catch(t){i.e(t)}finally{i.f()}return null};var jt=function(t,e,i){F.call(this),this.buttonOk=null,this.open=function(n){var o=this;this.contents("<p>Loading tab from server...</p>","Loading tab..."),F.prototype.open.call(this);var s=e.getAPI("import"),r={};Object.assign(r,s.extra),Object.assign(r,t.extra),null!==s&&tt.do({url:s.url,data:Object.assign({cmd:"open",name:t.name},r),method:"GET",dataType:"json",success:function(t){var e=new Rt(t);if(!i.jsonErrors(e)){var s=t.data[0].attributes.data;n(s)}o.close()},error:function(t,e,n){console.log(t.responseText),i.message("Unable to communicate with server: "+n),o.close()}})}};(jt.prototype=Object.create(F.prototype)).constructor=jt;i(31511);var Dt=i(96e3),Ut=function(t){F.call(this);var e=this.uniqueId();this.open=function(){var t='<div class="control"><label for="'.concat(e,'">Name</label>\n<input type="text" id="').concat(e,'" value="circuit" class="text ui-widget-content ui-corner-all">\n</div>\n<p>Enter a name for the exported .png file.</p>');this.buttonOk="Export",this.contents(t,"Cirsim Export PNG"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=this.sanitize(document.getElementById(e).value).replace(/^\s+|\s+$/gm,"").replace(/\.[^/.]+$/,"");if(0===i.length)this.error("You must supply a name");else{this.close(),i.endsWith(".png")||(i+=".png");var n=t.circuit,o=document.createElement("canvas"),s=n.bounds(),r=s.right-s.left+2,a=s.bottom-s.top+2;o.style.width=r+"px",o.style.height=a+"px",o.width=r,o.height=a;var l=o.getContext("2d");l.fillStyle="white",l.fillRect(0,0,o.width,o.height),l.translate(1-s.left,1-s.top),n.draw(l,t),o.toBlob((function(t){(0,Dt.Z)(t,i)}))}}};(Ut.prototype=Object.create(F.prototype)).constructor=Ut;var Mt=function(t,e,i){var n=this;Object.defineProperties(this,{main:{get:function(){return t}},circuit:{get:function(){return i},set:function(t){i=t}},element:{get:function(){return e}},model:{get:function(){return i.circuits.model}}}),this.selection=new Nt(this),this.tabnum=-1,e.addEventListener("dragover",(function(t){t.preventDefault()})),e.addEventListener("drop",(function(t){t.preventDefault()})),this.initialize=function(){n.setSize(),t.dragAndDrop.droppable(n,(function(t,e,i){var o=t.obj;if(void 0!==o){n.model.backup();var s=new o(t);s.brand(),s.x=e,s.y=i,n.circuit.add(s),n.circuit.snapIt(s),n.ensureSize(),n.draw()}}));var i={x:0,y:0},o={x:0,y:0},s={x:0,y:0},r=function(r,c,u,d){var p=D.offset(e);s={x:r,y:c},o.x=r-p.left,o.y=c-p.top,i.x=o.x,i.y=o.y,"inline"!==t.options.display?(n.selection.mouseDown(o.x,o.y,d),n.draw(),u?e.addEventListener("touchmove",h):e.addEventListener("mousemove",l),e.parentNode.addEventListener("scroll",a)):n.circuit.touch(o.x,o.y)},a=function(){var t=D.offset(e);o.x=s.x-t.left,o.y=s.y-t.top,n.selection.mouseMove(o.x,o.y,o.x-i.x,o.y-i.y),i.x=o.x,i.y=o.y,n.draw()},l=function(t){t.preventDefault(),c(t.pageX,t.pageY,!1)},h=function(t){t.preventDefault();var e=t.changedTouches[0];c(e.pageX,e.pageY,!0)},c=function(t,r,a){if(t!==s.x||r!==s.y){var l=D.offset(e);s={x:t,y:r},o.x=t-l.left,o.y=r-l.top,n.selection.mouseMove(o.x,o.y,o.x-i.x,o.y-i.y),n.ensureSize(),i.x=o.x,i.y=o.y,n.draw()}},u=function(t,s,r){e.parentNode.removeEventListener("scroll",a);var l=D.offset(e);o.x=t-l.left,o.y=s-l.top,n.selection.mouseUp(o.x,o.y),i.x=o.x,i.y=o.y,n.draw()};e.addEventListener("mousedown",(function(t){t.preventDefault(),r(t.pageX,t.pageY,!1,t)})),e.addEventListener("dblclick",(function(e){(e.preventDefault(),1===n.selection.selection.length&&n.selection.selection[0]instanceof Y)&&n.selection.selection[0].properties(t)})),document.querySelector("body").addEventListener("mouseup",(function(t){e.removeEventListener("mousemove",l),u(t.pageX,t.pageY,!1)})),e.addEventListener("touchstart",(function(t){t.preventDefault();var e=t.changedTouches[0];r(e.pageX,e.pageY,!0,t)})),e.addEventListener("touchend",(function(t){t.preventDefault();var e=t.changedTouches[0];u(e.pageX,e.pageY,!0)})),e.addEventListener("touchcancel",(function(t){var e=t.changedTouches[0];u(e.pageX,e.pageY,!0)}))},this.draw=function(){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),this.circuit.draw(t,this),this.selection.draw(t)},this.delete=function(){this.model.backup(),this.selection.delete(),this.draw()},this.advance=function(t){return this.circuit.circuits.advance(t)},this.ensureSize=function(){var t=this.circuit.bounds(),n=t.right+1,o=t.bottom+1;n>e.offsetWidth&&(e.style.width=n+"px",e.setAttribute("width",n),i.width=n),o>e.offsetHeight&&(e.style.height=t.bottom+"px",e.setAttribute("height",t.bottom),i.height=t.bottom)},this.setSize=function(){e.offsetWidth===this.circuit.width&&e.offsetHeight===this.circuit.height||(e.style.width=this.circuit.width+"px",e.style.height=this.circuit.height+"px",e.width=this.circuit.width,e.height=this.circuit.height)},this.initialize(),this.draw()};Mt.prototype.importTab=function(t){var e=this;this.selection.clear(),new jt(t,this.main.options,this.main.toast).open((function(i){e.model.backup();var n=new Bt(e.main);n.fmJSON(i);var o=n.getCircuit(t.from);null!==o&&(o.name=t.into,e.main.model.replaceCircuit(o),e.circuit=o,e.draw())}))},Mt.prototype.exportPNG=function(){new Ut(this).open()};var qt=function(t){var e=this;this.active=-1;var i=[],n=null,o=null,s=null;this.size=function(){return i.length},this.create=function(t){n=D.createClassedDiv("tabs"),o=document.createElement("ul"),n.appendChild(o),s=D.createClassedDiv("panes"),n.appendChild(s),t.appendChild(n),i=[],e.sync()},this.sync=function(){if(function(){var e=t.model.circuits.getCircuits();if(i.length!==e.length)return!0;for(var n=0;n<i.length;n++){if(i[n].circuit!==e[n])return!0;if(i[n].li.querySelector("a").textContent!==e[n].getName())return!0}return!1}()){var e=this.active>=0?i[this.active].circuit:null,a=t.model.circuits.getCircuits();s=D.createClassedDiv("panes"),o=document.createElement("ul");var l=[];a.forEach((function(e){var n=document.createElement("li"),a=document.createElement("a");n.appendChild(a),a.innerText=e.getName(),n.addEventListener("click",(function(t){t.preventDefault(),r(n)})),a.addEventListener("click",(function(t){t.preventDefault(),r(n)})),o.appendChild(n);var h=null,c=null;for(var u in i)e===i[u].circuit&&(h=i[u].pane,c=i[u].view);if(null===h){h=D.createClassedDiv("tab");var d=document.createElement("canvas");h.appendChild(d),c=new Mt(t,d,e)}s.appendChild(h),c.tabnum=l.length,l.push({li:n,pane:h,circuit:e,view:c})})),n.innerHTML="",n.appendChild(o),n.appendChild(s),i=l,this.selectTabByCircuit(e)}},this.selectTabByCircuit=function(t){if(null===t)this.selectTab(0,!0);else{var e=!1;for(var n in i)if(t===i[n].circuit){e=!0,this.selectTab(n,!0);break}e||(this.active>=i.length?this.selectTab(this.active-1):this.selectTab(this.active))}};var r=function(t){for(var n=0;n<i.length;n++)i[n].li===t&&e.selectTab(n)};this.selectTab=function(n,o){if(!0===o||n!==e.active){i.forEach((function(t){D.removeClass(t.li,"selected"),D.removeClass(t.pane,"selected")})),e.active=+n;var s=i[e.active];D.addClass(s.li,"selected"),D.addClass(s.pane,"selected"),s.view.draw(),t.model.getSimulation().setView(s.view),t.newTab()}},this.currentView=function(){return e.active<0?null:i[e.active].view},this.currentCircuit=function(){return e.active<0?null:i[e.active].circuit},this.undo=function(){var t=this.active>=0?i[this.active].circuit:null;null!==t&&(t=t.prev),this.active=-1;for(var e=0,n=i;e<n.length;e++){n[e].view.selection.clear()}this.sync();for(var o=0,s=i;o<s.length;o++){s[o].view.draw()}this.selectTabByCircuit(t)},this.destroy=function(){this.active=-1,n.parentNode.removeChild(n),n=null,i=[]},this.validateName=function(e,i){for(var n=t.model.circuits.getCircuits(),o=0;o<n.length;o++){var s=n[o];if(s!==i&&e.toLowerCase()===s.getName().toLowerCase())return"Name "+e+" already in use by another tab"}return null},this.add=function(e){t.model.addCircuit(e),this.sync(),this.selectTab(i.length-1,!0)},this.delActive=function(i){e.active<0||(t.model.deleteCircuitByIndex(e.active),e.sync())},this.rename=function(e){t.model.circuits.rename(this.active,e),this.sync()}},Ft=function(t){F.call(this);var e=this.uniqueId();this.open=function(){var t='<div class="control"><label for="'.concat(e,'">Name</label>\n<input type="text" id="').concat(e,'" value="circuit" class="text ui-widget-content ui-corner-all">\n</div>\n<p>Enter a name for the exported .cirsim file.</p>');this.buttonOk="Export",this.contents(t,"Cirsim Export"),F.prototype.open.call(this),document.getElementById(e).select()},this.ok=function(){var i=this.sanitize(document.getElementById(e).value).replace(/^\s+|\s+$/gm,"").replace(/\.[^/.]+$/,"");if(0===i.length)this.error("You must supply a name");else{this.close(),i.endsWith(".cirsim")||(i+=".cirsim");var n=t.toJSON();(0,Dt.Z)(new Blob([n],{type:"application/json"}),i)}}};(Ft.prototype=Object.create(F.prototype)).constructor=Ft;var Ht=function(t,e){F.call(this);var i=this,n=L.uniqueName(),o='<div class="control gap"><input class="file" type="file" id="'+n+'" /><br><span id="import-error" class="error"></span></div><p>Choose a file to import into Cirsim.</p>';this.ok=function(){var o=document.getElementById(n).files;if(!(o.length<1)){var s=o[0],r=new FileReader;r.onload=function(n){e.fmJSON(n.target.result),i.close(),t.reload()},r.onerror=function(t){i.error("Error reading circuits file")},r.onabort=function(t){i.error("Circuits file read aborted")},r.readAsText(s)}},this.buttonOk="Import",this.contents(o,"Cirsim Import")};(Ht.prototype=Object.create(F.prototype)).constructor=Ht;var Xt=function t(e,i){this.value=void 0,this.type=void 0!==i?i:t.AUTO,void 0!==e&&this.set(e)};Xt.AUTO=0,Xt.BINARY=1,Xt.HEX=2,Xt.FLOAT16=3,Xt.prototype.get=function(){return this.value},Xt.prototype.getBit=function(t){if(!(this.value.length<=t))return this.value[t]},Xt.prototype.set=function(t){Array.isArray(t)?this.value=t.slice():t instanceof Xt?this.value=t.value.slice():"string"==typeof t||t instanceof String?this.setAsString(t):this.value=t},Xt.prototype.setZero=function(t){this.value=[];for(var e=0;e<t;e++)this.value.push(!1)},Xt.prototype.clone=function(){return new Xt(this.value,this.type)},Xt.prototype.save=function(t){t.value=this.value,this.type!==Xt.AUTO&&(t.valuetype=this.type)},Xt.prototype.equals=function(t){if(this.value===t.value)return!0;if(Array.isArray(this.value)&&Array.isArray(t.value)&&this.value.length===t.value.length){for(var e=0;e<this.value.length;e++)if(this.value[e]!==t.value[e])return!1;return!0}return!1},Xt.prototype.load=function(t){this.set(t.value),void 0!==t.valuetype&&(this.type=t.valuetype)},Xt.prototype.getAsString=function(){if(void 0===this.value)return"?";switch(this.type){default:return this.value.length>8?this.getAsHex():this.getAsBinary();case Xt.BINARY:return this.getAsBinary();case Xt.HEX:return this.getAsHex();case Xt.FLOAT16:return this.getAsFloat16()}},Xt.prototype.setAsString=function(t,e){if("string"==typeof t||t instanceof String||(t=t.toString()),(t=(t=(t=gt.sanitize(t)).replace(/^\s+|\s+$/gm,"")).toLowerCase()).indexOf("inf")>=0||"nan"===t)return this.setAsFloat16(t,e);var i=t.substr(0,2);if("0x"===i)return this.setAsHex(t.substr(2),e);if("0b"===i)return this.setAsBinary(t.substr(2),e);if(t.indexOf(".")>=0||t.indexOf("e")>=0||t.indexOf("-")>=0)return this.setAsFloat16(t,e);switch(this.type){default:case Xt.BINARY:return this.setAsBinary(t,e);case Xt.HEX:return this.setAsHex(t,e);case Xt.FLOAT16:return this.setAsFloat16(t,e)}},Xt.prototype.draw=function(t,e,i,n,o){t.save(),t.translate(e,i),t.font="14px Times",t.textAlign="left";var s=0;null!=o&&(s=t.measureText(o+": ").width);var r=this.getAsString(),a=s+t.measureText(r).width,l=1;a>n&&(l=n/a,t.scale(l,l));s>0&&t.fillText(o+": ",-a/2,5),(this.type==Xt.HEX||this.type==Xt.AUTO&&Array.isArray(this.value)&&this.value.length>8)&&(t.font="bold 14px Times"),t.fillText(r,-a/2+s,5),t.restore()},Xt.prototype.dialogContent=function(t,e){var i=this,n=t.uniqueId(),o=t.uniqueId(),s=function(t,e,n){return'<input type="radio" name="'.concat(o,'" value="').concat(n,'"').concat(i.type===n?" checked":"","> ").concat(e)},r="";if(e){var a;switch(this.type){default:case Xt.BINARY:a="0b"+this.getAsBinary();break;case Xt.HEX:a="0x"+this.getAsHex();break;case Xt.FLOAT16:a=this.getAsFloat16()}r+='<div class="control"><label for="'+n+'">Value</label><input type="text" id="'+n+'" name="'+n+'" value="'+a+'" spellcheck="false" onfocus=" this.select()"></div>'}return{html:r+='<div class="control">'+s(0,"Auto",Xt.AUTO)+"<br>"+s(0,"Hexadecimal",Xt.HEX)+"<br>"+s(0,"Binary",Xt.BINARY)+"<br>"+s(0,"Float-16",Xt.FLOAT16)+"</div>",validate:function(){if(e){var t=i.type;i.type=parseInt(document.querySelector('input[name="'+o+'"]:checked').value);var s=document.getElementById(n).value,r=i.setAsString(s,!0);if(i.type=t,!r)return"Invalid value"}return null},accept:function(){if(i.type=parseInt(document.querySelector('input[name="'+o+'"]:checked').value),e){var t=document.getElementById(n).value;i.setAsString(t,!1)}}}},Xt.prototype.dialogOptions=function(t,e,i){var n=this.dialogContent(t,e);t.extra(n.html,n.validate,(function(){n.accept(),void 0!==i&&i()}),e?170:130)},Xt.prototype.getAsInteger=function(){if(!Array.isArray(this.value))return"?";for(var t=0,e=1,i=0;i<this.value.length;i++,e*=2){if(void 0===this.value[i])return"?";this.value[i]&&(t+=e)}return t},Xt.prototype.setAsInteger=function(t,e){for(var i=[],n=0;n<e;n++)i.push(1==(1&t)),t>>=1;return this.value=i,!0},Xt.prototype.getAsHex=function(){if(!Array.isArray(this.value))return"?";for(var t="",e=0;e<this.value.length;e+=4){for(var i=1,n=0,o=0;o<4&&e+o<this.value.length;o++,i*=2){if(void 0===this.value[e+o]){n=-1;break}this.value[e+o]&&(n+=i)}t=n<0?"?"+t:Number(n).toString(16)+t}return t},Xt.prototype.setAsHex=function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var o=t.substr(n,1);if(" "!==o)if("?"===o)i.push([void 0,void 0,void 0,void 0]);else{var s=parseInt(o,16);if(isNaN(s))return!1;i.push(1==(1&s),2==(2&s),4==(4&s),8==(8&s))}else if(i.length>0)break}return e||(this.value=i),!0},Xt.prototype.getAsBinary=function(){return function t(e){if(Array.isArray(e)){var i="";return e.forEach((function(e){i=t(e)+i})),i}return void 0===e?"?":e?"1":"0"}(this.value)},Xt.prototype.setAsBinary=function(t,e){for(var i=[],n=t.length-1;n>=0;n--){var o=t.substr(n,1);if(" "!==o)switch(o){case"0":i.push(!1);break;case"1":i.push(!0);break;case"?":i.push(void 0);break;default:return!1}else if(i.length>0)break}return e||(this.value=i),!0},Xt.prototype.setInfinity16=function(t){this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,t]},Xt.prototype.getAsFloat16=function(){if(this.value.length<16)return"?";for(var t=this.value[15]?"-":"",e=0;e<15&&!this.value[e];e++);if(e>=15)return t+"0";var i=1,n=0;for(e=10;e<15;e++,i*=2)this.value[e]&&(n+=i);if(31==n){for(e=0;e<10;e++)if(this.value[e])return"NaN";return t+"inf"}n-=15;var o=1;i=.5;for(e=9;e>=0;e--,i/=2)this.value[e]&&(o+=i);return t+(o*=Math.pow(2,n)).toExponential(3)},Xt.prototype.setAsFloat16=function(t,e){var i=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];if("inf"===t)return e||(this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1]),!0;if("-inf"===t)return e||(this.value=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!0]),!0;if("nan"===t)return e||(this.value=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1]),!0;var n=parseFloat(t);if(isNaN(n))return!1;if(0==n)return e||(this.value=i),!0;var o=n<0;o&&(n=-n);for(var s=0;n>1&&s<16;)n/=2,s++;if(s>=15)return e||this.setInfinity16(o),!0;for(;n<1&&s>-15;)n*=2,s--;if(s<=-15)return e||this.setZero(16),!0;n-=1,n*=2;for(var r=9;r>=0;r--,n*=2)n>=1?(i[r]=!0,n-=1):i[r]=!1;for(s+=15,r=10;r<15;r++,s>>=1)i[r]=!!(1&s);return i[15]=o,e||(this.value=i),!0};var Wt=function(t){this.msg=t};function Yt(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Vt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Vt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function Vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Zt=function(t){function e(t){return"string"==typeof t||t instanceof String}function i(e,i,n){if(void 0!==e.result){var o,s=Yt(document.querySelectorAll(e.result));try{for(s.s();!(o=s.n()).done;){o.value.value=i}}catch(t){s.e(t)}finally{s.f()}}if(void 0!==e.circuit){var r,a=Yt(document.querySelectorAll(e.circuit));try{for(a.s();!(r=a.n()).done;){r.value.value=n}}catch(t){a.e(t)}finally{a.f()}}var l=t.options.getAPI("test");if(null!==l){var h=Object.assign({cmd:"test",name:l.name,result:i,data:n,type:"application/json"},l.extra);tt.do({url:l.url,data:h,method:"POST",dataType:"json",contentType:l.contentType,success:function(e){var i=new Rt(e);t.toast.jsonErrors(i)||t.toast.message("Test result successfully saved to server")},error:function(e,i,n){t.toast.message("Unable to communicate with server: "+n)}})}}this.main=t,this.tests=[],this.addTest=function(t){t===Object(t)?this.tests.push(t):("{"===t.substr(0,1)||(t=atob(t)),this.tests.push(JSON.parse(t)))},this.findTest=function(t){for(var e=0;e<this.tests.length;e++)if(this.tests[e].tag===t)return this.tests[e];return null},this.runTestDlg=function(e){t.save(!0,!0),t.modal(!0),this.runTest(e).then((function(e){t.modal(!1);new J("Success","<h1>Circuit Success</h1><p>The test has passed.</p>").open(),i(e,void 0!==e.success?e.success:"success",t.model.toJSON())}),(function(n){t.modal(!1),new J("Test Failure","<h1>Circuit Failure</h1>"+n,450).open(),i(e,"fail",t.model.toJSON())}))},this.runTest=function(i){return new Promise((function(n,o){var s=t.model;s.backup();var r,a,l=-1;try{r=function(e){for(var i=t.model,n=[],o=0;o<e.input.length;o++){var s=e.input[o],r=s.split(":"),a=i,l="";if("tab"===r[0]){if(r.length<3)throw new Wt("<p>Invalid input tab definition: "+s+"</p>");var h=r[1];if(null===(a=i.getCircuit(h)))throw new Wt("<p>Invalid input tab: "+h+"</p>");l=" in tab <em>"+h+"</em>",r.splice(0,2)}if("type"===r[0]){if(r.length<2)throw new Wt("<p>Invalid input type specification: "+s+"</p>");var c=r[1],u=a.getComponentsByType(c);if(r.length>2){var d,p=null,f=Yt(u);try{for(f.s();!(d=f.n()).done;){var v=d.value;if(v.naming===r[2]){p=v;break}}}catch(t){f.e(t)}finally{f.f()}if(null===p)throw new Wt("<p>The test is not able to pass because you do not have a component named "+r[2]+" of type "+c+l+".</p>");n.push(p)}else{if(0===u.length)throw new Wt("<p>The test is not able to pass because you do not have a component of type "+c+l+".</p>");if(u.length>1)throw new Wt("<p>The test is not able to pass because you have more than one  component of type "+c+l+".</p><p>You are only allowed one component of that type in this circuit.</p>");n.push(u[0])}}else{var m=a.getComponentByNaming(r[0]);if(null===m)throw new Wt("<p>The test is not able to pass because you do not have a component named "+r[0]+l+".</p><p>Typically, the tests are looking for an input pin or a bus input pin. Input pins are labeled IN in the palette. Double-click on an input pin to set the name. Names in Cirsim are case sensitive.</p>");n.push(m)}}return n}(i),a=function(e){for(var i=t.model,n=[],o=0;o<e.output.length;o++){var s=i,r="",a=e.output[o].split("-"),l=a[0],h=l.split(":");if("tab:"===l.substr(0,4)){var c=l.substr(4),u=c.indexOf(":");if(-1===u)throw new Wt("<p>Invalid output tab definition: "+l+"</p>");var d=c.substr(0,u);if(null===(s=i.getCircuit(d)))throw new Wt("<p>Invalid out tab: "+d+"</p>");r=" in tab <em>"+d+"</em>",l=c.substr(u+1),h.splice(0,2)}var p=a.length>1?a[1]:0;if("type"===h[0]){if(h.length<2)throw new Wt("<p>Invalid output type specification: "+l+"</p>");var f=h[1],v=s.getComponentsByType(f);if(h.length>2){var m,y=null,g=Yt(v);try{for(g.s();!(m=g.n()).done;){var b=m.value;if(b.naming===h[2]){y=b;break}}}catch(t){g.e(t)}finally{g.f()}if(null===y)throw new Wt("<p>The test is not able to pass because you do not have a component named "+h[2]+" of type "+f+r+".</p>");n.push(y.ins[p])}else{if(0===v.length)throw new Wt("<p>The test is not able to pass because you do not have a component of type "+f+r+".</p>");if(v.length>1)throw new Wt("<p>The test is not able to pass because you have more than one  component of type "+f+r+".</p><p>You are only allowed one component of that type in this circuit.</p>");n.push(v[0].ins[p])}}else{var w=s.getComponentByNaming(l);if(!(null!==w&&w.ins.length>p))throw new Wt("<p>The test is not able to pass because you do not have a component named "+l+r+".</p><p>Output pins are labeled OUT in the palette. Double-click on an output pin to set the name. Pin names are case sensitive.</p>");n.push(w.ins[p])}}return n}(i)}catch(t){if(t instanceof Wt)return void o(t.msg);throw t}setTimeout((function h(){if(l>=0)for(var c=i.test[l],u=0;u<a.length&&u+r.length<c.length;u++){var d=c[u+r.length];if(null!=d&&"?"!==d){var p=!1,f=!1;if(e(d)){var v=!1;do{v=!1,"bitslop:"===d.substr(0,8)?(p=!0,d=d.substr(8),v=!0):"test:"===d.substr(0,5)&&(f=!0,d=d.substr(5),v=!0)}while(v)}if(f){var m,y=Yt(d.split(";"));try{for(y.s();!(m=y.n()).done;){var g=m.value;try{a[u].testAsString(g)}catch(t){return void(!0===g.quiet?o('<div class="cirsim-test-result"><p>This test is failing. Some output is not what is currently expected by the test. The circuit is left in the state it was in when the test failed. No additional detail will be provided about why the test is failed. It is your responsibility to create a circuit that works as expected.</p></div>'):o('<div class="cirsim-test-result"><p>This test is failing. '.concat(t,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>")))}}}catch(t){y.e(t)}finally{y.f()}}else{var b=new Xt;b.type=Xt.BINARY,b.setAsString(d);var w=a[u].getAsString(),x=!0;if(p)d=b.getAsInteger(),b.setAsBinary(w),("?"===(w=b.getAsInteger())||w<d-1||w>d+1)&&(x=!1);else if(e(d=b.getAsBinary())){for(var T=w.length-1,I=d.length-1;I>=0&&x;T--,I--)if("?"!==d.substr(I,1)){if(T<0){x=!1;break}w.substr(T,1)!=d.substr(I,1)&&(x=!1)}T>0&&(x=!1)}else null!==d&&"?"!==d&&(x=d==w);if(!x)return console.log("Test: "+l+" Output "+a[u].component.naming+" Actual: "+w+" Expected: "+d),void(!0===i.quiet?o('<div class="cirsim-test-result"><p>This test is failing. Some output is not what is currently expected by the test. The circuit is left in the state it was in when the test failed. No additional detail will be provided about why the test is failed. It is your responsibility to create a circuit that works as expected.</p></div>'):o('<div class="cirsim-test-result"><p>This test is failing. An output value is \nnot what is currently expected by the test. The circuit is left in the state it was \nin when the test failed.<p>\n<p class="cs-result">Output '.concat(a[u].component.naming," expected: ").concat(d," actual: ").concat(w,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>\n")))}}}if(++l<i.test.length){for(var S=i.test[l],k=0;k<r.length&&k<S.length;k++)if(null!==S[k]){var A=r[k].command(S[k]);if(null!==A){if(!A.ok)return void o("<p>This test is failing. "+A.msg+"</p>")}else try{r[k].setAsString(S[k])}catch(t){return void o('<div class="cirsim-test-result"><p>This test is failing. '.concat(t,'</p>\n<p class="cs-info">Test ').concat(l,"</p></div>"))}}for(var O=s.getSimulation(),C=0;C<100&&O.advance(.01*O.speed);C++);setTimeout(h,t.options.testTime),null!==O.view&&O.view.draw()}else n(i)}),t.options.testTime)}))}},Gt=function(t){var e=this;this.defaultDuration=2e3,this.interToastDelay=500;var i=[],n=!1,o=null;this.create=function(t){o=D.createClassedDiv("toast"),t.appendChild(o),o.innerHTML="testing"};var s=function t(){if(i.length>0&&!n){var s=i[0];i.splice(0,1),o.innerHTML=s.msg,o.classList.add("toast-active"),n=!0,setTimeout((function(){o.classList.remove("toast-active"),setTimeout((function(){n=!1,t()}),e.interToastDelay)}),s.time)}};this.message=function(t,e){void 0===e&&(e=this.defaultDuration),i.push({msg:t,time:e}),s()},this.jsonErrors=function(t){var e=this;return null!==t.errors()&&(t.errors().forEach((function(t){e.message("Server Error: "+t.title,5e3)})),!0)}},Jt=function(t){F.call(this),this.open=function(e){this.done=e;var i="<p>File "+t+" exists. Are you sure you want to overwrite?";this.contents(i,"Overwrite?"),F.prototype.open.call(this)},this.ok=function(){this.close(),this.done(!0)},this.cancel=function(){this.done(!1)}};(Jt.prototype=Object.create(F.prototype)).constructor=Jt;var Qt=function(t,e,i){var n=this;F.call(this);var o=this,s=e.getAPI("files"),r=null,a=null;this.filename="";var l=this.uniqueId(),h=this.uniqueId(),c="#"+l,u="#"+h;this.open=function(e){a=e;var i='<div class="control"><label for="'+h+'">'+(t?"Available":"Existing")+'</label><select class="files" id="'+h+'" name="'+h+'" size="5"></select><div class="notice">Querying Server...</div></div><div class="control"><label for="'+l+'">Name</label><input type="text" name="'+l+'" id="'+l+'" value="'+this.filename+'" spellcheck="false" class="text ui-widget-content ui-corner-all"></div>';t?this.contents(i,"File Open"):(i+="<p>Enter a name to save your circuit on the server as.</p>",this.contents(i,"File Save")),F.prototype.open.call(this);var n=document.getElementById(h),o=document.getElementById(l);n.addEventListener("click",(function(t){o.value=n.value})),o.select(),d(u,c),t||this.buttonOk().setAttribute("disabled","true")},this.ok=function(){var e=this,i=(document.getElementById(h),document.getElementById(l));if(this.filename=this.sanitize(i.value).replace(/^\s+|\s+$/gm,""),0===this.filename.length)return i.focus(),void this.error("Must supply a file name");if(!/^[0-9a-zA-Z\.\-\+ ]+$/.test(this.filename))return i.focus(),void this.error("Names can contain a-z, A-Z, 0-9, ., -, +, and space");((this.filename.length<8||".cirsim"!==this.filename.substr(this.filename.length-7,7))&&(this.filename+=".cirsim"),t)?this.read(this.filename,a):r.indexOf(this.filename)>=0?new Jt(this.filename).open((function(t){t&&e.write(e.filename,a)})):this.write(this.filename,a)};var d=function(){tt.do({url:s.url,data:Object.assign({cmd:"files"},s.extra),method:"GET",dataType:"json",success:function(t){var e=new Rt(t);if(i.jsonErrors(e))o.close();else{var s=e.getData("files"),a=document.getElementById(h),c=(document.getElementById(l),a.parentNode.querySelector(".notice"));null!==c&&c.parentNode.removeChild(c),r=[],s.attributes.forEach((function(t){var e=document.createElement("option");e.value=t.name,e.innerText=t.name,a.appendChild(e),r.push(t.name)})),n.buttonOk().removeAttribute("disabled")}},error:function(t,e,n){console.log(t.responseText),i.message("Unable to communicate with server: "+n),o.close()}})}};(Qt.prototype=Object.create(F.prototype)).constructor=Qt;var Kt=function(t,e,i,n){Qt.call(this,!1,i,n);var o=i.getAPI("save");this.write=function(e,i){var s=this;tt.do({url:o.url,data:Object.assign({cmd:"save",name:e,data:t},o.extra),method:"POST",dataType:"json",success:function(t){var o=new Rt(t);n.jsonErrors(o)||(s.close(),i(e))},error:function(t,e,i){console.log(t.responseText),n.message("Unable to communicate with server: "+i),s.close()}})}};(Kt.prototype=Object.create(Qt.prototype)).constructor=Kt;var $t=function(t,e){Qt.call(this,!0,t,e);var i=t.getAPI("open");this.read=function(t,n){var o=this;tt.do({url:i.url,data:Object.assign({cmd:"open",name:t},i.extra),method:"GET",dataType:"json",success:function(i){var s=new Rt(i);if(!e.jsonErrors(s)){var r=i.data[0].attributes.data;n(t,r),o.close()}},error:function(t,i,n){console.log(t.responseText),e.message("Unable to communicate with server: "+n),o.close()}})}};($t.prototype=Object.create(Qt.prototype)).constructor=$t;var _t=function(t,e,i,n,o){F.call(this);var s=this;this.buttonOk=null,this.open=function(){var e=this;this.contents("<p>Saving to server...</p>","Saving..."),F.prototype.open.call(this);var r=n.getAPI("save");tt.do({url:r.url,data:Object.assign({cmd:"save",name:i,data:t},r.extra),method:"POST",dataType:"json",success:function(t){var e=new Rt(t);o.jsonErrors(e)||s.close()},error:function(t,i,n){console.log(t.responseText),o.message("Unable to communicate with server: "+n),e.close()}})}};(_t.prototype=Object.create(F.prototype)).constructor=_t;var te=function(t,e,i){F.call(this),this.buttonOk=null,this.open=function(n){var o=this;this.contents("<p>Loading from server...</p>","Loading..."),F.prototype.open.call(this);var s=e.getAPI("open");null!==s&&tt.do({url:s.url,data:Object.assign({cmd:"open",name:t},s.extra),method:"GET",dataType:"json",success:function(e){var s=new Rt(e);if(!i.jsonErrors(s)){var r=e.data[0].attributes.data;n(t,r)}o.close()},error:function(t,e,n){i.message("Unable to communicate with server: "+n),o.close()}})}};(te.prototype=Object.create(F.prototype)).constructor=te;var ee=function(t){var e,i=this;this.home=function(){e.home()},this.url=function(t){e.present(t)},function(){e=new nt(t,i);var n=D.createClassedDiv("help-div");i.element=n,t.element.appendChild(n);var o='<div class="header"><h1>Cirsim Help</h1>\n<button type="button" class="help-back" title="Back">\n<span class="icons-cl icons-cl-arrowthick-1-w"></span></button>\n<button type="button" class="help-home" title="Home">\n<span class="icons-cl icons-cl-home"></span></button>\n<button type="button" class="help-close" title="Close">\n<span class="icons-cl icons-cl-closethick"></span></button>\n</div>\n'.concat(e.html());n.innerHTML=o,e.present("");var s=n.querySelector(".header");null!==s&&(s.querySelector("button.help-close").addEventListener("click",(function(e){e.preventDefault(),t.dockedHelp(!1)})),s.querySelector("button.help-home").addEventListener("click",(function(t){t.preventDefault(),e.home()})),s.querySelector("button.help-back").addEventListener("click",(function(t){t.preventDefault(),e.back()})))}()},ie=function(t){var e=null,i=null,n=[];this.draggable=function(t){t.element.addEventListener("mousedown",(function(e){e.preventDefault(),o(t),s(e.pageX,e.pageY)})),t.element.addEventListener("touchstart",(function(e){e.preventDefault(),o(t);var i=e.changedTouches[0];s(i.pageX,i.pageY)}))},this.droppable=function(t,e){n.push({view:t,callback:e})};var o=function(n){var o=n.paletteImage();t.element.appendChild(o),o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.zIndex=100,o.style.cursor="pointer",i=n,e=o},s=function(i,n){if(null!==e){var o=t.element.getBoundingClientRect(),s=o.left+t.element.scrollLeft+window.pageXOffset,r=o.top+t.element.scrollTop+window.pageYOffset;return e.style.left=i-s-e.clientWidth/2+"px",e.style.top=n-r-e.clientHeight/2+"px",!0}return!1},r=function(o,s){if(null!==e){for(var r=0,a=n;r<a.length;r++){var l=a[r],h=l.view.element;if("none"!==h.parentNode.style.display){var c=h.getBoundingClientRect(),u=c.left+h.scrollLeft+window.pageXOffset,d=c.top+h.scrollTop+window.pageYOffset;if(o>=u&&s>=d&&o<u+(c.right-c.left)&&s<d+(c.bottom-c.top)){l.callback(i,o-u,s-d);break}}}t.element.removeChild(e),e=null,i=null}};t.element.addEventListener("mousemove",(function(t){0!==t.which?s(t.pageX,t.pageY):r(t.pageX,t.pageY)})),t.element.addEventListener("touchmove",(function(t){var e=t.changedTouches[0];s(e.pageX,e.pageY)})),t.element.addEventListener("mouseup",(function(t){r(t.pageX,t.pageY)})),t.element.addEventListener("touchend",(function(t){var e=t.changedTouches[0];r(e.pageX,e.pageY)})),t.element.addEventListener("touchcancel",(function(t){var e=t.changedTouches[0];r(e.pageX,e.pageY)}))};function ne(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return oe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return oe(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var se=function(t,e,i){var n=this;this.cirsim=t,this.element=e,this.options=t.options,this.components=t.components,this.test=new Zt(this),this.div=null;var o,s=ne(i);try{for(s.s();!(o=s.n()).done;){var r=o.value;this.test.addTest(r)}}catch(t){s.e(t)}finally{s.f()}var a,l=ne(this.options.tests);try{for(l.s();!(a=l.n()).done;){var h=a.value;this.test.addTest(h)}}catch(t){l.e(t)}finally{l.f()}this.filename=null;var c=t.options,u=null,d=null,p=null,f=null,v=null,m=null;this.initialize=function(){var t=this;if("none"!==c.display){switch(D.addClass(e,"cirsim"),e.innerHTML="",c.display){case"full":D.addClass(e,"cirsim-full");break;case"inline":D.addClass(e,"cirsim-inline");break;default:D.addClass(e,"cirsim-window")}"window"===c.display&&(e.classList.contains("resizer")||new y.w(e,{handle:"10px solid #18453B"})),this.dragAndDrop=new ie(this);var i=new MutationObserver((function(){document.body.contains(e)||(i.disconnect(),t.model.kill())}));i.observe(document.body,{childList:!0})}for(var n in u=new Bt(this),this.model=u,this.options.tabs)this.model.circuits.add(new Ct(this.options.tabs[n]));if(null!==this.options.load&&u.fmJSON(this.options.load),"inline"!==c.display&&"none"!==c.display&&(this.div=D.createClassedDiv("main"),this.element.appendChild(this.div),this.help=new ee(this),f=new qt(this),this.tabs=f,d=new lt(this),this.menu=d,m=D.createClassedDiv("work"),this.div.appendChild(m),p=new yt(this,m),this.palette=p,f.create(m),v=D.createClassedDiv("cirsim-overlay"),this.div.appendChild(v),this.toast=new Gt(this),this.toast.create(this.div)),"inline"===c.display){var o=document.createElement("div");e.appendChild(o);var s=document.createElement("canvas");o.appendChild(s);var r=u.circuits.getCircuit("main"),a=new Mt(this,s,r,0);u.getSimulation().setView(a),v=D.createClassedDiv("cirsim-overlay"),e.appendChild(v),this.toast=new Gt(this),this.toast.create(this.element)}var l=this.options.getAPI("open");null!==l&&void 0!==l.url&&void 0!==l.name&&(this.filename=l.name,new te(l.name,this.options,this.toast).open((function(e,i){u.fmJSON(i),t.reload(),t.filename=e})))},this.addTest=function(t){this.test.addTest(t)},this.currentView=function(){return f.currentView()},this.newTab=function(){null!==p&&p.refresh(),u.newTab()},this.backup=function(){u.backup()},this.undo=function(){u.undo(),f.undo(),p.refresh()},this.modal=function(t){v.style.display=t?"block":"none"},this.open=function(){var t=this;new $t(this.options,this.toast).open((function(e,i){u.fmJSON(i),t.reload(),t.filename=e}))},this.save=function(t,e){var i=n.options.getAPI("save");if(null!==i)if(void 0===i.name){if(!0!==t)if(null===n.filename)n.saveAs();else{var o=u.toJSON();new _t(o,"application/json",n.filename,n.options,n.toast).open()}}else{var s=u.toJSON(),r=Object.assign({cmd:"save",name:i.name,data:s,type:"application/json"},i.extra);tt.do({url:i.url,data:r,method:"POST",dataType:"json",contentType:i.contentType,success:function(t){var i=new Rt(t);n.toast.jsonErrors(i)||!0!==e&&n.toast.message("Successfully saved to server")},error:function(t,e,i){console.log(t.responseText),n.toast.message("Unable to communicate with server: "+i)}})}},this.saveAs=function(){var t=this,e=u.toJSON(),i=new Kt(e,"application/json",this.options,this.toast);null!==this.filename&&(i.filename=this.filename),i.open((function(e){t.filename=e}))},this.export=function(){new Ft(u).open()},this.import=function(){new Ht(this,u).open()},this.importTab=function(){for(var t=0;t<this.options.imports.length;t++){var e=this.options.imports[t];if(e.into===this.currentView().circuit.name)return void this.currentView().importTab(e)}},this.reload=function(){f.destroy(),f.create(m,u)};var g=!1;this.isHelpDocked=function(){return g},this.dockedHelp=function(t){(g=t)?D.addClass(this.element,"docked-help"):D.removeClass(this.element,"docked-help")},this.load=function(t){u.fmJSON(t),this.reload()},this.initialize()};se.prototype.runTest=function(t){return this.test.runTest(t)};var re=function(t){for(var e in t=t||{},this.display="window",this.load=null,this.loadMenu=[],this.tabs=[],this.tabsMenu=!0,this.export="both",this.exportPNG=!1,this.testTime=17,this.userid=null,this.tests=[],this.imports=[],this.api=null,this.exit=null,this.global=null,this.components=["combinatorial","sequential"],this.always=["Zero","One","InPin","OutPin","Clock","Button","LED","Text"],this.showOutputStates=!1,t)if(t.hasOwnProperty(e)){if(!this.hasOwnProperty(e))throw new Error("Invalid option "+e);this[e]=t[e]}this.getAPI=function(t){if(null===this.api)return null;if(this.api===Object(this.api)){var e;if(void 0!==this.api[t]){var i=this.api[t];if(void 0===i.url)return null;e={url:i.url},void 0!==i.contentType?e.contentType=i.contentType:void 0!==this.api.contentType?e.contentType=this.api.contentType:e.contentType="application/x-www-form-urlencoded; charset=UTF-8",void 0!==i.extra?e.extra=i.extra:void 0!==this.api.extra?e.extra=this.api.extra:e.extra={},void 0!==i.name?e.name=i.name:void 0!==this.api.name&&(e.name=this.api.name)}else{if(void 0===this.api.url)return null;e={url:this.api.url},void 0!==this.api.extra?e.extra=this.api.extra:e.extra={},void 0!==this.api.name&&(e.name=this.api.name)}return e}return{url:this.api}}},ae=function(){this.components=[],this.palettes={},this.add=function(t){this.components.push(t),this.components.sort((function(t,e){return t.order-e.order}))},this.get=function(t){for(var e=0;e<this.components.length;e++)if(this.components[e].type===t)return this.components[e];return null},this.addPalette=function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(e[n].type);this.palettes[t]=i},this.getPalette=function(t){return this.palettes.hasOwnProperty(t)?this.palettes[t]:null}};var le=function(){Y.call(this),this.height=16,this.width=16,this.addOut(8,0,8),this.outs[0].set(!1)};(le.prototype=Object.create(Y.prototype)).constructor=le,le.prototype.prefix=null,le.type="Zero",le.label="0",le.desc="0 (false)",le.description="<h2>Zero</h2><p>A simple false value.</p>",le.order=0,le.help="zero",le.prototype.compute=function(t){this.outs[0].set(!1)},le.prototype.clone=function(){var t=new le;return t.copyFrom(this),t},le.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawText(t,"0",0,5,"14px Times"),this.drawIO(t,e)},le.paletteImage=function(){var t=new ht(60,30);return t.box(16,16),t.io(8,0,"e"),t.drawText("0",0,5,"14px Times"),t};var he=function(){Y.call(this),this.height=16,this.width=16,this.addOut(8,0,8),this.outs[0].set(!0)};(he.prototype=Object.create(Y.prototype)).constructor=he,he.prototype.prefix=null,he.type="One",he.label="1",he.desc="1 (true)",he.description="<h2>One</h2><p>A simple true value.</p>",he.order=1,he.help="one",he.prototype.compute=function(t){this.outs[0].set(!0)},he.prototype.clone=function(){var t=new he;return t.copyFrom(this),t},he.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawText(t,"1",0,5,"14px Times"),this.drawIO(t,e)},he.paletteImage=function(){var t=new ht(60,30);return t.box(16,16),t.io(8,0,"e"),t.drawText("1",0,5,"14px Times"),t};var ce=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-16,16),this.addIn(-32,16,16),this.addOut(32,0,16)};(ce.prototype=Object.create(Y.prototype)).constructor=ce,ce.type="And",ce.label="AND",ce.desc="AND gate",ce.order=11,ce.description="<h2>AND Gate</h2><p>The output of an AND gate is <em>true</em> if both inputs are true.</p>",ce.help="and",ce.prototype.compute=function(t){t[0]&&t[1]?this.outs[0].set(!0):!1===t[0]||!1===t[1]?this.outs[0].set(!1):this.outs[0].set(void 0)},ce.prototype.clone=function(){var t=new ce;return t.copyFrom(this),t},ce.prototype.draw=function(t,e){this.selectStyle(t,e),ce.path(t,this.x,this.y,this.width,this.height),ut.fillWith(t),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)},ce.path=function(t,e,i,n,o){var s=e-n/2-.5,r=e+n/2+.5,a=i-o/2-.5,l=i+o/2+.5;t.beginPath(),t.moveTo(s,l),t.lineTo(s,a),t.lineTo(r-o/2,a),t.arc(r-o/2,i,o/2+.5,-Math.PI/2,Math.PI/2),t.lineTo(s,l)},ce.paletteImageBase=function(){var t=new ht(120,70),e=t.context;e.lineWidth=1.5;var i=t.width/2,n=t.height/2,o=.5*t.width,s=(t.height,26.5),r=i-o/2-.5,a=i+o/2+.5,l=n-s+.5,h=n+s-.5;return this.leftX=r-t.width/2,this.rightX=a-t.width/2,e.beginPath(),e.moveTo(r,h),e.lineTo(r,l),e.lineTo(a-s,l),e.arc(a-s,n,s,-Math.PI/2,Math.PI/2),e.lineTo(r,h),t.fillStroke(),t.io(this.rightX,0,"e"),t},ce.paletteImage=function(){var t=ce.paletteImageBase();return t.io(this.leftX,-16,"w"),t.io(this.leftX,16,"w"),t};var ue=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(ue.prototype=Object.create(Y.prototype)).constructor=ue,ue.offsetX=40,ue.offsetY=30,ue.type="Or",ue.label="OR",ue.desc="OR gate",ue.order=20,ue.description="<h2>OR Gate</h2><p>The output of an OR gate is <em>true</em> \nif either or both inputs are true. Otherwise, it is false.</p>",ue.help="or",ue.prototype.compute=function(t){t[0]||t[1]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]?this.outs[0].set(void 0):this.outs[0].set(!1)},ue.prototype.clone=function(){var t=new ue;return t.copyFrom(this),t},ue.prototype.draw=function(t,e){this.selectStyle(t,e),ue.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},ue.draw=function(t,e,i,n,o){ue.path(t,e,i,n,o),ut.fillWith(t),t.stroke()},ue.path=function(t,e,i,n,o){var s=e-n/2-.5,r=i-o/2-.5,a=i+o/2+.5;t.beginPath();var l=ue.offsetX,h=Math.atan2(o/2,l),c=l/Math.cos(h);t.arc(s-l,i,c,-h,h);var u=(n/2*(n/2)-o/2*(o/2))/o;c=o/2+u,h=Math.atan2(u,n/2),t.lineTo(e,a),t.arc(e,i-u,c,Math.PI/2,h,!0),t.arc(e,i+u,c,-h,-Math.PI/2,!0),t.lineTo(s,r)},ue.paletteImageBase=function(){var t=new ht(120,70),e=t.context;e.lineWidth=1.5;var i=t.width/2,n=t.height/2,o=.5*t.width,s=.65*t.height,r=i-o/2-.5,a=i+o/2+.5,l=Math.round(n-s/2)-.5,h=Math.round(n+s/2)+.5;e.beginPath();var c=ue.offsetX,u=Math.atan2(s/2,c),d=c/Math.cos(u);e.arc(r-c,n,d,-u,u);var p=(o/2*(o/2)-s/2*(s/2))/s;return d=s/2+p,u=Math.atan2(p,o/2),this.leftX=r-t.width/2+3,this.rightX=a-t.width/2,e.lineTo(i,h),e.arc(i,n-p,d,Math.PI/2,u,!0),e.arc(i,n+p,d,-u,-Math.PI/2,!0),e.lineTo(r,l),t.fillStroke(),t.io(this.rightX,0,"e"),t},ue.paletteImage=function(){var t=ue.paletteImageBase();return t.io(this.leftX,-16,"w"),t.io(this.leftX,16,"w"),t};var de=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e,s=Math.sqrt(n*n-4)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+s,0,16+s),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(de.prototype=Object.create(Y.prototype)).constructor=de,de.offsetX=40,de.offsetY=30,de.type="Or3",de.label="OR",de.desc="OR gate",de.order=21,de.description="<h2>OR Gate</h2><p>The output of a three-input OR gate is <em>true</em> if any of of the inputs are true. Otherwise, it is false.</p>",de.prototype.compute=function(t){t[0]||t[1]||t[2]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]?this.outs[0].set(void 0):this.outs[0].set(!1)},de.prototype.clone=function(){var t=new de;return t.copyFrom(this),t},de.prototype.draw=function(t,e){this.selectStyle(t,e),ue.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},de.paletteImage=function(){var t=ue.paletteImageBase();return t.io(ue.leftX,-16,"w"),t.io(ue.leftX,0,"w"),t.io(ue.leftX,16,"w"),t};var pe=function t(){Y.call(this),this.height=64,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-64)-e,s=Math.sqrt(n*n-576)-e;this.addIn(-32+s,-24,16+s),this.addIn(-32+o,-8,16+o),this.addIn(-32+o,8,16+o),this.addIn(-32+s,24,16+s),this.addOut(32,0,16)};(pe.prototype=Object.create(Y.prototype)).constructor=pe,pe.offsetX=40,pe.offsetY=30,pe.type="Or4",pe.label="OR",pe.desc="OR gate",pe.order=22,pe.description="<h2>OR Gate</h2><p>The output of a four-input OR gate is <em>true</em> if any of of the inputs are true. Otherwise, it is false.</p>",pe.prototype.compute=function(t){t[0]||t[1]||t[2]||t[3]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]||void 0===t[3]?this.outs[0].set(void 0):this.outs[0].set(!1)},pe.prototype.clone=function(){var t=new pe;return t.copyFrom(this),t},pe.prototype.draw=function(t,e){this.selectStyle(t,e),ue.draw(t,this.x,this.y,this.width,this.height),this.drawName(t,-2,5),this.drawIO(t,e)},pe.paletteImage=function(){var t=ue.paletteImageBase();return t.io(ue.leftX,-16,"w"),t.io(ue.leftX,-5.5,"w"),t.io(ue.leftX,5.5,"w"),t.io(ue.leftX,16,"w"),t};var fe=function(){ue.call(this,name),this.outs=[],this.addOutInv(32,0,16)};(fe.prototype=Object.create(ue.prototype)).constructor=fe,fe.type="Nor",fe.label="NOR",fe.desc="NOR gate",fe.img="nor.png",fe.order=30,fe.description="<h2>NOR Gate</h2><p>The output of a NOR gate is <em>false</em> if either or both \n inputs are true. Otherwise, it is true.</p>",fe.help="nor",fe.prototype.clone=function(){var t=new fe;return t.copyFrom(this),t};var ve=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-16,16),this.addIn(-32,0,16),this.addIn(-32,16,16),this.addOut(32,0,16)};(ve.prototype=Object.create(Y.prototype)).constructor=ve,ve.type="And3",ve.label="AND",ve.desc="3-Input AND gate",ve.order=12,ve.description="<h2>AND Gate</h2><p>The output of a three-input AND gate is <em>true</em> if all three inputs are true.</p>",ve.help="and3",ve.prototype.compute=function(t){t[0]&&t[1]&&t[2]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]?this.outs[0].set(void 0):this.outs[0].set(!1)},ve.prototype.clone=function(){var t=new ve;return t.copyFrom(this),t},ve.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,s),t.moveTo(i,o),t.lineTo(n-this.height/2,o),t.moveTo(i,s),t.lineTo(n-this.height/2,s),t.stroke(),t.beginPath(),t.arc(n-this.height/2,this.y,this.height/2+.5,-Math.PI/2,Math.PI/2),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),this.drawIO(t,e)},ve.paletteImage=function(){var t=ce.paletteImageBase();return t.io(ce.leftX,-16,"w"),t.io(ce.leftX,0,"w"),t.io(ce.leftX,16,"w"),t};var me=function(){Y.call(this),this.height=50,this.width=64,this.addIn(-32,-24,16),this.addIn(-32,-8,16),this.addIn(-32,8,16),this.addIn(-32,24,16),this.addOut(32,0,16)};(me.prototype=Object.create(Y.prototype)).constructor=me,me.type="And4",me.label="AND",me.desc="4-Input AND gate",me.order=13,me.description="<h2>AND Gate</h2><p>The output of a four-input AND gate is <em>true</em> if all four inputs are true.</p>",me.help="and4",me.prototype.compute=function(t){t[0]&&t[1]&&t[2]&&t[3]?this.outs[0].set(!0):void 0===t[0]||void 0===t[1]||void 0===t[2]||void 0===t[3]?this.outs[0].set(void 0):this.outs[0].set(!1)},me.prototype.clone=function(){var t=new me;return t.copyFrom(this),t},me.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,s),t.moveTo(i,o),t.lineTo(n-this.height/2,o),t.moveTo(i,s),t.lineTo(n-this.height/2,s),t.stroke(),t.beginPath(),t.arc(n-this.height/2,this.y,this.height/2+.5,-Math.PI/2,Math.PI/2),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),this.drawIO(t,e)},me.paletteImage=function(){var t=ce.paletteImageBase();t.height;return t.io(ce.leftX,-24,"w"),t.io(ce.leftX,-8,"w"),t.io(ce.leftX,8,"w"),t.io(ce.leftX,24,"w"),t};var ye=function(){ce.call(this,name),this.outs=[],this.addOutInv(32,0,16)};(ye.prototype=Object.create(ce.prototype)).constructor=ye,ye.type="Nand",ye.label="NAND",ye.desc="NAND gate",ye.order=16,ye.description="<h2>NAND Gate</h2><p>The output of a NAND gate is <em>false</em> if and only if both inputs are true.</p>",ye.help="nand",ye.prototype.clone=function(){var t=new ye;return t.copyFrom(this),t},ye.paletteImage=function(){var t=ce.paletteImageBase();return t.io(ce.leftX,-16,"w"),t.io(ce.leftX,16,"w"),t.io(ce.rightX+10,0,"e"),t.circle(ce.rightX+5,0,5),t};var ge=function(t,e,i,n){this.x=t,this.y=e,this.color="undefined",void 0===n?(this.radius=i,this.width=2*i,this.height=2*i):(this.radius=null,this.width=i,this.height=n)};ge.colors={black:["#000000","#000000"],undefined:["#444444","#888888"],green:["#55ff88","#00fb4a"],red:["#ff4444","#ff0000"],blue:["#25ffff","#15ddff"],purple:["#c000ff","#8000ff"],yellow:["#ffff00","#ffff80"],none:["#000000","#000000"]},ge.prototype.draw=function(t,e,i,n){if("none"!==this.color){var o=t.fillStyle;void 0===n&&(n="white"),t.beginPath(),e+=this.x,i+=this.y;var s,r,a=1.15*this.radius;if(ge.colors.hasOwnProperty(this.color)?(s=ge.colors[this.color][0],r=ge.colors[this.color][1]):(s="#000000",r="#000000"),null!==this.radius){var l=t.createRadialGradient(e,i,1,e,i,a);l.addColorStop(0,s),l.addColorStop(.5,r),l.addColorStop(1,n),t.fillStyle=l}else{var h=t.createLinearGradient(0,i-this.height/2,0,i+this.height/2);h.addColorStop(0,n),h.addColorStop(.25,s),h.addColorStop(.75,s),h.addColorStop(1,n),t.fillStyle=h}t.fillRect(e-this.width/2,i-this.height/2,this.width,this.height),"undefined"===this.color&&(t.font="14px Times",t.fillStyle="#ffffff",t.fontWeight="bold",t.textAlign="center",t.fillText("?",e,i+5),t.fillText("?",e+1,i+5),t.fontWeight="normal"),t.fillStyle=o}},ge.prototype.touch=function(t,e,i,n){return t+=this.x,e+=this.y,w.distance({x:t,y:e},{x:i,y:n})<=this.radius},ge.colorSelector=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n='<div class="control1 center"><label for="'+t+'">Color: </label><select id="'+t+'">',o=ge.colors;for(var s in o)o.hasOwnProperty(s)&&"black"!==s&&"undefined"!==s&&(!0!==i&&"none"===s||(n+=s===e?"<option selected>"+s+"</option>":"<option>"+s+"</option>"));return n+="</select></div>"};var be=function(){Y.call(this),this.height=16,this.width=64,this.led=new ge(19,0,7),this.addOut(32,0,16),this.set(!1)};(be.prototype=Object.create(Y.prototype)).constructor=be,be.prototype.prefix="*I",be.prototype.nameRequired=!0,be.type="InPin",be.label="In Pin",be.desc="Input Pin",be.img="inpin.png",be.order=2,be.description="<h2>Input Pin</h2><p>An IN pin serves as input for a circuit. Clicking the LED toggles the output true or false.</p>",be.help="inpin",be.prototype.clone=function(){var t=new be;return t.value=this.value,t.copyFrom(this),t},be.prototype.compute=function(t){this.outs[0].set(this.value)},be.prototype.draw=function(t,e){var i=this.value?"white":"#dddddd";this.outlinePath(t),t.fillStyle=i,t.fill(),this.led.color=this.value?"green":"off",this.led.draw(t,this.x,this.y,i),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.beginPath(),t.font="14px Times",t.textAlign="center";var n=this.value?"1":"0",o=this.x-9;null!==this.naming?t.fillText(this.naming+": "+n,o,this.y+5):t.fillText(n,o,this.y+5),this.drawIO(t,e)},be.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,n),t.lineTo(e,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e,n)},be.prototype.touch=function(t,e){return this.led.touch(this.x,this.y,t,e)?(this.circuit.circuits.model.backup(),this.set(!this.value),null):Y.prototype.touch.call(this,t,e)},be.prototype.set=function(t){"string"==typeof t||t instanceof String?this.setAsString(t):(this.value=t,this.outs[0].set(t))},be.prototype.setAsString=function(t){switch(t){case void 0:case"undefined":case"?":this.set(void 0);break;case"false":case"0":case!1:this.set(!1);break;case"true":case"1":case!0:this.set(!0);break;default:var e=1==+t;this.set(e)}},be.prototype.get=function(){return this.value},be.prototype.save=function(){var t=Y.prototype.save.call(this);return t.value=this.value,t},be.prototype.load=function(t){this.set(t.value),Y.prototype.load.call(this,t)},be.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control center"><div class="choosers"><label><input type="radio" id="'+n+'" value="1" name="'+n+'"'+(this.value?" checked":"")+'> true (1)</label><label><input type="radio" id="'+n+'" value="0" name="'+n+'"'+(this.value?"":" checked")+"> false (0)</label></div></div>";i.extra(o,(function(){return null}),(function(){e.set("1"===document.querySelector("#"+n+":checked").value)})),i.open()};var we=function(){Y.call(this),this.height=16,this.width=64,this.color="green",this.led=new ge(-19,0,7),this.addIn(-32,0,16)};(we.prototype=Object.create(Y.prototype)).constructor=we,we.prototype.prefix="O",we.prototype.nameRequired=!0,we.type="OutPin",we.label="Out Pin",we.desc="Output Pin",we.img="outpin.png",we.order=3,we.description="<h2>Ouput Pin</h2><p>An OUT pin serves as output \nfor a circuit. The LED indicates if the input is true (led illuminated), false \n(black), or undefined (?).</p>",we.help="outpin",we.prototype.pending=function(){},we.prototype.get=function(){return this.ins[0].value},we.prototype.getAsString=function(){switch(this.ins[0]){case!0:return"1";case!1:return"0";default:return"?"}},we.prototype.getAsValue=function(){return new Xt(this.ins[0].value)},we.prototype.clone=function(){var t=new we;return t.color=this.color,t.copyFrom(this),t},we.prototype.load=function(t){void 0!==t.color&&(this.color=gt.sanitize(t.color)),Y.prototype.load.call(this,t)},we.prototype.save=function(){var t=Y.prototype.save.call(this);return"green"!==this.color&&(t.color=this.color),t},we.prototype.draw=function(t,e){var i=this.get(),n=this.value?"white":"#dddddd";if(this.outlinePath(t),t.fillStyle=n,t.fill(),"none"!==this.color&&(this.led.color=void 0===i?"undefined":i?this.color:"off",this.led.draw(t,this.x,this.y,n)),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.beginPath(),t.font="14px Times",t.textAlign="center","none"!==this.color){var o=void 0===i?"?":i?"1":"0",s=this.x+9;null!==this.naming?t.fillText(this.naming+": "+o,s,this.y+5):t.fillText(o,s,this.y+5)}else{var r=this.x+4;null!==this.naming&&t.fillText(this.naming,r,this.y+5)}this.drawIO(t,e)},we.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},we.prototype.properties=function(t){var e=this,i=new H(this,t),n='<div class="control1 center">',o=i.uniqueId();n+=ge.colorSelector(o,this.color,!0),n+="</div>",i.extra(n,(function(){return null}),(function(){e.color=gt.sanitize(document.getElementById(o).value)})),i.open()};var xe=function(){Y.call(this),this.height=44,this.width=44,this.freq=1e6,this.period=.5,this.addOut(22,0,10),this.set(!0),this.remaining=1/this.freq*this.period};(xe.prototype=Object.create(Y.prototype)).constructor=xe,xe.prototype.prefix="C",xe.type="Clock",xe.label="Clock",xe.desc="Clock",xe.img="clock.png",xe.order=104,xe.description="<h2>Clock</h2><p>A clock generates a sequence of pulses over time. The duty cycle is the width of the true period of the pulse as a percentage.</p>",xe.prototype.clone=function(){var t=new xe;return t.freq=this.freq,t.period=this.period,t.value=this.value,t.remaining=this.remaining,t.copyFrom(this),t},xe.prototype.advance=function(t){return this.remaining-=t,this.remaining<=0&&(this.set(!this.value),this.remaining=1/this.freq*(this.value?this.period:1-this.period),!0)},xe.prototype.set=function(t){this.value=t,this.outs[0].set(t)},xe.prototype.get=function(){return this.value},xe.prototype.compute=function(t){this.set(!1)},xe.prototype.load=function(t){this.freq=t.freq,this.period=t.period,Y.prototype.load.call(this,t)},xe.prototype.save=function(){var t=Y.prototype.save.call(this);return t.freq=this.freq,t.period=this.period,t},xe.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x,n=this.y;t.beginPath(),t.arc(i,n,this.width/2,0,2*Math.PI),t.fillStyle="#ffffff",t.fill(),t.beginPath(),t.arc(i,n,this.width/2,0,2*Math.PI),t.stroke();var o=this.x-15.5,s=this.x+15.5,r=this.y-10.4,a=this.y+10.5,l=o+this.period*(s-o),h=t.strokeStyle;t.strokeStyle="#00aa00",t.beginPath(),t.moveTo(o,a),t.lineTo(o,r),t.lineTo(l,r),t.lineTo(l,a),t.lineTo(s,a),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-2,this.y+5)),t.stroke(),t.strokeStyle=h,this.drawIO(t,e)},xe.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),s='<div class="control"><label for="'.concat(n,'">Frequency (Hz)</label>\n<input type="text" id="').concat(n,'" value="').concat(this.freq,'"></div>\n<div class="control slider"><label for="').concat(o,'">Duty Cycle</label>\n<input type="range" min="100" max="900" class="" value="').concat(1e3*this.period,'" id="').concat(o,'">\n</div>');i.extra(s,(function(){var t=document.getElementById(n).value;return+t!==parseInt(t)||t<1||t>1e7?"Frequency must be integer 1 to 1000000":null}),(function(){e.freq=document.getElementById(n).value,e.period=.001*document.getElementById(o).value})),i.open()};var Te=function(){Y.call(this),this.height=50,this.width=40,this.addIn(-20,0,12),this.addOutInv(20,0,12)};(Te.prototype=Object.create(Y.prototype)).constructor=Te,Te.type="Inverter",Te.label="Inverter",Te.desc="Inverter gate",Te.order=50,Te.description="<h2>Inverter</h2><p>The output of an Inverter gate is <em>true</em> if the \n input is false and <em>false</em> if the input is true.</p>",Te.help="inverter",Te.prototype.compute=function(t){this.outs[0].set(t[0])},Te.prototype.clone=function(){var t=new Te;return t.copyFrom(this),t},Te.prototype.draw=function(t,e){this.selectStyle(t,e),Te.path(t,this.x,this.y,this.width,this.height),ut.fillWith(t),Te.path(t,this.x,this.y,this.width,this.height),t.stroke(),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-6,this.y+5),t.stroke()),this.drawIO(t,e)},Te.path=function(t,e,i,n,o){var s=e-n/2-.5,r=e+n/2+.5,a=i-o/2-.5,l=i+o/2+.5;t.beginPath(),t.moveTo(s,a),t.lineTo(s,l),t.lineTo(r,i),t.lineTo(s,a)},Te.paletteImage=function(){var t=new ht(120,70);return Te.path(t.context,60,35,40,50),t.fillStroke(),t.io(-20,0,"w"),t.io(30,0,"e"),t.circle(25,0,5),t};var Ie=function(){Y.call(this),this.height=32,this.width=32,this.value=void 0,this.led=new ge(0,0,12),this.color="blue",this.addIn(-16,0,16)};(Ie.prototype=Object.create(Y.prototype)).constructor=Ie,Ie.prototype.prefix="L",Ie.prototype.nameRequired=!0,Ie.type="LED",Ie.label="LED",Ie.desc="Light Emitting Diode",Ie.img="led.png",Ie.order=102,Ie.description="<h2>LED</h2><p>An LED indicates if the input is true (color), false (black), or undefined (?). The LED color can be set using the component properties dialog box.</p>",Ie.prototype.compute=function(t){this.value=t[0]},Ie.prototype.get=function(){return this.ins[0].value},Ie.prototype.clone=function(){var t=new Ie;return t.color=this.color,t.value=this.value,t.copyFrom(this),t},Ie.prototype.draw=function(t,e){var i=this.get(),n=this.x-this.width/2-.5,o=this.y-this.height/2+.5;this.selectStyle(t,e);var s=t.fillStyle,r=t.strokeStyle,a=i?"#ffffff":"#dddddd";t.fillStyle=a,t.fillRect(n,o,this.width,this.height),t.fillStyle=s,t.beginPath(),t.rect(n,o,this.width,this.height),t.stroke(),t.lineWidth=1,t.fillStyle=s,t.strokeStyle=r,this.led.color=void 0===i?"undefined":i?this.color:"off",this.led.draw(t,this.x-.5,this.y,a);var l=12;t.fillRect(this.x-l-2,this.y-l,2,2),t.fillRect(this.x+l-2,this.y-l,2,2),t.fillRect(this.x-l-2,this.y+l,2,2),t.fillRect(this.x+l-2,this.y+l,2,2),this.drawIO(t,e)},Ie.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},Ie.prototype.load=function(t){this.color=gt.sanitize(t.color),Y.prototype.load.call(this,t)},Ie.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},Ie.prototype.properties=function(t){var e=this,i=new H(this,t,!1),n=i.uniqueId(),o=ge.colorSelector(n,this.color);i.extra(o,(function(){return null}),(function(){e.color=gt.sanitize(document.getElementById(n).value)})),i.open()};var Se=function t(){Y.call(this),this.height=50,this.width=64;var e=t.offsetX,i=Math.atan2(this.height/2,e),n=e/Math.cos(i),o=Math.sqrt(n*n-256)-e;this.addIn(-32+o,-16,16+o),this.addIn(-32+o,16,16+o),this.addOut(32,0,16)};(Se.prototype=Object.create(Y.prototype)).constructor=Se,Se.offsetX=40,Se.offsetY=30,Se.offsetX1=6,Se.type="Xor",Se.label="XOR",Se.desc="XOR gate",Se.img="xor.png",Se.order=40,Se.description="<h2>XOR Gate</h2><p>The output of an XOR gate is <em>true</em> if the state of the inputs differ. Otherwise, it is false.</p>",Se.help="xor",Se.prototype.compute=function(t){void 0===t[0]||void 0===t[1]?this.outs[0].set(void 0):this.outs[0].set(t[0]&&!t[1]||!t[0]&&t[1])},Se.prototype.clone=function(){var t=new Se;return t.copyFrom(this),t},Se.prototype.draw=function(t,e){this.selectStyle(t,e),ue.draw(t,this.x,this.y,this.width,this.height),t.beginPath();var i=this.x-this.width/2-.5,n=Se.offsetX,o=Math.atan2(this.height/2,n),s=n/Math.cos(o);t.arc(i-n-Se.offsetX1,this.y,s,-o,o),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)};var ke=function(){Y.call(this),this.height=16,this.width=96,this.narrow=!1,this.value=new Xt,this.addOut(48,0,16).bus=!0,this.set([!1,!1,!1,!1])};(ke.prototype=Object.create(Y.prototype)).constructor=ke,ke.prototype.prefix="I",ke.prototype.nameRequired=!0,ke.type="InPinBus",ke.label="Bus Input",ke.desc="Bus Input Pin",ke.img="inpinbus.png",ke.order=300,ke.description="<h2>Bus Input Pin</h2><p>A Bus Input pin serves as input for a circuit from a bus. Double-click to set the value.</p><p>Values can be preceeded by 0x or 0b for hexadecimal or binary values.</p><p>The display and input format is selectable. Auto format will display values with eight or fewer digits as binary and larger values in hex.</p>",ke.help="inpinbus",ke.prototype.clone=function(){var t=new ke;return t.copyFrom(this),t.value=this.value.clone(),t},ke.prototype.compute=function(t){this.outs[0].set(this.value.get())},ke.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke();var i=this.x;this.narrow&&(i=this.x-this.height/4+1),this.value.draw(t,i,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},ke.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,n),t.lineTo(e,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e,n)},ke.prototype.set=function(t){Array.isArray(t)?this.value.set(t):("string"==typeof t||t instanceof String)&&this.value.setAsString(t),this.outs[0].set(this.value.get())},ke.prototype.get=function(){return this.value.get()},ke.prototype.setAsString=function(t,e){this.value.setAsString(t,e),e||this.outs[0].set(this.value.get())},ke.prototype.getAsString=function(){return this.value.getAsString()},ke.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),this.narrow&&(t.narrow=this.narrow),t},ke.prototype.load=function(t){this.value.load(t),this.setNarrow(gt.boolean(t.narrow)),Y.prototype.load.call(this,t)},ke.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=this.value.dialogContent(i,!0),s=o.html+'<input type="checkbox" id="'.concat(n,'" name="').concat(n,'"').concat(this.narrow?" checked":"",'> <label for="').concat(n,'">Narrow</label>');i.extra(s,o.validate,(function(){o.accept(),e.setNarrow(document.getElementById(n).checked),e.compute(null)})),i.open()},ke.prototype.setNarrow=function(t){this.narrow=t,this.width=t?48:96,this.outs[0].x=this.width/2};var Ae=function(){Y.call(this),this.value=new Xt,this.narrow=!1,this.height=16,this.width=96,this.addIn(-this.width/2,0,16).bus=!0};(Ae.prototype=Object.create(Y.prototype)).constructor=Ae,Ae.prototype.prefix="O",Ae.prototype.nameRequired=!0,Ae.type="OutPinBus",Ae.label="Bus Output",Ae.desc="Bus Output Pin",Ae.img="outpinbus.png",Ae.order=302,Ae.description="<h2>Bus Output Pin</h2>\n<p>An Bus Out pin serves as output for a bus in a circuit.</p>\n<p>The output format is selectable. Auto format will display values \nwith eight or fewer digits as binary and larger values in hex.</p>",Ae.help="outpinbus",Ae.prototype.compute=function(t){this.value.set(t[0])},Ae.prototype.get=function(){return this.value.get()},Ae.prototype.getAsString=function(){return this.value.getAsString()},Ae.prototype.getAsValue=function(){return new Xt(this.value)},Ae.prototype.clone=function(){var t=new Ae;return t.copyFrom(this),t.value=this.value.clone(),t},Ae.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),this.narrow&&(t.narrow=this.narrow),t},Ae.prototype.load=function(t){this.value.load(t),this.setNarrow(gt.boolean(t.narrow)),Y.prototype.load.call(this,t)},Ae.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke();var i=this.x+this.height/4;this.narrow&&(i-=2),this.value.draw(t,i,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},Ae.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(e+this.height/2,n),t.lineTo(e,this.y)},Ae.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=this.value.dialogContent(i),s=o.html+'<input type="checkbox" id="'.concat(n,'" name="').concat(n,'"').concat(this.narrow?" checked":"",'> <label for="').concat(n,'">Narrow</label>');i.extra(s,o.validate,(function(){o.accept(),e.setNarrow(document.getElementById(n).checked)})),i.open()},Ae.prototype.setNarrow=function(t){this.narrow=t,this.width=t?48:96,this.ins[0].x=-this.width/2};var Oe=function(){Y.call(this),this.height=16,this.width=96,this.value=new Xt,this.addOut(48,0,16).bus=!0,this.set([!1,!1,!1,!1])};(Oe.prototype=Object.create(Y.prototype)).constructor=Oe,Oe.prototype.prefix=null,Oe.type="BusConstant",Oe.label="Bus Constant",Oe.desc="Bus Constant value",Oe.img="busconstant.png",Oe.description="<h2>Bus Constant Value</h2><p>A Bus Constant is a value that can be set in the circuit as a fixed value feeding a bus.</p><p>Values can be preceeded by 0x or 0b for hexadecimal or binary values.</p><p>The display and input format is selectable. Auto format will display values with eight or fewer digits as binary and larger values in hex.</p>",Oe.order=301,Oe.prototype.clone=function(){var t=new Oe;return t.copyFrom(this),t.value=this.value.clone(),t},Oe.prototype.compute=function(t){this.outs[0].set(this.value.get())},Oe.prototype.draw=function(t,e){this.drawBox(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.drawBox(t),this.value.draw(t,this.x,this.y,this.width-this.height/2,this.naming),this.drawIO(t,e)},Oe.prototype.set=function(t){this.value.set(t),this.outs[0].set(this.value.get())},Oe.prototype.get=function(){return this.value.get()},Oe.prototype.setAsString=function(t,e){this.value.setAsString(t,e),e||this.outs[0].set(this.value.get())},Oe.prototype.getAsString=function(){return this.value.getAsString()},Oe.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),t},Oe.prototype.load=function(t){this.value.load(t),Y.prototype.load.call(this,t)},Oe.prototype.properties=function(t){var e=this,i=new H(this,t);this.value.dialogOptions(i,!0,(function(){e.compute(null)})),i.open()};var Ce=function(){Y.call(this),this.height=50,this.width=80,this.size=4,this.addOut(this.width/2,0,16).bus=!0,this.ensureIO()};(Ce.prototype=Object.create(Y.prototype)).constructor=Ce,Ce.type="BusOr",Ce.label="Bus OR",Ce.desc="Bus OR gate",Ce.img="busor.png",Ce.description="<h2>Bus OR Gate</h2><p>The output of an OR gate is <em>true</em> \nif either or both  inputs are true. Otherwise, it is false. This version works for \nbuses. The size determines the number of inputs.</p>",Ce.order=308,Ce.prototype.compute=function(t){var e=[];t.forEach((function(t){if(Array.isArray(t))for(var i=0;i<t.length;i++){var n=t[i];e.length>i?!0===n&&(e[i]=!0):e.push(n)}})),this.outs[0].set(e)},Ce.prototype.clone=function(){var t=new Ce;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},Ce.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},Ce.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},Ce.prototype.ensureIO=function(){this.height=16*this.size+8,this.height<50&&(this.height=50);for(var t=this.size/2*16-8,e=0;e<this.size;e++){var i=30*this.size,n=Math.atan2(this.height/2,i),o=i/Math.cos(n),s=t-16*e,r=Math.sqrt(o*o-s*s)-i;e<this.ins.length?(this.ins[e].x=-this.width/2+r,this.ins[e].y=s,this.ins[e].len=16+r,this.ins[e].bus=!0):this.addIn(-this.width/2+r,t-16*e,16+r).bus=!0}for(;e<this.size;e++);if(e<this.ins.length){for(;e<this.ins.length;e++)this.ins[e].clear();this.ins.splice(this.size)}},Ce.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.height,n=this.width,o=this.x-n/2-.5,s=(this.x,this.y-i/2-.5),r=this.y+i/2+.5;t.beginPath();var a=30*this.size,l=Math.atan2(i/2,a),h=a/Math.cos(l);t.arc(o-a,this.y,h,-l,l);var c=(n/2*(n/2)-i/2*(i/2))/i;h=i/2+c,l=Math.atan2(c,n/2),t.moveTo(o,s),t.lineTo(this.x-this.width/4,s),t.bezierCurveTo(this.x+this.width/4,s,this.x+3*this.width/8,this.y-this.height/4,this.x+this.width/2,this.y),t.moveTo(o,r),t.lineTo(this.x-this.width/4,r),t.bezierCurveTo(this.x+this.width/4,r,this.x+3*this.width/8,this.y+this.height/4,this.x+this.width/2,this.y),t.stroke(),this.drawName(t,-2,5),this.drawIO(t,e)},Ce.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO()})),i.open()};var Ee=function(){Y.call(this),this.height=100,this.width=52,this.value=null;var t=!0;Object.defineProperty(this,"bus",{get:function(){return t},set:function(e){if(t!==e){if(this.ins[0].bus!==e){for(var i=0;i<this.ins.length;i++)this.ins[i].clear();this.ins=[]}t=e,this.ensureIO()}}}),this.setSize(3),this.circuitOuts=[],this.ensureIO()};(Ee.prototype=Object.create(Y.prototype)).constructor=Ee,Ee.prototype.prefix="U",Ee.type="BusDecoder",Ee.label="Decoder",Ee.desc="Configurable Decoder",Ee.description="<h2>Decoder</h2>\n<p>The Decoder component converts a 2 to 4-bit binary value on <strong>In</strong> \nto a true on one of four to sixteen output lines. The number of outputs is determined \nby the bit size and is configurable.</p>",Ee.order=400,Ee.help="busdecoder",Ee.prototype.setSize=function(t){this.size=t,this.outputs=1;for(var e=0;e<t;e++)this.outputs*=2;this.ensureIO()},Ee.prototype.compute=function(t){if(this.bus)if(Array.isArray(t[0])){for(var e=0,i=1,n=0;n<t[0].length;n++)e+=t[0][n]?i:0,i*=2;this.set(e)}else this.set(null);else{for(var o=0,s=1,r=!1,a=0;a<t.length;a++){if(void 0===t[a]){r=!0;break}o+=t[a]?s:0,s*=2}this.set(r?null:o)}},Ee.prototype.set=function(t){if(null!=t){t&=this.outputs-1;for(var e=0;e<this.outputs;e++)this.outs[e].set(e==t)}else for(var i=0;i<this.outputs;i++)this.outs[i].set(void 0);this.value=t},Ee.prototype.clone=function(){var t=new Ee;return t.bus=this.bus,t.setSize(this.size),t.copyFrom(this),t},Ee.prototype.ensureIO=function(){var t,e=16,i=!1;if(this.height=this.outputs*e+26,this.height<80&&(this.height=80),this.ins.length>0&&this.ins[0].bus!==this.bus){for(t=0;t<this.ins.length;t++)this.ins[t].clear();this.ins=[]}if(this.bus)this.ins.length<1&&(this.addIn(-this.width/2,0,14,"In").bus=!0,i=!0);else{var n=this.size/2*e-8;for(t=0;t<this.size;t++){var o=n-t*e,s=null;t<this.ins.length?((s=this.ins[t]).x=-this.width/2,s.y=o,s.len=14):(i=!0,(s=this.addIn(-this.width/2,o,14,"I"+t)).orientation="w")}if(t<this.ins.length){for(;t<this.ins.length;t++)this.ins[t].clear();this.ins.splice(this.size)}}var r=this.width/2,a=this.outputs/2*e-8;for(t=0;t<this.outputs&&!(t>=this.outs.length);t++)this.outs[t].name="O"+t,this.outs[t].x=r,this.outs[t].y=a-t*e,this.outs[t].len=14;for(;t<this.outputs;t++)this.addOut(r,a-t*e,14,"O"+t),i=!0;if(t<this.outs.length){for(;t<this.outs.length;t++)this.outs[t].clear();this.outs.splice(this.outputs)}i&&this.set(this.value)},Ee.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5;this.y,this.height,this.y,this.height;if(this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText("decoder",this.x,this.y+this.height/2-2),null!==this.value&&this.value>=0&&this.value<this.outputs){var o=this.outs[this.value].y,s=this.value>=10?26:19;this.jaggedLine(t,i+15,this.y,n-s,this.y+o,.5)}this.drawName(t,0,-this.height/2+12),this.drawIO(t,e)},Ee.prototype.load=function(t){this.bus=!1!==t.bus,this.setSize(t.size),Y.prototype.load.call(this,t)},Ee.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.bus=this.bus,t},Ee.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size (bits): </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');o+='<div class="control center"><div class="choosers">';var s=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(s,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Input</label>\n<label><input type="radio" name="').concat(s,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Inputs</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>4?"Size must be an integer from 2 to 4":null}),(function(){e.setSize(document.getElementById(n).value),e.bus="1"===document.querySelector("input[name=".concat(s,"]:checked")).value})),i.open()},Ee.paletteImage=function(){var t=new ht(60,44);return t.box(20,42),t.io(10,-17.5,"e",8,5),t.io(-10,0,"w"),t.drawText("Decoder",0,20,"4px Times"),t};var ze=function(){Y.call(this),this.height=16,this.width=96,this.from=0,this.to=1,this.addIn(-48,0,16).bus=!0,this.addOut(48,0,16).bus=!0};(ze.prototype=Object.create(Y.prototype)).constructor=ze,ze.prototype.prefix=null,ze.type="BusSelector",ze.label="Bus Selector",ze.desc="Bus Subset Selector",ze.img="busselector.png",ze.description="<h2>Bus Selector</h2><p>A Bus Selector chooses some \nrange of bits from an input bus and feeds them to an output bus. This is a  tool \nto use to select fields from a bus.</p>\n<p>If configured as 4 to 8 (8:4 on the symbol), bits 4-8 becomes bits 0-4 on\nthe output bus. The output is a bus if more than one bit is selected and is a bit \nif only one bit is selected.</p>",ze.order=310,ze.help="busselector",ze.prototype.clone=function(){var t=new ze;return t.copyFrom(this),t.from=this.from,t.to=this.to,t},ze.prototype.compute=function(t){if(void 0!==t[0])if(this.from==this.to)this.outs[0].set(t[0][this.from]);else{for(var e=[],i=this.from;i<=this.to;i++)e.push(t[0][i]);this.outs[0].set(e)}else this.outs[0].set(void 0)},ze.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#dddddd",t.fill(),this.selectStyle(t,e),this.outlinePath(t),t.stroke(),t.font="14px Times",t.textAlign="center",t.fillText(this.to+":"+this.from,this.x,this.y+5),this.drawIO(t,e)},ze.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e+this.height/2,n),t.lineTo(e,this.y),t.lineTo(e+this.height/2,o),t.lineTo(i-this.height/2,o),t.lineTo(i,this.y),t.lineTo(i-this.height/2,n),t.lineTo(e+this.height/2,n)},ze.prototype.save=function(){var t=Y.prototype.save.call(this);return t.from=this.from,t.to=this.to,t},ze.prototype.load=function(t){this.from=t.from,this.to=t.to,Y.prototype.load.call(this,t),this.ensureIO()},ze.prototype.ensureIO=function(){this.outs[0].bus=this.from!=this.to},ze.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),s='<div class="control1 center gap">\n<input class="number" type="text" name="'.concat(n,'" id="').concat(n,'" value="').concat(this.from,'" spellcheck="false" onfocus="this.select()"> \n<label for="').concat(o,'">to </label>\n<input class="number" type="text" name="').concat(o,'" id="').concat(o,'" value="').concat(this.to,'" spellcheck="false" onfocus="this.select()"></div>');i.extra(s,(function(){var t=document.getElementById(n).value,e=document.getElementById(o).value,i=parseInt(t),s=parseInt(e);return isNaN(i)||i<0||i>32?(document.getElementById(n).select(),"Invalid from value"):isNaN(s)||s<0||s>32?(document.getElementById(o).select(),"Invalid to value"):i>s?(document.getElementById(n).select(),"Invalid values, <em>from</em> must be less than or equal to <em>to</em>."):null}),(function(){var t=document.getElementById(n).value,i=document.getElementById(o).value;e.from=parseInt(t),e.to=parseInt(i),e.ensureIO(),e.pending()})),i.open()};var Be=function(){Y.call(this),this.height=80,this.width=32,this.size=2,this.lastIn=null,this.bus=!0,this.circuitIns=[],this.addOut(this.width/2,0,8,"O").bus=!0,this.addIn(0,-this.height/2+10,13,"").orientation="n",this.ensureIO()};(Be.prototype=Object.create(Y.prototype)).constructor=Be,Be.prototype.prefix=null,Be.prototype.indent=10,Be.type="Multiplexer",Be.label="Multiplexer",Be.desc="Multiplexer",Be.img="multiplexer.png",Be.description="<h2>Multiplexer</h2><p>Multiplexes 2 to 16 inputs to a single output. The \ninputs and outputs and can be configured as buses or single bits.</p>\n<p>The value of the input pin or bus determines which input is routed to O. The input will be a single\nbit if there are two choices (binary) or a bus if there are more than 2 choices. </p>",Be.order=402,Be.help="multiplexer",Be.prototype.compute=function(t){var e=t[0];if(void 0===e)return this.outs[0].set(void 0),void(this.lastIn=null);if(Array.isArray(e)){var i=0,n=1;e.forEach((function(t){t&&(i+=n),n*=2})),e=i}else e=e?1:0;e<=t.length?(this.outs[0].set(t[e+1]),this.lastIn=e):(this.outs[0].set(void 0),this.lastIn=null)},Be.prototype.clone=function(){var t=new Be;return t.size=this.size,t.bus=this.bus,t.ensureIO(),t.copyFrom(this),t},Be.prototype.load=function(t){this.size=t.size,this.bus=!1!==t.bus,this.ensureIO(),Y.prototype.load.call(this,t)},Be.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.bus=this.bus,t},Be.prototype.ensureIO=function(){if(this.bus!==this.outs[0].bus){for(this.outs[0].clear(),this.outs[0].bus=this.bus,n=1;n<this.ins.length;n++)this.ins[n].clear();this.ins.splice(1,this.ins.length-1)}this.height=16*this.size+16,this.height<48&&(this.height=48);var t=this.width/2,e=this.ins[0];e.x=0,e.y=-this.height/2+this.indent/2,e.bus=this.size>2;for(var i=this.size/2*16-8,n=0;n<this.size&&!(n>=this.ins.length-1);n++){var o=this.ins[n+1];o.name="I"+n,o.x=-t,o.y=i-16*n,o.len=8}for(;n<this.size;n++)this.addIn(-t,i-16*n,8,"I"+n).bus=this.bus;if(++n<this.ins.length){for(;n<this.ins.length;n++)this.ins[n].clear();this.ins.splice(this.size+1)}},Be.prototype.draw=function(t,e){if(this.selectStyle(t,e),this.drawTrap(t,0,this.indent),null!==this.lastIn){var i=this.x-4,n=this.x+4,o=this.y-1,s=this.y+this.size/2*16-10-16*this.lastIn;this.jaggedLine(t,i,s,n,o,.5)}this.drawIO(t,e)},Be.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'.concat(n,'">Number of inputs: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');o+='<div class="control center"><div class="choosers">';var s=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(s,'"  ').concat(this.bus?"checked":"",' value="1"> Bus</label>\n<label><input type="radio" name="').concat(s,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?(document.getElementById(n).select(),"Must be an integer from 2 to 16"):null}),(function(){e.size=parseInt(document.getElementById(n).value),e.bus="1"===document.querySelector("input[name=".concat(s,"]:checked")).value,e.ensureIO()})),i.open()};var Ne=function(){};Ne.draw=function(t,e,i,n,o){var s=t.fillStyle,r=t.strokeStyle;t.fillStyle="#dddddd",t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.fill(),t.strokeStyle="#000000",t.lineWidth=.5,t.beginPath(),t.arc(e,i,n,0,2*Math.PI);var a=Math.cos(o)*n,l=Math.sin(o)*n;t.moveTo(e-a,i-l),t.lineTo(e+a,i+l),t.stroke(),t.strokeStyle=r,t.fillStyle=s,t.lineWidth=1};var Le=function(){Y.call(this),this.height=50,this.width=50,this.buttonSize=40,this.value=!1,this.color="blue",this.addOut(this.width/2,0,48-this.width/2),this.set(!1)};(Le.prototype=Object.create(Y.prototype)).constructor=Le,Le.prototype.prefix="B",Le.type="Button",Le.label="Button",Le.desc="Push Button",Le.img="button.png",Le.order=100,Le.description="<h2>Push Button</h2><p>Clicking the button turns on the output (true), while releasing turns it off.</p>",Le.prototype.clone=function(){var t=new Le;return t.value=this.value,t.color=this.color,t.copyFrom(this),t},Le.prototype.compute=function(t){this.outs[0].set(this.value)},Le.prototype.load=function(t){this.color=void 0!==t.color?t.color:"blue",Y.prototype.load.call(this,t)},Le.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},Le.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.y-this.height/2+.5,o=t.fillStyle,s=t.strokeStyle;switch(t.fillStyle="#cccccc",t.fillRect(i,n,this.width,this.height),t.fillStyle=o,t.beginPath(),t.rect(i,n,this.width,this.height),t.stroke(),this.color){case"blue":default:var r=["#25ffff","#15ddff","#00d5d4"];break;case"green":r=["#25ff25","#15ff00","#00d500"]}if(this.value){var a=t.createRadialGradient(this.x,this.y,1,this.x,this.y,16);a.addColorStop(0,r[0]),a.addColorStop(.5,r[1]),a.addColorStop(1,r[2]),t.fillStyle=a}else t.fillStyle="#888888";t.beginPath(),t.arc(this.x,this.y,16,0,2*Math.PI),t.fill(),t.strokeStyle="#000000",t.beginPath(),t.arc(this.x,this.y,17,0,2*Math.PI),t.lineWidth=4,t.stroke(),t.lineWidth=1,t.fillStyle=o,t.strokeStyle=s;var l=18;Ne.draw(t,this.x-l,this.y-l,3,.3),Ne.draw(t,this.x-l,this.y+l,3,1.3),Ne.draw(t,this.x+l,this.y-l,3,2.3),Ne.draw(t,this.x+l,this.y+l,3,.7),this.drawIO(t,e)},Le.prototype.touch=function(t,e){return w.distance(new w(t,e),new w(this.x,this.y))<16?(this.set(!0),null):Y.prototype.touch.call(this,t,e)},Le.prototype.mouseUp=function(){this.set(!1)},Le.prototype.set=function(t){this.value=t,this.outs[0].set(t)},Le.prototype.setAsString=function(t){var e=1==+t;this.set(e)},Le.prototype.get=function(){return this.value},Le.prototype.properties=function(t){var e=this,i=this,n=new H(this,t,!1),o=n.uniqueId(),s='<div class="control1 center"><label for="'+o+'">Color: </label><select id="'+o+'">';["green","blue"].forEach((function(t){t===i.color?s+="<option selected>"+t+"</option>":s+="<option>"+t+"</option>"})),s+="</select></div>",n.extra(s,(function(){return null}),(function(){e.color=document.getElementById(o).value})),n.open()};var Pe=function(){Y.call(this),this.size=22,this.text="Text",this.color="black",this.height=this.size,this.width=2*this.size};(Pe.prototype=Object.create(Y.prototype)).constructor=Pe,Pe.prototype.prefix=null,Pe.type="Text",Pe.label="Text",Pe.desc="Arbitrary Text",Pe.img="text.png",Pe.order=106,Pe.description="<h2>Text</h2><p>Arbitrary text for diagrams. Allows for notations that help\ndescribe parts of diagrams. The text size in pixels can be specified, as can the colors from a \nlimited palette.</p><p>The color selection is overridden by the selection color (red) when the \ntext component is selected.</p>",Pe.help="text",Pe.prototype.clone=function(){var t=new Pe;return t.copyFrom(this),t.text=this.text,t.size=this.size,t},Pe.prototype.draw=function(t,e){var i=this.selectStyle(t,e),n=this.text.replace(/&lt;/g,"<");if(n=(n=n.replace(/&gt;/g,">")).replace(/&amp;/g,"&"),t.font=this.size+"px Times",t.textAlign="center",i)t.fillText(n,this.x-1,this.y+5);else{var o;switch(this.color){default:o=this.color;break;case"green":o="#008000";break;case"pink":o="#FF69B4"}ut.fillTextWith(t,n,this.x-1,this.y+5,o)}this.height=this.size,this.width=t.measureText(n).width,this.drawIO(t,e)},Pe.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),s=i.uniqueId(),r='<div class="control">\n<label for="'.concat(n,'">Text: </label>\n<input type="text" id="').concat(n,'" value="').concat(this.text,'">\n</div>\n<div class="control1 center"><label for="').concat(o,'">Size: </label>\n<input class="number" type="text" id="').concat(o,'" value="').concat(this.size,'"></div>');r+='<div class="control1 center"><label for="'+s+'">Color: </label><select id="'+s+'">';var a=["black","green","blue","purple","orange","maroon","pink"];for(var l in a){var h=a[l];h===this.color?r+="<option selected>"+h+"</option>":r+="<option>"+h+"</option>"}r+="</select></div>",i.extra(r,(function(){var t=parseInt(document.getElementById(o).value);return isNaN(t)||t<10||t>55?"Size must be an integer between 10 and 55":gt.htmlentities(document.getElementById(n).value).length<1?"Text cannot be empty":null}),(function(){e.text=gt.htmlentities(document.getElementById(n).value),e.size=parseInt(document.getElementById(o).value),e.color=gt.sanitize(document.getElementById(s).value)})),i.open(),document.getElementById(n).select()},Pe.prototype.save=function(){var t=Y.prototype.save.call(this);return t.text=this.text.replace(/'/g,"`"),t.size=this.size,"black"!==this.color&&(t.color=this.color),t},Pe.prototype.load=function(t){this.text=gt.sanitize(t.text.replace(/`/g,"'")),this.size=+t.size,void 0!==t.color&&(this.color=gt.sanitize(t.color)),Y.prototype.load.call(this,t)};var Re=function(){Y.call(this),this.height=176,this.width=128;var t=this.width/2,e=this.height/2;this.values=[0,0,0,0,0,0,0,0],this.lastClk=!1,this.lastA=null,this.lastB=null,this.lastALU=null,this.lastW=null,this.alu=0;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-48,16,"ALU").bus=!0,this.addIn(-t,16,16,"Ae").bus=!0,this.addIn(-t,48,16,"Be").bus=!0,this.addIn(-t,-32,16,"ALUe").bus=!0,this.addIn(0,this.height/2,8,"R").orientation="s",this.addIn(-t,-16,16,"W"),this.addOut(t,-48,16,"A").bus=!0,this.addOut(t,48,16,"B").bus=!0,this.outs[0].set(void 0),this.outs[1].set(void 0)};(Re.prototype=Object.create(Y.prototype)).constructor=Re,Re.prototype.prefix="R",Re.type="Registers16",Re.label="Registers",Re.desc="Register File",Re.img="registers16.png",Re.description="<h2>Registers</h2>\n<p>Simple 16-bit register file. Ae and Be choose which register is routed to \nthe A and B outputs. ALU is the input from the ALU. ALUe chooses which register to write. \nA register will only be written if W (write enable) is high.</p><p>R is a reset input and is optional. \nThe R input (reset) sets all registers to zero.</p>\n<p>The register file sets the \nregister on the clock <em>leading edge.</em></p>",Re.order=700,Re.help="registers16",Re.prototype.compute=function(t){if(this.lastA=T.busValueToDecimal(t[2],8),this.lastB=T.busValueToDecimal(t[3],8),this.lastALU=T.busValueToDecimal(t[4],8),this.lastW=t[6],t[0]&&!this.lastClk&&(this.alu=T.busValueToDecimal(t[1]),null!==this.lastALU&&this.lastW&&(this.values[this.lastALU]=this.alu)),t[5]&&(this.values=[0,0,0,0,0,0,0,0]),null!==this.lastA){for(var e=this.values[this.lastA],i=[],n=0;n<16;n++)i.push(1==(1&e)),e>>=1;this.outs[0].set(i)}else this.outs[0].set(void 0);if(null!==this.lastB){for(var o=this.values[this.lastB],s=[],r=0;r<16;r++)s.push(1==(1&o)),o>>=1;this.outs[1].set(s)}else this.outs[1].set(void 0);this.lastClk=t[0]},Re.prototype.clone=function(){var t=new Re;return t.copyFrom(this),t.values=this.values.slice(),t},Re.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),t.font='10px "Lucida Console", Monaco, monospace',t.textAlign="left";for(var i=this.y-54,n=this.x-11,o=n+45,s=i,r=0;r<8;r++)t.fillText("r"+r+":"+b.toHex(this.values[r],4),this.x-10,s),s+=16;var a=i-4;null!==this.lastALU&&this.lastW&&this.jaggedLine(t,this.x-this.width/2+34,this.y-48,n,a+16*this.lastALU,.5),null!==this.lastA&&this.jaggedLine(t,o,a+16*this.lastA,this.x+this.width/2-14,this.y-48,.66),null!==this.lastB&&this.jaggedLine(t,o,a+16*this.lastB,this.x+this.width/2-14,this.y+48,.33),t.font="12px Times",t.textAlign="center",this.drawIO(t,e)},Re.prototype.testAsString=function(t,e){if(null!==t)if("reset"===t)this.values=[0,0,0,0,0,0,0,0],this.pending();else if("r"===t.substr(0,1)){var i=parseInt(t.substr(1,1));if(i<0||i>7)throw"Invalid register indicated in test "+t;var n=parseInt(t.substr(3));if(n!==+this.values[i])throw"Incorrect register values. Register r"+i+" expected=0x"+b.toHex(n,4)+" actual=0x"+b.toHex(this.values[i],4)}},Re.prototype.setAsString=function(t){this.testAsString(t)};var je=function(){Y.call(this),this.height=96,this.width=32,this.valueR=void 0,this.valueY=void 0,this.valueG=void 0,this.red=new ge(0,-32,12),this.yellow=new ge(0,0,12),this.green=new ge(0,32,12),this.addIn(-16,-32,16),this.addIn(-16,0,16),this.addIn(-16,32,16)};(je.prototype=Object.create(Y.prototype)).constructor=je,je.prototype.prefix="L",je.prototype.nameRequired=!0,je.type="TrafficLight",je.label="Traffic Light",je.desc="Traffic Light",je.img="trafficlight.png",je.description="<h2>Traffic Light</h2><p>The Traffic Light component has indicators \nfor Red, Yellow, and Green as in a conventional traffic light.</p>",je.order=504,je.help="trafficlight",je.prototype.compute=function(t){this.valueR=t[0],this.valueY=t[1],this.valueG=t[2]},je.prototype.clone=function(){var t=new je;return t.copyFrom(this),t},je.prototype.testAsString=function(t,e){if(null!==t){var i=t.split("=");if("?"!==i[1]){if(i.length<2)throw"Invalid traffic light test validation string "+t;var n;switch(i[0]){case"red":n=this.valueR;break;case"grn":case"green":n=this.valueG;break;case"yel":case"yellow":n=this.valueY;break;default:throw"Invalid traffic light test validation string "+t}if(void 0===n||"1"===i[1]&&!n||"0"===i[1]&&n){var o=void 0===n?"?":n?"1":"0";throw"Incorrect traffic light value. Expected "+t+" but got "+i[0]+"="+o}}}},je.prototype.draw=function(t,e){this.selectStyle(t,e);var i="#feb51a";this.drawBox(t,i),this.red.color=void 0===this.valueR?"undefined":this.valueR?"red":"off",this.red.draw(t,this.x-.5,this.y,i),this.yellow.color=void 0===this.valueY?"undefined":this.valueY?"yellow":"off",this.yellow.draw(t,this.x-.5,this.y,i),this.green.color=void 0===this.valueG?"undefined":this.valueG?"green":"off",this.green.draw(t,this.x-.5,this.y,i),this.drawIO(t,e)};var De=function(){Y.call(this),this.height=134,this.width=64;this.width,this.height;var t=-56,e=16;this.addIn(-this.width/2,t,e,"I3"),t+=16,this.addIn(-this.width/2,t,e,"I2"),t+=16,this.addIn(-this.width/2,t,e,"I1"),t+=16,this.addIn(-this.width/2,t,e,"I0"),t+=32,this.addIn(-this.width/2,t,e,"I").bus=!0,t=-56,e=16,this.addOut(this.width/2,t,e,"a"),t+=16,this.addOut(this.width/2,t,e,"b"),t+=16,this.addOut(this.width/2,t,e,"c"),t+=16,this.addOut(this.width/2,t,e,"d"),t+=16,this.addOut(this.width/2,t,e,"e"),t+=16,this.addOut(this.width/2,t,e,"f"),t+=16,this.addOut(this.width/2,t,e,"g"),t+=16};(De.prototype=Object.create(Y.prototype)).constructor=De,De.prototype.prefix="D",De.type="HexToSevenSegment",De.label="Hex to Seven Segment",De.desc="Hexadecimal to Seven Segment Decoder",De.img=null,De.description="<h2>Hex to Seven Segement</h2><p>Decodes hexadecimal into the correct outputs for a seven-segment display. Accepts either single bit lines or bus input.</p>",De.order=506,De.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2],o=t[3];if((void 0===e||void 0===i||void 0===n||void 0===o)&&void 0!==t[4]){var s=t[4];e=s[3],i=s[2],n=s[1],o=s[0]}if(void 0!==e&&void 0!==i&&void 0!==n&&void 0!==o){var r=[[!0,!0,!0,!0,!0,!0,!1],[!1,!0,!0,!1,!1,!1,!1],[!0,!0,!1,!0,!0,!1,!0],[!0,!0,!0,!0,!1,!1,!0],[!1,!0,!0,!1,!1,!0,!0],[!0,!1,!0,!0,!1,!0,!0],[!0,!1,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!1,!0,!0],[!0,!0,!0,!1,!0,!0,!0],[!1,!1,!0,!0,!0,!0,!0],[!0,!1,!1,!0,!0,!0,!1],[!1,!0,!0,!0,!0,!1,!0],[!0,!1,!1,!0,!0,!0,!0],[!0,!1,!1,!1,!0,!0,!0]][(e?8:0)+(i?4:0)+(n?2:0)+(o?1:0)];for(e=0;e<7;e++)this.outs[e].set(r[e])}else for(e=0;e<7;e++)this.outs[e].set(void 0)},De.prototype.clone=function(){var t=new De;return t.copyFrom(this),t},De.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,3),this.drawText(t,"Hex-to-7",0,this.height/2-5),this.drawIO(t,e)},De.paletteImage=function(){var t=new ht(60,44);t.box(20,40),t.io(-10,-15.5,"w",4,5),t.io(10,-15.5,"e",7,5);var e=t.context.lineWidth;return t.context.lineWidth=2,t.io(-10,15.5,"w"),t.context.lineWidth=e,t.drawText("Hex-to-7",0,18,"4px Times"),t};var Ue=function(){Y.call(this),this.height=150,this.width=90,this.value=[void 0,void 0,void 0,void 0,void 0,void 0,void 0],this.color="green";var t=-64,e=11;this.addIn(-this.width/2,t,e,"a"),t+=16,this.addIn(-this.width/2,t,e,"b"),t+=16,this.addIn(-this.width/2,t,e,"c"),t+=16,this.addIn(-this.width/2,t,e,"d"),t+=16,this.addIn(-this.width/2,t,e,"e"),t+=16,this.addIn(-this.width/2,t,e,"f"),t+=16,this.addIn(-this.width/2,t,e,"g"),t+=16,t+=16,this.addIn(-this.width/2,t,e,"en")};(Ue.prototype=Object.create(Y.prototype)).constructor=Ue,Ue.prototype.prefix="L",Ue.prototype.nameRequired=!0,Ue.type="7seg",Ue.label="7 SEG",Ue.desc="7 Segment Display",Ue.img="7seg.png",Ue.order=508,Ue.description="<h2>7 Seg</h2><p>A 7 segment display has seven different display positions that can be set independently to make numbers and other characters. The en (enable) pin enables the display if true or if not connected.</p>",Ue.prototype.compute=function(t){if(!1===t[7])for(var e=0;e<7;e++)this.value[e]=!1;else for(e=0;e<7;e++)this.value[e]=t[e]},Ue.prototype.get=function(t){return this.ins[0].value[t]},Ue.prototype.clone=function(){var t=new Ue;return t.color=this.color,t.value=this.value.slice(),t.copyFrom(this),t},Ue.prototype.draw=function(t,e){var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;this.selectStyle(t,e);var r=t.fillStyle,a=t.strokeStyle;t.fillStyle="#cccccc",t.fillRect(i,o,this.width,this.height),t.fillStyle=r,t.beginPath(),t.rect(i,o,this.width,this.height),t.stroke();var l=.2*this.width,h=.02*this.width;i+=l+5,n-=l,o+=l,s-=l,t.font="11px Times",t.textAlign="center",this.drawSegment(t,this.value[0],{x:i+h,y:o},{x:n-h,y:o},"a"),this.drawSegment(t,this.value[1],{x:n,y:o+h},{x:n,y:this.y-h},"b"),this.drawSegment(t,this.value[2],{x:n,y:this.y+h},{x:n,y:s-h},"c"),this.drawSegment(t,this.value[3],{x:n-h,y:s},{x:i+h,y:s},"d"),this.drawSegment(t,this.value[4],{x:i,y:s-h},{x:i,y:this.y+h},"e"),this.drawSegment(t,this.value[5],{x:i,y:this.y-h},{x:i,y:o+h},"f"),this.drawSegment(t,this.value[6],{x:i+h,y:this.y},{x:n-h,y:this.y},"g"),t.lineWidth=1,t.fillStyle=r,t.strokeStyle=a,this.drawIO(t,e)},Ue.prototype.drawSegment=function(t,e,i,n,o){var s=new w(n.x-i.x,n.y-i.y),r=w.normalize(s);r=w.rotate(r,Math.PI/4);var a=w.rotate(r,Math.PI/2),l=10*.707;if(e)switch(this.color){case"red":t.fillStyle="#fe0501";break;case"blue":t.fillStyle="#15ddff";break;default:t.fillStyle="#00fb4a"}else t.fillStyle="#444444";t.strokeStyle="#222222",t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(i.x+l*r.x,i.y+l*r.y),t.lineTo(n.x+l*a.x,n.y+l*a.y),t.lineTo(n.x,n.y),t.lineTo(n.x-l*r.x,n.y-l*r.y),t.lineTo(i.x-l*a.x,i.y-l*a.y),t.lineTo(i.x,i.y),t.fill(),t.stroke();var h=new w((n.x+i.x)/2,(n.y+i.y)/2),c=w.rotate(w.normalize(s),Math.PI/2);t.fillStyle="#000000",t.fillText(o,h.x+10*c.x,h.y+10*c.y+2),void 0===e&&(t.fillStyle="#00ffff",t.fontWeight="bolder",t.fillText("?",h.x,h.y+3),t.fontWeight="normal")},Ue.prototype.load=function(t){this.color=t.color,Y.prototype.load.call(this,t)},Ue.prototype.save=function(){var t=Y.prototype.save.call(this);return t.color=this.color,t},Ue.prototype.properties=function(t){var e=this,i=new H(this,t,!1),n=i.uniqueId(),o='<div class="control1 center"><label for="'+n+'">Color: </label><select id="'+n+'">';["red","green","blue"].forEach((function(t){t===e.color?o+="<option selected>"+t+"</option>":o+="<option>"+t+"</option>"})),o+="</select></div>",i.extra(o,(function(){return null}),(function(){e.color=document.getElementById(n).value})),i.open()};var Me=function(){Y.call(this),this.height=80,this.width=32,this.size=4,this.circuitOuts=[],this.addIn(-this.width/2,0,this.pinlength,"I").bus=!0,this.ensureIO()};(Me.prototype=Object.create(Y.prototype)).constructor=Me,Me.prototype.prefix=null,Me.prototype.indent=10,Me.prototype.pinlength=8,Me.type="FmBus",Me.label="Fm Bus",Me.desc="Bus to Single bits",Me.img="fmbus.png",Me.order=305,Me.description="<h2>From Bus</h2><p>Converts a bus input into single bit outputs. This allows for simpler circuits.</p>",Me.prototype.compute=function(t){if(Array.isArray(t[0])){for(var e=0;e<this.size&&e<t[0].length;e++)this.outs[e].set(t[0][e]);for(;e<this.size;e++)this.outs[e].set(void 0)}else for(e=0;e<this.size;e++)this.outs[e].set(void 0)},Me.prototype.clone=function(){var t=new Me;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},Me.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},Me.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},Me.prototype.ensureIO=function(){this.height=16*this.size+16,this.height<48&&(this.height=48);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.outs.length);i++)this.outs[i].name="O"+i,this.outs[i].x=t,this.outs[i].y=e-16*i,this.outs[i].len=this.pinlength;for(;i<this.size;i++)this.addOut(t,e-16*i,this.pinlength,"O"+i);if(i<this.outs.length){for(;i<this.outs.length;i++)this.outs[i].clear();this.outs.splice(this.size)}},Me.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawTrap(t,this.indent,0),this.drawIO(t,e)},Me.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'+n+'">Size: </label><input class="number" type="text" id="'+n+'" value="'+this.size+'"></div>';i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO(),e.pending()})),i.open(),document.getElementById(n).select()};var qe=function(){Y.call(this),this.height=80,this.width=32,this.size=4,this.circuitIns=[],this.addOut(this.width/2,0,this.pinlength,"O").bus=!0,this.ensureIO()};(qe.prototype=Object.create(Y.prototype)).constructor=qe,qe.prototype.prefix=null,qe.prototype.indent=10,qe.prototype.pinlength=8,qe.type="ToBus",qe.label="To Bus",qe.desc="Single bits to a Bus",qe.img="tobus.png",qe.order=306,qe.description="<h2>To Bus</h2><p>Converts single bit inputs into a bus output to simplify circuits</p>",qe.prototype.compute=function(t){this.outs[0].set(t)},qe.prototype.clone=function(){var t=new qe;return t.size=this.size,t.ensureIO(),t.copyFrom(this),t},qe.prototype.load=function(t){this.size=t.size,this.ensureIO(),Y.prototype.load.call(this,t)},qe.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},qe.prototype.ensureIO=function(){this.height=16*this.size+12,this.height<48&&(this.height=48);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.ins.length);i++)this.ins[i].name="I"+i,this.ins[i].x=-t,this.ins[i].y=e-16*i,this.ins[i].len=this.pinlength;for(;i<this.size;i++)this.addIn(-t,e-16*i,this.pinlength,"I"+i);if(i<this.ins.length){for(;i<this.ins.length;i++)this.ins[i].clear();this.ins.splice(this.size)}},qe.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawTrap(t,0,this.indent),this.drawIO(t,e)},qe.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'+n+'">Size: </label><input class="number" type="text" id="'+n+'" value="'+this.size+'"></div>';i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.size=parseInt(document.getElementById(n).value),e.ensureIO(),e.pending()})),i.open(),document.getElementById(n).select()};var Fe=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,0,16,"D");var i=this.addIn(0,-e,11);i.orientation="n",i.clock=!0,this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(Fe.prototype=Object.create(Y.prototype)).constructor=Fe,Fe.type="DFF",Fe.label="D Flip-Flop",Fe.desc="D Flip-Flop",Fe.order=204,Fe.description="<h2>D Flip-Flop</h2><p>D Flip-Flop.</p>",Fe.prototype.compute=function(t){if(t[1]&&!this.lastClk){var e=t[0];this.outs[0].set(e),this.outs[1].set(e)}this.lastClk=t[1]},Fe.prototype.clone=function(){var t=new Fe;return t.copyFrom(this),t},Fe.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height;t.io(20,-18,"e"),t.io(20,18,"e"),t.io(-20,0,"w"),t.io(0,-40,"n"),t.circle(23,18,3);var o="20px Times";t.drawText("Q",10,-13,o),t.drawTextBar("Q",10,23,o),t.drawText("D",-12,5,o);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t};var He=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,-32,16,"D"),this.addIn(-t,32,16).clock=!0,this.addIn(0,-e,11,"S").orientation="n",this.addIn(0,e,11,"R").orientation="s",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(void 0),this.outs[1].set(void 0)};(He.prototype=Object.create(Y.prototype)).constructor=He,He.type="DFFsr",He.label="D Flip-Flop SR",He.desc="D Flip-Flop with Set/Reset",He.img="dffsr.png",He.order=206,He.description="<h2>D Flip-Flop with Set/Reset</h2><p>D Flip-Flop with Set and Reset. Set and Reset can be safely left unconnected.</p>",He.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2],o=t[3],s=this.outs[0],r=this.outs[1];!0===n&&!0===o?(s.set(void 0),r.set(void 0)):!0===n?(s.set(!0),r.set(!0)):!0===o?(s.set(!1),r.set(!1)):i&&!this.lastClk&&(s.set(e),r.set(e)),this.lastClk=i},He.prototype.clone=function(){var t=new He;return t.copyFrom(this),t};var Xe=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,-32,16,"J"),this.addIn(-t,32,16,"K"),this.addIn(-t,0,16).clock=!0,this.addIn(0,-e,11,"S").orientation="n",this.addIn(0,e,11,"R").orientation="s",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(void 0),this.outs[1].set(void 0)};(Xe.prototype=Object.create(Y.prototype)).constructor=Xe,Xe.type="JKFF",Xe.label="JK Flip-Flop",Xe.desc="JK Flip-Flop",Xe.img="jk.png",Xe.order=208,Xe.description="<h2>JK Flip-Flop</h2><p>JK Flip-Flop.</p>",Xe.prototype.compute=function(t){var e=t[3],i=t[4],n=this.outs[0],o=this.outs[1];if(!0===e&&!0===i)n.set(void 0),o.set(void 0);else if(!0===e)n.set(!0),o.set(!0);else if(!0===i)n.set(!1),o.set(!1);else if(t[2]&&!this.lastClk){var s=t[0],r=t[1];if(s&&r){var a=!this.outs[0].get();n.set(a),o.set(a)}else s?(a=!0,n.set(a),o.set(a)):r&&(a=!1,n.set(a),o.set(a))}this.lastClk=t[2]},Xe.prototype.clone=function(){var t=new Xe;return t.copyFrom(this),t};var We=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2,e=this.height/2;this.addIn(-t,0,16,"D"),this.addIn(0,-e,11,"CLK").orientation="n",this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(We.prototype=Object.create(Y.prototype)).constructor=We,We.type="DLatch",We.label="D  Latch",We.desc="D Latch",We.order=202,We.description="<h2>D Latch</h2>\n<p>A D latch passes the input D to the outputs Q and Q' when the clock input CLK is true, but\nlatches the value when CLK is false.</p>",We.prototype.compute=function(t){if(t[1]){var e=t[0];this.outs[0].set(e),this.outs[1].set(e)}},We.prototype.clone=function(){var t=new We;return t.copyFrom(this),t},We.paletteImage=function(){var t=new ht(120,120);t.context.lineWidth=1.5,t.box(40,80);t.io(20,-18,"e"),t.io(20,18,"e"),t.io(-20,0,"w"),t.io(0,-40,"n"),t.circle(23,18,3);var e="20px Times";return t.drawText("Q",10,-13,e),t.drawTextBar("Q",10,23,e),t.drawText("D",-12,5,e),t.drawText("CLK",0,-29,"12px Times"),t};var Ye=function(){Y.call(this),this.height=90,this.width=64;var t=this.width/2;this.addIn(-t,-32,16,"R"),this.addIn(-t,32,16,"S"),this.addOut(t,-32,16,"Q"),this.addOutInv(t,32,16,"Q",!0),this.outs[0].set(!1),this.outs[1].set(!1)};(Ye.prototype=Object.create(Y.prototype)).constructor=Ye,Ye.type="SRLatch",Ye.label="SR Latch",Ye.desc="SR Latch",Ye.order=200,Ye.description="<h2>SR Latch</h2><p>Set/Reset latch. The S input sets the output. The R input resets the output.</p>",Ye.prototype.compute=function(t){this.outs[0].get(),this.outs[1].get();var e=t[0],i=t[1];e&&i?(this.outs[0].set(!0),this.outs[1].set(!1)):e?(this.outs[0].set(!1),this.outs[1].set(!1)):i&&(this.outs[0].set(!0),this.outs[1].set(!0))},Ye.prototype.clone=function(){var t=new Ye;return t.copyFrom(this),t},Ye.paletteImage=function(){var t=new ht(120,100);t.context.lineWidth=1.5,t.box(40,70);var e=20;t.io(20,-20,"e"),t.io(20,e,"e"),t.io(-20,-20,"w"),t.io(-20,e,"w"),t.circle(23,e,3);var i="20px Times";return t.drawText("Q",10,-15,i),t.drawTextBar("Q",10,25,i),t.drawText("R",-12,-15,i),t.drawText("S",-12,25,i),t};var Ve=function(){Y.call(this),this.height=150,this.width=90,this.value=void 0;this.addIn(-this.width/2,0,11,"in").bus=!0};(Ve.prototype=Object.create(Y.prototype)).constructor=Ve,Ve.prototype.prefix="L",Ve.prototype.nameRequired=!0,Ve.type="letters16",Ve.label="16 Letter Display",Ve.desc="16 Letter Display",Ve.img="letters16.png",Ve.description='<h2>16 Letter Display</h2>\n<p>A special display used for Word Sequencing tasks. A 4-bit bus input value 0-15 (0 to f in hex) maps\nto the letters indicated in this table:</p>\n<table class="center">\n<tr><th>Value</th><th>Letter</th></tr>\n<tr><td>0</td><td>A</td></tr>\n<tr><td>1</td><td>C</td></tr>\n<tr><td>2</td><td>D</td></tr>\n<tr><td>3</td><td>E</td></tr>\n<tr><td>4</td><td>F</td></tr>\n<tr><td>5</td><td>H</td></tr>\n<tr><td>6</td><td>I</td></tr>\n<tr><td>7</td><td>L</td></tr>\n<tr><td>8</td><td>M</td></tr>\n<tr><td>9</td><td>N</td></tr>\n<tr><td>a</td><td>O</td></tr>\n<tr><td>b</td><td>R</td></tr>\n<tr><td>c</td><td>S</td></tr>\n<tr><td>d</td><td>T</td></tr>\n<tr><td>e</td><td>U</td></tr>\n<tr><td>f</td><td>W</td></tr>\n</table>\n',Ve.order=510,Ve.prototype.compute=function(t){if(Array.isArray(t[0])){var e=t[0];void 0===e[0]||void 0===e[1]||void 0===e[2]||void 0===e[3]?this.value=void 0:this.value=(e[0]?1:0)+(e[1]?2:0)+(e[2]?4:0)+(e[3]?8:0)}else this.value=void 0},Ve.prototype.get=function(t){return this.ins[0].value[t]},Ve.prototype.clone=function(){var t=new Ve;return t.value=this.value,t.copyFrom(this),t},Ve.prototype.draw=function(t,e){var i=this.x-this.width/2-.5,n=(this.x,this.width,this.y-this.height/2-.5);this.y,this.height;this.selectStyle(t,e);var o=t.fillStyle,s=t.strokeStyle;t.fillStyle="#cccccc",t.fillRect(i,n,this.width,this.height),t.fillStyle=o,t.beginPath(),t.rect(i,n,this.width,this.height),t.stroke();var r=void 0===this.value?"?":["A","C","D","E","F","H","I","L","M","N","O","R","S","T","U","W"][this.value];t.beginPath(),t.font="60px Arial",t.textAlign="center",t.strokeStyle="#008800",t.fillStyle=t.strokeStyle,t.fillText(r,this.x,this.y+20),t.stroke(),t.lineWidth=1,t.fillStyle=o,t.strokeStyle=s,this.drawName(t,0,this.height/2-8),this.drawIO(t,e)};var Ze=function(){Y.call(this),this.height=90,this.width=32;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.addIn(-t,0,8,"D").bus=!0;var i=this.addIn(0,-e,11);i.orientation="n",i.clock=!0,this.addOut(t,0,8,"Q").bus=!0,this.outs[0].set(void 0)};(Ze.prototype=Object.create(Y.prototype)).constructor=Ze,Ze.type="Register",Ze.label="Register",Ze.desc="Register",Ze.description="<h2>Register</h2>\n<p>A bus register. Works like a D Flip-Flop for all bits on a bus input and output. \nWhen the clock input goes high, the output is set to the value of the input. Works for\nany bus size.</p>",Ze.order=404,Ze.prototype.compute=function(t){if(t[1]&&!this.lastClk){var e=t[0];this.outs[0].set(e)}this.lastClk=t[1]},Ze.prototype.clone=function(){var t=new Ze;return t.copyFrom(this),t},Ze.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),this.drawName(t,0,-16),this.drawIO(t,e)},Ze.paletteImage=function(){var t=new ht(60,44);return t.box(12,32),t.io(-6,0,"w"),t.io(6,0,"e"),t.drawText("D",-3,2,"7px Times"),t.drawText("Q",3,2,"7px Times"),t.clock(0,-16,"n"),t};var Ge=function(){Y.call(this),this.height=128,this.width=64,this.shrink=15;var t=-this.width/2,e=this.width/2;this.addIn(t,-32,16,"A").bus=!0,this.addIn(t,32,16,"B").bus=!0;var i=.5*this.shrink,n=this.addIn(0,this.height/2-i,6+i,"C");n.orientation="s",n.bus=!0,this.addOut(e,0,16,"O").bus=!0,this.addOut(e,24,16,"CPSR").bus=!0};(Ge.prototype=Object.create(Y.prototype)).constructor=Ge,Ge.prototype.prefix="ALU",Ge.prototype.nameRequired=!0,Ge.type="alu4",Ge.label="ALU 4",Ge.desc="Simple 4-bit ALU",Ge.img="alu.png",Ge.description="<h2>4-bit ALU</h2><p>Simple example 4-bit ALU</p>\n<p>The operation is determined by the value of the C bus input. Operations \nsupported are:<p>\n<table>\n<tr><th>C</th><th>operation</th></tr>\n<tr><td>0</td><td>O&larr;B</td></tr>\n<tr><td>1</td><td>O&larr;A+B</td></tr>\n<tr><td>2</td><td>O&larr;A-B</td></tr>\n<tr><td>3</td><td>O&larr;A&amp;B</td></tr>\n<tr><td>4</td><td>O&larr;A|B</td></tr>\n<tr><td>5</td><td>O&larr;A&lt;&lt;B (logical)</td></tr>\n<tr><td>6</td><td>O&larr;A&lt;&lt;B (arithmetic)</td></tr>\n</table>\n<p>For the shift operations, negative values for B result in a right shift.<p>\n<p>The CPSR bits are VCZN (N is the lsb).</p>",Ge.order=602,Ge.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2];function o(t){if(void 0!==t){var e=1,i=0;return t.forEach((function(t){void 0!==t&&(t&&(8==e?i-=e:i+=e),e*=2)})),i}}var s=o(e),r=o(i),a=r,l=!1,h=!1;switch(o(n)){default:a=r;break;case 1:l=0!=(16&(15&s)+(15&r)),h=(a=s+r)<-8||a>7;break;case 2:l=0!=(16&(15&s)+(15&~r)+1),h=(a=s-r)<-8||a>7;break;case 3:a=s&r;break;case 4:a=s|r;break;case 5:a=r<0?(15&s)>>-r:(15&s)<<r;break;case 6:a=r<0?s>>-r:s<<r}if(void 0===a)this.outs[0].set([void 0,void 0,void 0,void 0]),this.outs[1].set([void 0,void 0,void 0,void 0]);else{var c=[1==(1&a),2==(2&a),4==(4&a),8==(8&a)];this.outs[0].set(c),this.outs[1].set([c[3],0==a,l,h])}},Ge.prototype.clone=function(){var t=new Ge;return t.copyFrom(this),t},Ge.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-this.shrink/2),t.lineTo(i+20,this.y),t.lineTo(i,this.y+this.shrink/2),t.lineTo(i,s),t.lineTo(n,s-this.shrink),t.lineTo(n,o+this.shrink),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-15)),t.stroke(),this.drawIO(t,e)},Ge.prototype.properties=function(t){new H(this,t).open()};var Je=function(t,e,i,n,o){this.label=t,this.value=e,this.x=i,this.y=n,this.size=void 0===o?30:o,this.state="off"};function Qe(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Ke(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ke(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function Ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Je.prototype.touch=function(t,e){var i=this.size;return t>this.x-i/2&&t<this.x+i/2&&e>this.y-i/2&&e<this.y+i/2&&(this.state="pressed",!0)},Je.prototype.setState=function(t){this.state=t},Je.prototype.untouch=function(){return"pressed"===this.state&&(this.state="on",!0)},Je.prototype.draw=function(t,e,i){var n=t.fillStyle,o=t.strokeStyle;e+=this.x,i+=this.y;var s=this.size,r=.85*s;switch(this.state){case"off":default:t.fillStyle="#3ab5de";break;case"pressed":t.fillStyle="#ff5255";break;case"on":t.fillStyle="#0000ff"}ut.roundedRect(t,e-s/2,i-s/2,s,s,3),t.fill(),t.lineWidth=2,t.strokeStyle="#f2f2f2",ut.roundedRect(t,e-s/2,i-s/2,s,s,3),t.stroke(),t.font=r+"px Arial",t.textAlign="center",t.fillStyle="#f2f2f2",t.fillText(this.label,e,i+.38*r),t.lineWidth=1,t.fillStyle=n,t.strokeStyle=o};var $e=function(){Y.call(this),this.height=150,this.width=150,this.value=new Xt,this.bus=!0,this.bits=4,this.clockDelay=0,this.pad=null,this.setType(16),this.setAsInteger(0),this.setPressedOut(!1)};($e.prototype=Object.create(Y.prototype)).constructor=$e,$e.prototype.prefix="P",$e.prototype.nameRequired=!0,$e.type="Pad",$e.label="Pad",$e.desc="Configurable Keypad",$e.img="pad.png",$e.description="<h2>Configurable Keypad</h2>\n<p>Presents a keypad with from 4 to 16 buttons. If configured as a bus output, there are two outputs. \nThe top output is the bus output and is the \nmost recently pressed button value. If configured for single bit output, there will be 2-4 output bits\nthe represent the most recently pressed button. \nThe bottom output is the clock and is true when the button is pressed.</p>",$e.order=500,$e.help="pad",$e.prototype.setType=function(t){var e=this;if(this.pad!==t){var i=30;switch(t){case 16:case"16":default:!function(){e.pad=16;var t=-52.5,n=-17.5,o=17.5,s=52.5,r=-8;e.buttons=[new Je("0",0,t,t+r,i),new Je("1",1,n,t+r,i),new Je("2",2,o,t+r,i),new Je("3",3,s,t+r,i),new Je("4",4,t,n+r,i),new Je("5",5,n,n+r,i),new Je("6",6,o,n+r,i),new Je("7",7,s,n+r,i),new Je("8",8,t,9.5,i),new Je("9",9,n,9.5,i),new Je("A",10,o,9.5,i),new Je("B",11,s,9.5,i),new Je("C",12,t,44.5,i),new Je("D",13,n,44.5,i),new Je("E",14,o,44.5,i),new Je("F",15,s,44.5,i)],e.width=154,e.height=e.width+13+4,e.bits=4}();break;case 10:case"10":!function(){e.pad=10;var t=-52.5,n=-17.5,o=-8;e.buttons=[new Je("1",1,-35,t+o,i),new Je("2",2,0,t+o,i),new Je("3",3,35,t+o,i),new Je("4",4,-35,n+o,i),new Je("5",5,0,n+o,i),new Je("6",6,35,n+o,i),new Je("7",7,-35,9.5,i),new Je("8",8,0,9.5,i),new Je("9",9,35,9.5,i),new Je("0",0,0,44.5,i)],e.width=119,e.height=171,e.bits=4}();break;case 12:case"12":!function(){e.pad=12;var t=-35,n=-52.5,o=-17.5,s=-8;e.buttons=[new Je("1",1,t,n+s,i),new Je("2",2,0,n+s,i),new Je("3",3,35,n+s,i),new Je("4",4,t,o+s,i),new Je("5",5,0,o+s,i),new Je("6",6,35,o+s,i),new Je("7",7,t,9.5,i),new Je("8",8,0,9.5,i),new Je("9",9,35,9.5,i),new Je("*",10,t,44.5,i),new Je("0",0,0,44.5,i),new Je("#",11,35,44.5,i)],e.width=119,e.height=171,e.bits=4}();break;case 8:case"8":!function(){e.pad=8;var t=-17.5,n=17.5,o=-8;e.buttons=[new Je("0",0,-52.5,t+o,i),new Je("1",1,t,t+o,i),new Je("2",2,n,t+o,i),new Je("3",3,52.5,t+o,i),new Je("4",4,-52.5,9.5,i),new Je("5",5,t,9.5,i),new Je("6",6,n,9.5,i),new Je("7",7,52.5,9.5,i)],e.width=154,e.height=101,e.bits=3}();break;case 4:case"4":!function(){e.pad=4;var t=-17.5,n=17.5;e.buttons=[new Je("0",0,t,t+-8,i),new Je("1",1,n,t+-8,i),new Je("2",2,t,9.5,i),new Je("3",3,n,9.5,i)],e.width=84,e.height=101,e.bits=2}()}this.ensureIO()}else this.ensureIO()},$e.prototype.ensureIO=function(){var t=0;if(this.outs.length>0){var e=!1;if(this.outs[0].bus!==this.bus&&(e=!0),this.bus||this.outs.length===this.bits+1||(e=!0),!e){var i,n=Qe(this.outs);try{for(n.s();!(i=n.n()).done;){i.value.x=this.width/2}}catch(t){n.e(t)}finally{n.f()}return}}for(t=0;t<this.outs.length;t++)this.outs[t].clear();this.outs=[];if(this.bus)this.addOut(this.width/2,-16,11).bus=!0;else for(t=0;t<this.bits;t++){var o=0-16*t;this.addOut(this.width/2,o,11)}this.addOut(this.width/2,32,11),this.setOuts(),this.setPressedOut(!1)},$e.prototype.clone=function(){var t=new $e;return t.value=this.value.clone(),t.bus=this.bus,t.setType(this.pad),t.copyFrom(this),t},$e.prototype.draw=function(t,e){var i=this,n=this.x-this.width/2-.5,o=this.y-this.height/2-.5,s=this.unselectedStyle;this.unselectedStyle="#f2f2f2",this.selectStyle(t,e);var r=t.fillStyle,a=t.strokeStyle;t.fillStyle="#111111",ut.roundedRect(t,n,o,this.width,this.height,6),t.fill();t.fillStyle=r,t.lineWidth=2,ut.roundedRect(t,n+3,o+3,this.width-6,this.height-6,6),t.stroke(),t.lineWidth=1,this.buttons.forEach((function(e){e.draw(t,i.x,i.y)})),this.drawName(t,0,this.height/2-8),t.lineWidth=1,t.fillStyle=r,t.strokeStyle=a,this.unselectedStyle=s,this.drawIO(t,e)},$e.prototype.touch=function(t,e){var i=this.size;if(!(t<this.x-i/2||t>this.x+i/2||e<this.y-i/2||e>this.y-i/2)){for(var n in this.buttons){var o=this.buttons[n];if(o.touch(t-this.x,e-this.y)){this.setAsInteger(o.value,4),this.setPressedOut(!0);break}}return Y.prototype.touch.call(this,t,e)}},$e.prototype.set=function(t){this.value.set(t),this.setOuts(),this.updateUI()},$e.prototype.setAsInteger=function(t){this.value.setAsInteger(t,this.bits),this.setOuts(),this.updateUI()},$e.prototype.updateUI=function(){var t=this.value.getAsInteger(),e=this.getPressedOut();void 0===e&&(e=!1),this.buttons.forEach((function(i){i.value!==t?i.setState("off"):e?i.setState("pressed"):i.setState("on")}))},$e.prototype.setAsString=function(t,e){"release"===t?this.mouseUp():"press:"===t.substr(0,6)?(this.value.setAsHex(t.substr(6)),this.setPressedOut(!0),this.updateUI()):(this.value.setAsString(t,e),this.updateUI()),e||this.setOuts()},$e.prototype.setOuts=function(){if(this.bus)this.outs[0].set(this.value.get());else for(var t=0;t<this.bits;t++)this.outs[t].set(this.value.getBit(t))},$e.prototype.advance=function(t){return!1},$e.prototype.compute=function(t){var e=!0===t[0];this.bus?this.outs[1].set(e):this.outs[this.bits].set(e),this.updateUI()},$e.prototype.setPressedOut=function(t){var e=this.getSimulation();null!==e&&e.queue(this,50,[t])},$e.prototype.getPressedOut=function(){return this.bus?this.outs[1].get():this.outs[this.bits].get()},$e.prototype.mouseUp=function(){this.buttons.forEach((function(t){t.untouch()})),this.setPressedOut(!1)},$e.prototype.save=function(){var t=Y.prototype.save.call(this);return this.value.save(t),t.pad=this.pad,t.bus=this.bus,t},$e.prototype.load=function(t){this.value.load(t),this.bus=!1!==t.bus,this.setType(t.pad),Y.prototype.load.call(this,t)},$e.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control center"><div class="choosers">';o+='\n<label><input type="radio" name="'.concat(n,'" value="16" ').concat(16===this.pad?"checked":"",'> 16 Buttons (Hex)</label>\n<label><input type="radio" name="').concat(n,'" value="10" ').concat(10===this.pad?"checked":"",'> 10 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="8" ').concat(8===this.pad?"checked":"",'> 8 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="4" ').concat(4===this.pad?"checked":"",'> 4 Buttons </label>\n<label><input type="radio" name="').concat(n,'" value="12" ').concat(12===this.pad?"checked":"","> Phone (12 buttons)</label>\n"),o+="<br>";var s=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(s,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Output</label>\n<label><input type="radio" name="').concat(s,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Outputs</label>'),o+="</div></div>",i.extra(o,(function(){return null}),(function(){e.bus="1"===document.querySelector("input[name=".concat(s,"]:checked")).value,e.setType(document.querySelector("input[name=".concat(n,"]:checked")).value)})),i.open()};var _e=function(){Y.call(this),this.height=50,this.width=20,this.leds=[],this.horz=!1,this.bus=!1,this.color="blue",this.lastState=[],this.setSize(4)};(_e.prototype=Object.create(Y.prototype)).constructor=_e,_e.prototype.prefix="L",_e.type="LEDBar",_e.label="LED Bar",_e.desc="LED Indicator Bar",_e.img="ledbar.png",_e.description="<h2>LED Bar</h2><p>The LED Bar component displays from two to \nsixteen LEDs in a vertical or horizontal bar that are lighted by values on discrete inputs\nor a single bus input. </p>",_e.order=502,_e.help="ledbar",_e.prototype.setSize=function(t){this.size=+t,this.ensureIO()},_e.prototype.compute=function(t){this.bus?(this.lastState=t[0],void 0===this.lastState&&(this.lastState=[])):this.lastState=t},_e.prototype.clone=function(){var t=new _e;return t.size=this.size,t.horz=this.horz,t.bus=this.bus,t.ensureIO(),t.copyFrom(this),t},_e.prototype.load=function(t){this.color=gt.sanitize(t.color),void 0!==t.horz&&(this.horz=!0===t.horz),void 0!==t.bus&&(this.bus=!0===t.bus),this.setSize(t.size),Y.prototype.load.call(this,t)},_e.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.color=this.color,t.horz=this.horz,t.bus=this.bus,t},_e.prototype.ensureIO=function(){var t=16,e=0;if(this.leds=[],this.ins.length>0&&this.ins[0].bus!==this.bus){for(e=0;e<this.ins.length;e++)this.ins[e].clear();this.ins=[]}if(this.horz){this.width=this.size*t,this.width<50&&(this.width=50),this.height=20;var i=this.size/2*t-8;for(e=0;e<this.size;e++){var n=i-e*t;this.leds.push(new ge(n,0,t,this.height))}if(this.bus){var o=null;e<this.ins.length?((o=this.ins[e]).x=-this.width/2,o.y=0,o.len=16):o=this.addIn(-this.width/2,0,16),o.orientation="w",o.bus=!0,o.autoLen()}else for(e=0;e<this.size;e++){var s=i-e*t,r=24-this.height/2,a=null;null!==(a=e<this.ins.length?this.ins[e]:this.addIn(s,this.height/2,r))&&(a.x=s,a.y=this.height/2,a.len=r,a.orientation="s",a.bus=!1)}}else{this.height=this.size*t,this.height<50&&(this.height=50),this.width=20;var l=this.size/2*t-8;for(e=0;e<this.size;e++){var h=l-e*t;this.leds.push(new ge(0,h,this.width,t))}if(this.bus){var c=null;e<this.ins.length?((c=this.ins[e]).x=0,c.y=this.height/2,c.len=16):c=this.addIn(0,this.height/2,16),c.orientation="s",c.bus=!0,c.autoLen()}else for(e=0;e<this.size;e++){var u=l-e*t,d=24-this.width/2,p=null;e<this.ins.length?((p=this.ins[e]).x=-this.width/2,p.y=u,p.len=d):p=this.addIn(-this.width/2,u,d),null!==p&&(p.orientation="w",p.bus=!1)}}if(!this.bus&&e<this.ins.length){for(;e<this.ins.length;e++)this.ins[e].clear();this.ins.splice(this.size)}},_e.prototype.draw=function(t,e){for(var i=0;i<this.lastState.length&&i<this.leds.length;i++){var n=this.lastState[i];this.leds[i].color=void 0===n?"undefined":n?this.color:"black"}for(;i<this.leds.length;i++)this.leds[i].color="undefined";var o="#444444";this.selectStyle(t,e),this.drawBox(t,o);for(var s=0;s<this.size;s++)this.leds[s].draw(t,this.x,this.y,o);this.drawBox(t,"none"),this.drawIO(t,e)},_e.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center"><label for="'.concat(n,'">Size: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>'),s=i.uniqueId();o+=ge.colorSelector(s,this.color),o+='<div class="control center"><div class="choosers">';var r=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(r,'" ').concat(this.horz?"":"checked",' value="0"> Vertical</label>\n<label><input type="radio" name="').concat(r,'"  ').concat(this.horz?"checked":"",' value="1"> Horizontal</label>'),o+="<br>";var a=i.uniqueId();o+='\n<label><input type="radio" name="'.concat(a,'"  ').concat(this.bus?"checked":"",' value="1"> Bus Input</label>\n<label><input type="radio" name="').concat(a,'" ').concat(this.bus?"":"checked",' value="0"> Single Bit Inputs</label>'),o+="</div></div>",i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?"Size must be an integer from 2 to 16":null}),(function(){e.color=gt.sanitize(document.getElementById(s).value),e.horz="1"===document.querySelector("input[name=".concat(r,"]:checked")).value,e.bus="1"===document.querySelector("input[name=".concat(a,"]:checked")).value,e.setSize(parseInt(document.getElementById(n).value))})),i.open()};var ti=function(){Y.call(this),this.height=128,this.width=64;var t=this.width/2,e=this.height/2;this.value=0,this.lastClk=!1,this.ba=0;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-32,16,"BA").bus=!0,this.addIn(-t,32,16,"B"),this.addIn(0,e,8,"R").orientation="s",this.addOut(t,-32,16,"PC").bus=!0,this.outs[0].set(void 0)};(ti.prototype=Object.create(Y.prototype)).constructor=ti,ti.prototype.prefix="PC",ti.type="Pc16",ti.label="Program Counter",ti.desc="Program Counter",ti.img="pc16.png",ti.description="<h2>Program Counter</h2><p>Simple 16-bit program counter (PC). If B is true when \nthe clock edge rises, the signed value in BA (branch address) plus 2 is added to the PC.</p>",ti.order=702,ti.help="pc16",ti.prototype.compute=function(t){t[3]?this.value=0:t[0]&&!this.lastClk&&(this.ba=T.busValueToDecimal(t[1]),this.value+=2,t[2]&&null!==this.ba&&(this.value+=this.ba+2)),this.value&=65535;for(var e=this.value,i=[],n=0;n<16;n++)i.push(1==(1&e)),e>>=1;this.outs[0].set(i),this.lastClk=t[0]},ti.prototype.clone=function(){var t=new ti;return t.copyFrom(this),t},ti.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t);var i=this.y-10;t.font='14px "Lucida Console", Monaco, monospace',t.textAlign="center",t.fillText(b.toHex(this.value,4),this.x,i),i+=20,t.font="12px Times",t.fillText("program",this.x,i),t.fillText("counter",this.x,i+15),this.drawIO(t,e)};var ei=function(){Y.call(this),this.height=132,this.width=64;var t=this.width/2,e=this.height/2;this.lastClk=!1,this.data=[],this.lastAddress=0,this.lastData=0,this.write=0,this.addIn(-t,-32,16,"A").bus=!0,this.addIn(-t,32,16,"W").bus=!0;var i=this.addIn(0,-e,14);i.orientation="n",i.clock=!0,this.addOut(t,-32,16,"R").bus=!0};(ei.prototype=Object.create(Y.prototype)).constructor=ei,ei.prototype.prefix="M",ei.type="Memory16",ei.label="Memory",ei.desc="16-bit Memory",ei.img=null,ei.description="<h2>16-bit Memory Bank</h2><p>The Memory component implements a simple 16-bit Memory Bank.\nMemory is an array of bytes. The A (address) input selects a memory location that is output on the R\noutput. The component implements 16-bit memory,\nso all accesses are considered to be multiples of two and retrieve two bytes. Memory is retrieved in little-endian\nmode (first byte is the least significant byte).</p>\n<p>A clock cycle on the clock input writes the memory component with the value on the W (write) input.</p>",ei.order=704,ei.help="memory16",ei.prototype.compute=function(t){var e=T.busValueToDecimal(t[0]);if(null===e)this.outs[0].set(void 0);else{if(t[2]&&!this.lastClk&&(this.write=T.busValueToDecimal(t[1]),null!==this.write)){for(;this.data.length<e+2;)this.data.push(0);var i=this.write>>8,n=255&this.write;this.data[e]=n,this.data[e+1]=i}if(e<this.data.length-1)var o=this.data[e]+(this.data[e+1]<<8);else o=0;this.lastAddress=e,this.lastData=o;for(var s=[],r=0;r<16;r++)s.push(1==(1&o)),o>>=1;this.outs[0].set(s)}this.lastClk=t[2]},ei.prototype.setAsString=function(t,e){t=gt.sanitize(t),void 0===e&&(e=!0),e&&(this.data=[]);var i=t.split(/\s+/),n=0;for(var o in i){if((s=i[o]).indexOf(":")>=0){if(n=parseInt(s,16),isNaN(n))return"invalid input address"}else if(""!==s){var s=parseInt(s,16);if(isNaN(s))return"invalid input data";if(e){for(;this.data.length<n;)this.data.push(0);this.data[n]=s,n++}}}return e&&this.pending(),null},ei.prototype.clone=function(){var t=new ei;return t.data=this.data.slice(),t.copyFrom(this),t},ei.prototype.load=function(t){this.data=t.data,Y.prototype.load.call(this,t)},ei.prototype.save=function(){var t=Y.prototype.save.call(this);return t.data=this.data,t},ei.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText(b.toHex(this.lastAddress,4)+":"+b.toHex(this.lastData,4),this.x,this.y+this.height/2-18),t.fillText("memory",this.x,this.y+this.height/2-5),this.drawName(t,0,3),this.drawIO(t,e)},ei.prototype.properties=function(t){for(var e=this,i="",n=0;n<this.data.length;n++)n%8==0&&(i.length>0&&(i+="\n"),i+=b.toHex(n,4)+":"),i+=" "+b.toHex(this.data[n],2);var o=new H(this,t),s=o.uniqueId(),r='<div class="control"><label for="'.concat(s,'">Contents:</label>\n<textarea class="code1" type="text" rows="9" name="').concat(s,'" id="').concat(s,'" spellcheck="false">').concat(i,"</textarea>\n</div>");o.extra(r,(function(){var t=document.getElementById(s).value;return e.setAsString(t,!1)}),(function(){var t=document.getElementById(s).value;return e.setAsString(t)}),85),o.open()},ei.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height,o=18;t.io(0,-40,"n");var s=t.lineWidth(2);t.io(20,-18,"e"),t.io(-20,-18,"w"),t.io(-20,o,"w"),t.lineWidth(s);var r="20px Times";t.drawText("R",10,-13,r),t.drawText("A",-12,-13,r),t.drawText("W",-12,23,r);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t.drawText("memory",0,38,"8px Times"),t.drawText("0000:0000",0,32,"8px Times"),t};var ii=function(){Y.call(this);var t=16;Object.defineProperties(this,{size:{get:function(){return t},set:function(e){switch(+e){case 8:t=8;break;default:t=16;break;case 32:t=32}}},badAddr:{writable:!0},height:{value:132},width:{value:64}});var e=this.width/2,i=this.height/2;this.lastClk=!1,this.data=[],this.lastAddress=null,this.lastData=null,this.write=0,this.addIn(-e,-32,16,"A").bus=!0,this.addIn(-e,32,16,"W").bus=!0;var n=this.addIn(0,-i,14);n.orientation="n",n.clock=!0,this.addOut(e,-32,16,"R").bus=!0};(ii.prototype=Object.create(Y.prototype)).constructor=ii,ii.prototype.prefix="M",ii.type="Memory",ii.label="Memory",ii.desc="Memory",ii.img=null,ii.description="<h2>Memory Bank</h2><p>The Memory component implements a simple Memory Bank.\nMemory is an array of bytes. The A (address) input selects a memory location that is output on the R\noutput. The component can be configured for 8-, 16-, or 32-bit memory. \n</p>\n<p>In the 16-bit configuration,\nall accesses are considered to be multiples of two and retrieve two bytes. Addresses with the lower bit set\nare considered erroneous. </p>\n<p>In the 32-bit configuration,\nall accesses are considered to be multiples of four and retrieve four bytes. Addresses with any of the lower \ntwo bits set are considered erroneous.</p>\n<p>Memory is retrieved in little-endian mode (first byte is the least significant byte). \nErroneous addresses are indicated by an X next to the A input on\n the component.</p>\n<p>A clock cycle on the clock input writes the memory component with the value on the W (write) input.</p>",ii.order=705,ii.help="memory",ii.prototype.compute=function(t){var e=this.size/8,i=T.busValueToDecimal(t[0]),n=i;if(this.badAddr=!1,null===n)this.outs[0].set(void 0);else{switch(e){case 2:this.badAddr=0!=(1&n),n&=65534;break;case 4:this.badAddr=0!=(3&n),n&=65532}if(t[2]&&!this.lastClk&&(this.write=T.busValueToDecimal(t[1]),null!==this.write)){for(;this.data.length<n+e;)this.data.push(0);for(var o=this.write,s=0;s<e;s++)this.data[n+s]=o,o>>=8}var r=0;if(n<=this.data.length-e)for(var a=0;a<e;a++)r+=this.data[n+a]<<8*a;this.lastAddress=i,this.lastData=r;for(var l=[],h=0;h<this.size;h++)l.push(1==(1&r)),r>>=1;this.outs[0].set(l)}this.lastClk=t[2]},ii.prototype.setAsString=function(t,e){t=gt.sanitize(t),void 0===e&&(e=!0),e&&(this.data=[]);var i=t.split(/\s+/),n=0;for(var o in i){if((s=i[o]).indexOf(":")>=0){if(n=parseInt(s,16),isNaN(n))return"invalid input address"}else if(""!==s){var s=parseInt(s,16);if(isNaN(s))return"invalid input data";if(e){for(;this.data.length<n;)this.data.push(0);this.data[n]=s,n++}}}return e&&this.pending(),null},ii.prototype.clone=function(){var t=new ii;return t.data=this.data.slice(),t.size=this.size,t.copyFrom(this),t},ii.prototype.load=function(t){this.data=t.data,this.size=t.size,Y.prototype.load.call(this,t)},ii.prototype.save=function(){var t=Y.prototype.save.call(this);return t.data=this.data,t.size=this.size,t},ii.prototype.draw=function(t,e){var i=this.size/8;this.selectStyle(t,e),this.drawBox(t);var n=null!==this.lastAddress?b.toHex(this.lastAddress,4):"????",o=null!==this.lastData?b.toHex(this.lastData,2*i):"????????".substr(0,2*i);if(t.font="12px Times",t.textAlign="center",i<4?t.fillText(n+":"+o,this.x,this.y+this.height/2-18):(t.fillText(n+":",this.x,this.y+this.height/2-18-13),t.fillText(o,this.x,this.y+this.height/2-18)),t.fillText("memory",this.x,this.y+this.height/2-5),this.drawName(t,0,3),this.drawIO(t,e),this.badAddr){var s=t.strokeStyle;t.strokeStyle="#ff0000";var r=this.x-12,a=this.y-33;t.beginPath(),t.moveTo(r-6,a-6),t.lineTo(r+6,a+6),t.moveTo(r+6,a-6),t.lineTo(r-6,a+6),t.stroke(),t.strokeStyle=s}},ii.prototype.properties=function(t){for(var e=this,i="",n=0;n<this.data.length;n++)n%8==0&&(i.length>0&&(i+="\n"),i+=b.toHex(n,4)+":"),i+=" "+b.toHex(this.data[n],2);for(var o=new H(this,t),s=o.uniqueId(),r=o.uniqueId(),a='<div class="control">\n<label for="'.concat(s,'">Contents:\n<textarea class="code1" type="text" rows="9" name="').concat(s,'" id="').concat(s,'" spellcheck="false">').concat(i,'</textarea>\n</label>\n</div>\n<div class="control center">\n<label>Size: \n<select name="').concat(r,'" id="').concat(r,'">\n'),l=0,h=[8,16,32];l<h.length;l++){var c=h[l],u=this.size===c?" selected":"";a+='<option value="'.concat(c,'"').concat(u,">").concat(c,"</option>")}a+="</select>\n</label>\n</div>",o.extra(a,(function(){var t=document.getElementById(s).value;return e.setAsString(t,!1)}),(function(){e.size=document.getElementById(r).value;var t=document.getElementById(s).value;return e.setAsString(t)}),85),o.open()},ii.paletteImage=function(){var t=new ht(120,120),e=t.context;e.lineWidth=1.5,t.box(40,80);var i=t.width,n=t.height,o=18;t.io(0,-40,"n");var s=t.lineWidth(2);t.io(20,-18,"e"),t.io(-20,-18,"w"),t.io(-20,o,"w"),t.lineWidth(s);var r="20px Times";t.drawText("R",10,-13,r),t.drawText("A",-12,-13,r),t.drawText("W",-12,23,r);return e.beginPath(),e.moveTo(i/2-7,n/2-40),e.lineTo(i/2,n/2-33),e.lineTo(7+i/2,n/2-40),e.stroke(),t.drawText("memory",0,38,"8px Times"),t.drawText("0000:0000",0,32,"8px Times"),t};var ni=function(){Y.call(this),this.height=100,this.width=48,this.size=8,this.circuitOuts=[],this.addIn(-this.width/2,0,16,"In").bus=!0,this.ensureIO()};(ni.prototype=Object.create(Y.prototype)).constructor=ni,ni.prototype.prefix=null,ni.type="Decoder3",ni.label="3-to-8",ni.desc="3-to-8 Decoder",ni.img="decoder3.png",ni.description="<h2>3-to-8 decoder</h2>\n<p>Converts a 3-bit binary value on <strong>In</strong> to a true on one of eight output lines.</p>",ni.order=1e3,ni.prototype.compute=function(t){if(Array.isArray(t[0]))for(var e=(t[0][0]?1:0)+(t[0][1]?2:0)+(t[0][2]?4:0),i=0;i<this.size;i++)this.outs[i].set(i==e);else for(i=0;i<this.size;i++)this.outs[i].set(void 0)},ni.prototype.clone=function(){var t=new ni;return t.copyFrom(this),t},ni.prototype.ensureIO=function(){this.height=16*this.size+24,this.height<80&&(this.height=80);for(var t=this.width/2,e=this.size/2*16-8,i=0;i<this.size&&!(i>=this.outs.length);i++)this.outs[i].name="O"+i,this.outs[i].x=t,this.outs[i].y=e-16*i,this.outs[i].len=16;for(;i<this.size;i++)this.addOut(t,e-16*i,16,"O"+i);if(i<this.outs.length){for(;i<this.outs.length;i++)this.outs[i].clear();this.outs.splice(this.size)}},ni.prototype.draw=function(t,e){this.selectStyle(t,e);this.x,this.width,this.x,this.width,this.y,this.height,this.y,this.height;this.drawBox(t),t.font="12px Times",t.textAlign="center",t.fillText("decoder",this.x,this.y+this.height/2-2),this.drawIO(t,e)};var oi=function(t){Y.call(this,t),this.height=120,this.width=80,this.instruction="";var e=-32;this.addOut(this.width/2,e,16,"Ae").bus=!0,e+=16,this.addOut(this.width/2,e,16,"Be").bus=!0,e+=16,this.addOut(this.width/2,e,16,"ALUe").bus=!0,e+=16,this.addOut(this.width/2,e,16,"Im").bus=!0,e+=16,this.addOut(this.width/2,e,16,"C").bus=!0,e+=16,this.setAsString("nop")};(oi.prototype=Object.create(Y.prototype)).constructor=oi,oi.prototype.prefix="ID",oi.prototype.nameRequired=!0,oi.type="InstructionDecoder4",oi.label="Instruction Decoder 4",oi.desc="Instruction Decoder",oi.img="insdecoder4.png",oi.description="<h2>Instruction Decoder</h2><p>Simple example instruction decoder. Decodes assembly statements into register and ALU operations.</p>",oi.help="instructiondecoder4",oi.order=600,oi.prototype.compute=function(t){},oi.prototype.setAsString=function(t,e){this.instruction=t,void 0===e&&(e=!0);var i=this.instruction.toLowerCase().match(/\s*([a-zA-Z]*)(?:[\s,$]+([^\s,]+))?(?:[\s,$]+([^\s,]+))?(?:[\s,$]+([^\s,]+))?/);if(null===i||i.length<2)return"syntax error in input";var n=this.outs[0],o=this.outs[1],s=this.outs[2],r=this.outs[3],a=this.outs[4];function l(t){switch(t){case"r0":return"00";case"r1":return"01";case"r2":return"10";case"r3":return"11";default:return null}}function h(t){if(null==t)return null;if("#"!==t.substr(0,1))return null;var e=parseInt(t.substr(1));return e>7||e<-8?null:(0!=(8&e)?"1":"0")+(0!=(4&e)?"1":"0")+(0!=(2&e)?"1":"0")+(0!=(1&e)?"1":"0")}var c=i[1],u=i[2],d=i.length>3?i[3]:null,p=i.length>4?i[4]:null,f=l(u),v=l(d),m=l(p),y=h(d),g=h(p);function b(t){if(null===f||null===v||null===p)return null;if("#"===p.substr(0,1)){if(null===g)return"invalid immediate value";e&&(n.setAsString(v),o.setAsString("100"),s.setAsString("0"+f),a.setAsString(t),r.setAsString(g))}else null!==v&&e&&(n.setAsString(v),o.setAsString("0"+m),s.setAsString("0"+f),a.setAsString(t));return null}switch(c){case"nop":e&&(n.setAsString("00"),o.setAsString("000"),s.setAsString("100"),r.setAsString("0000"),a.setAsString("111"));break;case"mov":if(null===f)return null;if("#"===d.substr(0,1)){if(null===y)return"invalid immediate value";e&&(n.setAsString(f),o.setAsString("100"),s.setAsString("0"+f),a.setAsString("000"),r.setAsString(y))}else null!==v&&e&&(n.setAsString(f),o.setAsString("0"+v),s.setAsString("0"+f),a.setAsString("000"));break;case"add":return b("001");case"sub":return b("010");case"and":return b("011");case"or":return b("100");case"sll":return b("101");case"sla":return b("110");default:return"invalid opcode"}return null},oi.prototype.clone=function(){var t=new oi;return t.copyFrom(this),t},oi.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;t.beginPath(),t.moveTo(i,o),t.lineTo(i,s),t.lineTo(n,s),t.lineTo(n,o),t.lineTo(i,o),t.font="12px Times",t.textAlign="center",t.fillText("instruction",this.x,this.y+this.height/2-14),t.fillText("decoder",this.x,this.y+this.height/2-2),t.fillText(this.instruction,this.x,this.y-this.height/2+11),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x-15,this.y+3)),t.stroke(),this.drawIO(t,e)},oi.prototype.properties=function(t){var e=this,i=this.instruction,n=new H(this,t),o=n.uniqueId(),s="<p>Value<br>"+'<input type="text" id="'.concat(o,'" spellcheck="false" value="').concat(i,'"></p>');n.extra(s,(function(){var t=document.getElementById(o).value;return e.setAsString(t,!1)}),(function(){var t=document.getElementById(o).value;e.setAsString(t)}),40),n.open();var r=document.getElementById(o);r.select(),r.focus()};var si=function(t){Y.call(this,t),this.height=128,this.width=64,this.shrink=15,this.cin=!1;var e=-this.width/2,i=this.width/2;this.operator="";this.addIn(e,-32,16,"A").bus=!0,this.addIn(e,32,16,"B").bus=!0;var n=.5*this.shrink,o=this.addIn(0,this.height/2-n,8+n,"C");o.orientation="s",o.bus=!0,this.addIn(e,48,16,"Cin"),this.addOut(i,0,16,"O").bus=!0,this.addOut(i,24,16,"CPSR").bus=!0};(si.prototype=Object.create(Y.prototype)).constructor=si,si.prototype.prefix="ALU",si.prototype.nameRequired=!0,si.type="Alu16",si.label="ALU 16",si.desc="Simple 16-bit ALU",si.img="alu.png",si.description="<h2>16-bit ALU</h2><p>Simple example 16-bit ALU. A and B are bus inputs to the ALU. C is the control input. Cin is the carry input for adc and sbc operations. O is a bus output result and CPSR is the status output bits for the current program status register.</p><p>If Cin is not connected, it is assumed to be false.</p><p>The status bits in CPSR are: 0:N, 1:Z, 2:C, 3:V</p>",si.help="alu16",si.order=706,si.prototype.compute=function(t){var e=t[0],i=t[1],n=t[2];function o(t){if(void 0!==t&&Array.isArray(t)){var e=1,i=0;return t.forEach((function(t){void 0!==t&&(t&&(32768==e?i-=e:i+=e),e*=2)})),i}}this.cin=void 0!==t[3]&&t[3];var s=o(e),r=o(i),a=r,l=!1,h=!1;switch(o(n)){case 8:case 0:a=s&r,this.operator="&";break;case 1:a=s^r,this.operator="xor";break;case 2:a=s<<r,this.operator="<<";break;case 3:a=(65535&s)>>r,this.operator=">>";break;case 4:var c=32768&s;a=s;for(var u=0;u<r;u++)a=s>>1,a|=c;this.operator="asr";break;case 5:a=s+r,this.cin&&a++,l=0!=(65536&(f=(65535&s)+(65535&r))),h=a<-32768||a>32768,this.operator="+";break;case 11:case 34:case 16:l=0!=(65536&(f=(65535&s)+(65535&r))),h=(a=s+r)<-32768||a>32768,this.operator="+";break;case 6:a=s-r,this.cin||a--,l=0!=(65536&(f=(65535&s)+(65535&~r)+1)),h=a<-32768||a>32768,this.operator="-";break;case 10:case 33:case 35:case 17:l=0!=(65536&(f=(65535&s)+(65535&~r)+1)),h=(a=s-r)<-32768||a>32768,this.operator="-";break;case 7:c=32768&s;a=65535&s;for(u=0;u<r;u++){var d=(1&a)<<15;a=(65535&s)>>1,a|=d}this.operator="ror";break;case 9:a=-r,this.operator="neg";break;case 12:a=s|r,this.operator="or";break;case 13:h=(a=s*r)<-32768||a>32768,this.operator="*";break;case 14:a=s&(65535^r),this.operator="bic";break;case 15:a=65535^s,this.operator="not";break;case 18:a=(s&=65535)*(r&=65535)>>16,this.operator="*^";break;default:a=r,this.operator="mov"}if(void 0===(a&=65535))this.outs[0].set([void 0,void 0,void 0,void 0]),this.outs[1].set([void 0,void 0,void 0,void 0]);else{var p=[],f=a;for(u=0;u<16;u++)p.push(1==(1&f)),f>>=1;this.outs[0].set(p),this.outs[1].set([p[15],0==a,l,h])}},si.prototype.clone=function(){var t=new si;return t.copyFrom(this),t},si.prototype.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;if(t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-this.shrink/2),t.lineTo(i+20,this.y),t.lineTo(i,this.y+this.shrink/2),t.lineTo(i,s),t.lineTo(n,s-this.shrink),t.lineTo(n,o+this.shrink),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-16)),this.operator.length>1)t.font="bold 14px Times",t.textAlign="center",t.fillText(this.operator,this.x+1,this.y+4);else{t.font="bold 22px Times",t.textAlign="center";var r=6;switch(this.operator){case"+":r=6;break;case"-":r=5}t.fillText(this.operator,this.x+1,this.y+r)}t.stroke(),this.drawIO(t,e)};var ri=function(){Y.call(this),this.height=98,this.width=48;var t=this.width/2,e=this.height/2;this.value=0,this.size=16,this.lastClk=!1;var i=this.addIn(0,-e,8);i.orientation="n",i.clock=!0,this.addIn(-t,-24,8,"UP"),this.addIn(0,e,8,"R").orientation="s",this.addOut(t,-24,8,"C").bus=!0,this.set(0)};(ri.prototype=Object.create(Y.prototype)).constructor=ri,ri.prototype.prefix="C",ri.type="Counter",ri.label="Counter",ri.desc="Simple Counter",ri.description="<h2>Simple Counter</h2><p>Supports up and down counting for \narbitrary bit sizes. C is the count output. The optional UP input controls the counting\ndirection. True means up counting. If not connected, the counter counts up. R is an \nasynchronous reset. The counter increments or decrements on the clock leading edge.</p>",ri.order=406,ri.help="Counter",ri.prototype.compute=function(t){t[2]?this.set(0):t[0]&&!this.lastClk&&(!1!==t[1]?this.set(this.value+1):this.set(this.value-1)),this.lastClk=t[0]},ri.prototype.set=function(t){this.value=t;for(var e=0,i=0;i<this.size;i++)e=e<<1|1;this.value&=e;for(var n=this.value,o=[],s=0;s<this.size;s++)o.push(1==(1&n)),n>>=1;this.outs[0].set(o)},ri.prototype.clone=function(){var t=new ri;return t.size=this.size,t.copyFrom(this),t},ri.prototype.load=function(t){this.size=t.size,Y.prototype.load.call(this,t),this.set(0)},ri.prototype.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t},ri.prototype.draw=function(t,e){this.selectStyle(t,e),this.drawBox(t);var i=this.y;t.font='14px "Lucida Console", Monaco, monospace',t.textAlign="center",this.size>12?t.fillText(b.toHex(this.value,4),this.x,i):this.size>8?t.fillText(b.toHex(this.value,3),this.x,i):this.size>4?t.fillText(b.toHex(this.value,2),this.x,i):t.fillText(b.toBinary(this.value,this.size),this.x,i),i+=25,t.font="14px Times",t.fillText("counter",this.x,i),this.drawIO(t,e)},ri.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o='<div class="control1 center gap"><label for="'.concat(n,'">Size in bits: </label>\n<input class="number" type="text" name="').concat(n,'" id="').concat(n,'" value="').concat(this.size,'"></div>');i.extra(o,(function(){var t=parseInt(document.getElementById(n).value);return isNaN(t)||t<2||t>16?(document.getElementById(n).select(),"Must be an integer from 2 to 16"):null}),(function(){e.size=parseInt(document.getElementById(n).value),e.set(e.value)})),i.open()},ri.paletteImage=function(){var t=new ht(60,44);return t.box(16,32),t.io(8,-8,"e"),t.io(-8,-8,"w"),t.io(0,16,"s"),t.clock(0,-16,"n"),t.drawText("0000",0,2,"6px Times"),t.drawText("Counter",0,10,"4px Times"),t};var ai=function(){Y.call(this),Object.defineProperties(this,{height:{value:32},width:{value:96},outputSize:{value:16,writable:!0},arithmetic:{value:!1,writable:!0},shift:{value:0,writable:!0}}),this.addIn(-48,8,16).bus=!0,this.addOut(48,0,16).bus=!0};(ai.prototype=Object.create(Y.prototype)).constructor=ai,ai.prototype.prefix=null,ai.type="Extend",ai.label="Extend",ai.desc="Bus Extend",ai.description="<h2>Extend</h2><p>The Extend component extends a \nbus to a larger size. A common use is to extend an immediate value \nfrom an instruction to 16 or 32 bits.</p>\n<p>The output can be optionally shifted left by a fixed number of bits.</p>",ai.order=311,ai.help="extend",ai.prototype.clone=function(){var t=new ai;return t.copyFrom(this),t.outputSize=this.outputSize,t.arithmetic=this.arithmetic,t.shift=this.shift,t},ai.prototype.compute=function(t){if(void 0!==t[0]){for(var e=[],i=0;i<this.shift;i++)e.push(0);for(var n=0,o=0;n<t[0].length&&i<this.outputSize;n++,i++)e.push(t[0][n]),o=t[0][n];for(;i<this.outputSize;i++)e.push(this.arithmetic?o:0);this.outs[0].set(e)}else this.outs[0].set(void 0)},ai.prototype.draw=function(t,e){this.outlinePath(t),t.fillStyle="#ffffff",t.fill(),this.selectStyle(t,e),t.stroke(),t.font="14px Times",t.textAlign="center",t.fillText("Extend",this.x,this.y+10),this.drawIO(t,e)},ai.prototype.outlinePath=function(t){var e=this.x-this.width/2-.5,i=this.x+this.width/2+.5,n=this.y-this.height/2-.5,o=this.y-.5,s=this.y+this.height/2+.5;t.beginPath(),t.moveTo(e,o),t.lineTo(e,s),t.lineTo(i,s),t.lineTo(i,n),t.lineTo(e,o)},ai.prototype.save=function(){var t=Y.prototype.save.call(this);return t.outputSize=this.outputSize,t.arithmetic=this.arithmetic,t.shift=this.shift,t},ai.prototype.load=function(t){this.outputSize=t.outputSize,this.arithmetic=t.arithmetic,this.shift=t.shift,Y.prototype.load.call(this,t)},ai.prototype.properties=function(t){var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),s=i.uniqueId(),r='<div class="control1 center gap">\n<label>Output size (bits): \n<input class="number" type="text" name="'.concat(n,'" id="').concat(n,'" value="').concat(this.outputSize,'" spellcheck="false" onfocus="this.select()">\n</label>\n</div>\n<div class="control1 center gap">\n<label>Output shift (bits): \n<input class="number" type="text" name="').concat(s,'" id="').concat(s,'" value="').concat(this.shift,'" spellcheck="false" onfocus="this.select()">\n</label>\n</div>\n<div class="control1 center gap">\n<label for="').concat(o,'"><input type="checkbox" id="').concat(o,'" name="').concat(o,'"').concat(this.arithmetic?" checked":"","> Arithmetic extend</label>\n</div>");i.extra(r,(function(){var t=document.getElementById(n).value,e=parseInt(t);if(isNaN(e)||e<1||e>32)return document.getElementById(n).select(),"Invalid output size, must be 1 to 32";document.getElementById(s).value;var i=parseInt(t);return isNaN(i)||i<0||i>e?(document.getElementById(s).select(),"Invalid shift size, must be 0 to the bit size."):null}),(function(){e.arithmetic=document.getElementById(o).checked;var t=document.getElementById(n).value;e.outputSize=parseInt(t);var i=document.getElementById(s).value;e.shift=parseInt(i),e.pending()})),i.open(),document.getElementById(n).select()},ai.paletteImage=function(){var t=new ht(60,44),e=t.width/2,i=t.height/2,n=e-20-.5,o=e+20+.5,s=i-8-.5,r=i,a=i+8+.5;return t.context.beginPath(),t.context.moveTo(n,r),t.context.lineTo(o,s),t.context.lineTo(o,a),t.context.lineTo(n,a),t.context.lineTo(n,r),t.fillStroke(),t.io(20,0,"e"),t.io(-20,4,"w"),t.drawText("Extend",0,7,"8px Times"),t};var li=function t(e){this.message=e,"captureStackTrace"in Error?Error.captureStackTrace(this,t):this.stack=(new Error).stack};function hi(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return ci(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ci(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw s}}}}function ci(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}(li.prototype=Object.create(Error.prototype)).name="InvalidArgumentException",li.prototype.constructor=li;var ui=function t(e){var i=this;Y.call(this,e);var n=16,o=void 0;this.draw=function(t,e){this.selectStyle(t,e);var i=this.x-this.width/2-.5,n=this.x+this.width/2+.5,o=this.y-this.height/2-.5,s=this.y+this.height/2+.5;if(t.beginPath(),t.moveTo(i,o),t.lineTo(i,this.y-7.5),t.lineTo(i+20,this.y),t.lineTo(i,this.y+7.5),t.lineTo(i,s),t.lineTo(n,s-15),t.lineTo(n,o+15),t.lineTo(i,o),null!==this.naming&&(t.font="14px Times",t.textAlign="center",t.fillText(this.naming,this.x,this.y-16)),this.operator.length>1)t.font="bold 14px Times",t.textAlign="center",t.fillText(this.operator,this.x+1,this.y+4);else{t.font="bold 22px Times",t.textAlign="center";var r=6;switch(this.operator){case"+":r=6;break;case"-":r=5}t.fillText(this.operator,this.x+1,this.y+r)}t.stroke(),this.drawIO(t,e)},this.clone=function(){var e=new t;return e.copyFrom(this),e.size=this.size,e.output=this.output,e.control=this.control,e},this.load=function(t){this.size=t.size,this.output=t.output,this.control=t.control,Y.prototype.load.call(this,t)},this.save=function(){var t=Y.prototype.save.call(this);return t.size=this.size,t.output=this.output,t.control=this.control,t},this.controlMapping=function(e){if(this.control===t.CONTROL.ASAO)switch(e&=3){case 0:e=11;break;case 1:e=17;break;case 2:e=0;break;case 3:e=12}return e},function(){Object.defineProperties(i,{size:{get:function(){return n},set:function(t){if(![4,8,16,32].includes(+t))throw new li("Illegal size value "+t);n=+t}},height:{value:128},width:{value:64},output:{get:function(){return o},set:function(e){if(!t.OUTPUT.POSSIBLE.includes(+e))throw new li("Illegal output value "+e);if(o!==+e){o=+e;var i=this.outs[1];i.clear(),i.bus=o===t.OUTPUT.CPSR,i.name=t.OUTPUT.LABELS[o]}}},control:{value:t.CONTROL.THUMB,writable:!0}}),i.cin=!1;var e=-i.width/2,s=i.width/2;i.operator="";i.addIn(e,-32,16,"A").bus=!0,i.addIn(e,32,16,"B").bus=!0;var r=i.addIn(0,i.height/2-7.5,15.5,"C");r.orientation="s",r.bus=!0,i.addIn(e,48,16,"Cin"),i.addOut(s,0,16,"O").bus=!0,i.addOut(s,24,16,"CPSR").bus=!0,i.output=t.OUTPUT.CPSR}()};(ui.prototype=Object.create(Y.prototype)).constructor=ui,ui.prototype.prefix="ALU",ui.prototype.nameRequired=!0,ui.type="Alu",ui.label="ALU",ui.desc="Arithmetic Logic Unit",ui.img="alu.png",ui.description="<h2>Arithmetic Logic Unit</h2><p>A and B are bus inputs \nto the ALU. C is the control input. Cin is the carry input for adc and sbc \noperations. O is a bus output result.</p>\n<p>If Cin is not connected, it is assumed to be false.</p>\n<p>The status bits in CPSR are: 0:N, 1:Z, 2:C, 3:V</p>",ui.help="alu",ui.order=707,ui.OUTPUT={CPSR:0,N:1,Z:2,C:3,V:4,POSSIBLE:[0,1,2,3,4],NAMES:["CPSR","N - Negative","Z - Zero","C - Carry","V - Overflow"],LABELS:["CPSR","N","Z","Cout","V"]},ui.CONTROL={THUMB:0,ASAO:1,POSSIBLE:[0,1],NAMES:["Thumb (4 or 6 bits)","Add/subtract/and/or"]},ui.prototype.compute=function(t){for(var e=t[0],i=t[1],n=t[2],o=this.size,s=o/8,r=0,a=0;a<s;a++)r<<=8,r|=255;var l=1<<o-1,h=l-1,c=-h-1;function u(t){if(void 0!==t&&Array.isArray(t)){var e,i=1,n=0,o=hi(t);try{for(o.s();!(e=o.n()).done;){var s=e.value;if(void 0===s)return;s&&(i===l?n-=i:n+=i),i*=2}}catch(t){o.e(t)}finally{o.f()}return n}}this.cin=void 0!==t[3]&&t[3];var d,p=u(e),f=u(i),v=f,m=!1,y=!1;switch(this.controlMapping(u(n))){case 8:case 0:v=p&f,this.operator="&";break;case 1:v=p^f,this.operator="xor";break;case 2:v=p<<f,this.operator="<<";break;case 3:v=(p&r)>>f,this.operator=">>";break;case 4:d=p&1<<o-1,v=p;for(var g=0;g<f;g++)v=p>>1,v|=d;this.operator="asr";break;case 5:v=p+f,this.cin&&v++,m=0!=((p&r)+(f&r)&1<<o),y=v<c||v>h,this.operator="+";break;case 11:case 34:case 16:m=0!=((p&r)+(f&r)&1<<o),y=(v=p+f)<c||v>h,this.operator="+";break;case 6:v=p-f,this.cin||v--,m=0!=((p&r)+(~f&r)+1&1<<o),y=v<c||v>h,this.operator="-";break;case 10:case 33:case 35:case 17:m=0!=((p&r)+(~f&r)+1&1<<o),y=(v=p-f)<c||v>h,this.operator="-";break;case 7:d=p&l,v=p&r;for(var b=0;b<f;b++){var w=(1&v)<<o-1;v=(p&r)>>1,v|=w}this.operator="ror";break;case 9:v=-f,this.operator="neg";break;case 12:v=p|f,this.operator="or";break;case 13:y=(v=p*f)<c||v>h,this.operator="*";break;case 14:v=p&(f^r),this.operator="bic";break;case 15:v=p^r,this.operator="not";break;case 18:v=(p&r)*(f&r)>>o,this.operator="*^";break;default:v=f,this.operator="mov"}var x=[];if(void 0===(v&=r)){for(var T=0;T<o;T++)x.push(void 0);this.output===ui.OUTPUT.CPSR?this.outs[1].set([void 0,void 0,void 0,void 0]):this.outs[1].set(void 0)}else{for(var I=v,S=0;S<o;S++)x.push(1==(1&I)),I>>=1;switch(this.output){case ui.OUTPUT.CPSR:this.outs[1].set([x[o-1],0===v,m,y]);break;case ui.OUTPUT.N:this.outs[1].set(x[o-1]);break;case ui.OUTPUT.Z:this.outs[1].set(0===v);break;case ui.OUTPUT.C:this.outs[1].set(m);break;case ui.OUTPUT.V:this.outs[1].set(y)}}this.outs[0].set(x)},ui.prototype.properties=function(t){for(var e=this,i=new H(this,t),n=i.uniqueId(),o=i.uniqueId(),s=i.uniqueId(),r='<div class="control-table"><div class="control">\n<label for="'.concat(n,'">Size:</label>\n<select name="').concat(n,'" id="').concat(n,'">'),a=0,l=[4,8,16,32];a<l.length;a++){var h=l[a],c=this.size===h?" selected":"";r+='<option value="'.concat(h,'"').concat(c,">").concat(h,"</option>")}r+='</select>\n</div>\n<div class="control">\n        <label>Secondary Output:</label>\n        <select class="auto" name="'.concat(o,'" id="').concat(o,'">');var u,d=hi(ui.OUTPUT.POSSIBLE);try{for(d.s();!(u=d.n()).done;){var p=u.value,f=this.output===p?" selected":"",v=ui.OUTPUT.NAMES[p];r+='<option value="'.concat(p,'"').concat(f,">").concat(v,"</option>")}}catch(t){d.e(t)}finally{d.f()}r+='</select>\n</div>\n<div class="control">\n<label>Control:</label>\n<select class="auto" name="'.concat(s,'" id="').concat(s,'">');var m,y=hi(ui.CONTROL.POSSIBLE);try{for(y.s();!(m=y.n()).done;){var g=m.value,b=this.control===g?" selected":"",w=ui.CONTROL.NAMES[g];r+='<option value="'.concat(g,'"').concat(b,">").concat(w,"</option>")}}catch(t){y.e(t)}finally{y.f()}r+="</select>\n</div></div>",i.extra(r,(function(){return null}),(function(){return e.size=document.getElementById(n).value,e.output=document.getElementById(o).value,null}),85),i.open()};var di=function(){};di.go=function(t){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?t():document.addEventListener("DOMContentLoaded",t)};var pi=function(t,e){var n,o=this,s=i(75456);this.version=s.version,this.root=i.p,this.sel=t,this.options=new re(e),this.components=new ae,(n=this.components).add(le),n.add(he),n.add(be),n.add(we),n.add(ce),n.add(ve),n.add(me),n.add(ye),n.add(ue),n.add(de),n.add(pe),n.add(fe),n.add(Se),n.add(Te),n.add(Le),n.add(Ie),n.add(xe),n.add(Pe),n.add(Ye),n.add(We),n.add(Fe),n.add(He),n.add(Xe),n.add(ke),n.add(Oe),n.add(Ae),n.add(Me),n.add(qe),n.add(Ce),n.add(ze),n.add(ai),n.add(Ee),n.add(Be),n.add(Ze),n.add(ri),n.add($e),n.add(_e),n.add(je),n.add(De),n.add(Ue),n.add(Ve),n.add(oi),n.add(Ge),n.add(Re),n.add(ti),n.add(ei),n.add(ii),n.add(si),n.add(ui),n.add(ni),n.addPalette("combinatorial",[ue,ce,Te,Se,ye,fe]),n.addPalette("sequential",[Fe,He,Xe,We,Ye]),n.addPalette("bus",[ke,Ae,Ce,ze,Ee,Be]),n.addPalette("all",[le,he,be,we,xe,Le,Ie,Pe,ue,de,pe,fe,ce,ve,me,ye,_e,Te,Se,Fe,He,Xe,We,Ye,ke,Ae,Oe,Ce,Ee,ze,ai,Be,je,De,Ue,Me,qe,Ze,Ve,Ge,Re,ti,ii,oi,$e,ui,ri]);var r=[],a=[];this.start=function(){if(null===t)return o.startNow();di.go((function(){o.startNow()}))},this.startNow=function(){if(null===t){o.options.display="none";var e=new se(o,null,a);return r.push(e),e}if(t instanceof Element){var n=new se(o,t,a);r.push(n)}else for(var s=document.querySelectorAll(t),l=0;l<s.length;l++){var h=s[l],c=new se(o,h,a);r.push(c)}return 1===r.length?(null!==o.options.global&&(i.g[o.options.global]=r[0]),r[0]):null},this.getInstances=function(){return r},this.addTest=function(t){a.push(t)},this.runTest=function(t){r.forEach((function(e){e.runTest(t)}))}},fi=i(43700),vi={};vi.styleTagTransform=f(),vi.setAttributes=c(),vi.insert=l().bind(null,"head"),vi.domAPI=r(),vi.insertStyleElement=d();o()(fi.Z,vi);fi.Z&&fi.Z.locals&&fi.Z.locals;pi.Cirsim=pi,di.go((function(){for(var t=document.querySelectorAll("div.cirsim-install"),e=0;e<t.length;e++){var i=t[e];i.classList.remove("cirsim-install");var n=JSON.parse(i.textContent);i.innerHTML="",new pi(i,n).startNow(),i.style.display="block"}})),i.g.Cirsim=pi;var mi=function(){};mi.create=function(t){function e(){for(var t=document.querySelectorAll("div.cirsim-install"),e=0;e<t.length;e++){var i=t[e],n=JSON.parse(i.textContent);i.innerHTML="",new pi(i,n).startNow(),i.style.display="block",i.classList.remove("cirsim-install")}}t.start((function(){e()})),t.messageListener((function(t,i){switch(t){case"cl-quiz-after-installed":case"cl-grades-grader-installed":e()}}))};mi.create(Site.Site)},43700:(t,e,i)=>{"use strict";i.d(e,{Z:()=>d});var n=i(3041),o=i.n(n),s=i(52281),r=i.n(s),a=i(37710),l=i.n(a),h=new URL(i(84324),i.b),c=r()(o()),u=l()(h);c.push([t.id,`div.cirsim div.toast{position:absolute;bottom:0;visibility:hidden;transform:translateY(2.3em);z-index:400;transition:all .4s ease-in-out 0s,visibility 0s linear .4s,z-index 0s linear .01s;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:1.1em;left:calc(50% - 30em/2);width:30em;background-color:#151515;color:#fff;text-align:center;border-top-left-radius:10px;border-top-right-radius:10px;padding:.5em}div.cirsim div.toast.toast-active{visibility:visible;transform:translateY(0%);transition-delay:0s,0s,.4s;z-index:400}div.cirsim nav.menubar{position:relative;z-index:100;margin:0;border:0;padding:0;background-color:#f0f3f0;border-bottom:thin solid gray;font-size:.9rem}div.cirsim nav.menubar li:hover{background:#00796b}div.cirsim nav.menubar li{user-select:none;cursor:pointer}div.cirsim nav.menubar li a,div.cirsim nav.menubar li a:link,div.cirsim nav.menubar li a:visited{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.9rem;color:#000;text-decoration:none}div.cirsim nav.menubar>ul{list-style-type:none;margin:0;border:0;padding:0}div.cirsim nav.menubar>ul img.check{vertical-align:baseline;width:19px;height:16px;content:url(${u})}div.cirsim nav.menubar>ul>li{display:inline-block;margin:0;border:0;padding:.25em 2em .25em .5em;position:relative}div.cirsim nav.menubar>ul>li a,div.cirsim nav.menubar>ul>li a:link,div.cirsim nav.menubar>ul>li a:visited{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.9rem;color:#000;text-decoration:none}div.cirsim nav.menubar>ul ul{visibility:hidden;opacity:0;transform:translateY(-2em);z-index:-1;transition:all .2s ease-in-out 0s,visibility 0s linear .2s,z-index 0s linear .01s;list-style-type:none;position:absolute;overflow:hidden;left:0;top:100%;margin:1px 0 0 0;background-color:#f0f3f0;padding:0;border:1px solid gray;border-top-width:0}div.cirsim nav.menubar>ul ul>li{padding:0 5px;margin:0;overflow:hidden}div.cirsim nav.menubar>ul ul>li a{display:inline-block;width:8em;padding-top:5px;padding-bottom:5px}div.cirsim nav.menubar>ul ul>li.menu-disabled a{opacity:.3}div.cirsim nav.menubar>ul ul.menu-open{visibility:visible;opacity:1;z-index:100;transform:translateY(0%);transition-delay:0s,0s,.2s}div.cirsim nav.menubar>ul ul.edit-menu a{width:6em}div.cirsim nav.menubar>ul ul.option-menu a{width:11em}div.cirsim nav.menubar>ul ul.help-menu a{width:7.5em}div.cirsim nav.menubar>ul .ul-state-active{color:red}div.cirsim nav.menubar>ul li.menu-divider{height:1px;border:0 solid #000;border-top-width:1px}div.cirsim div.cs-palette{position:absolute;left:0;top:0;bottom:0;box-sizing:border-box;width:83px;background:#fff;border-right:1px solid #000;padding:1em 5px;z-index:5;overflow-y:scroll;overflow-x:hidden;cursor:pointer;-moz-user-select:-moz-none;-webkit-user-select:none;-ms-user-select:none;user-select:none}div.cirsim div.cs-palette div.cs-item{position:relative;min-height:60px;border-bottom:thin solid #ddd;align-items:center;display:flex}div.cirsim div.cs-palette div.cs-item div.cs-box{vertical-align:middle;margin:0;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none}div.cirsim div.cs-palette div.cs-item div.cs-box div.cs-img{margin:0;padding:0;border:0;line-height:0}div.cirsim div.cs-palette div.cs-item div.cs-box img{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border:0;margin:0}div.cirsim div.cs-palette div.cs-item div.cs-box div.cs-desc{display:block;font-style:normal;font-weight:bold;padding:0;margin:0;text-align:center;font-size:.8em}div.cirsim div.cs-palette div.cs-item div.cs-box div.long{font-size:.65em}div.cirsim div.cs-palette figure{position:relative;top:50%;transform:translateY(-50%);margin:0;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border-bottom:thin solid #ddd}div.cirsim div.cs-palette figure img{-moz-box-shadow:none;-webkit-box-shadow:none;box-shadow:none;border:0;margin:0}div.cirsim div.cs-palette figure figcaption{font-style:normal;font-weight:bold;padding:0;margin:0;text-align:center}div.cirsim div.cs-palette figure figcaption.long{font-size:.65em}.cirsim-dialog-titlebar{position:absolute;top:50%;width:20px;margin:-10px 0 0 0;padding:1px;height:20px}.cirsim-home{right:calc(.6em + 20px)}.cirsim-back{right:calc(.9em + 40px)}.cirsim-help{position:relative;width:100%;max-width:100%;padding:.5em}.cirsim-help p:first-child{margin-top:0}.cirsim-help figure{text-align:center;overflow-x:auto;margin:1em 0}.cirsim-help figure img{box-shadow:none;border:0;padding:0;margin:0}.cirsim .help-div{padding:0;border-left:1px solid #aaa;border-right:1px solid #aaa;background-color:#fff}.cirsim .help-div div.header{box-sizing:border-box;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:bold;background-color:#009688;color:#000;width:100%;padding:0;margin:0;border:0;z-index:20;height:25px;display:flex;flex-direction:row;flex-wrap:nowrap}.cirsim .help-div div.header h1{flex-grow:1;margin:0;padding:4px 4px 0 10px;font-family:"Trebuchet MS",Helvetica,sans-serif;font-size:16px;line-height:16px;user-select:none}.cirsim .help-div div.header button{box-size:border-box;flex:0 0 25px;width:25px;height:25px;padding:0;margin:0;border:0;background:none;outline:none}.cirsim .help-div div.header button:hover{background-color:#e81123;cursor:pointer}div.cirsim div.work{position:absolute;width:100%;left:0;top:1.53em;right:0;bottom:0;background:#000}div.cirsim-install{display:none}div.cirsim .cirsim-overlay{position:absolute;left:0;right:0;top:0;bottom:0;background:#a00;opacity:.05;z-index:2000;display:none}div.cirsim div.main{line-height:normal;font-size:1rem;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}div.cirsim div.help-div{line-height:normal;font-size:1rem;display:none}div.cirsim.docked-help .main{position:absolute;top:0;left:0;right:325px;bottom:0}div.cirsim.docked-help .help-div{display:block;box-sizing:border-box;position:absolute;top:0;bottom:0;right:0;width:325px;overflow:auto}div.cirsim-full{position:absolute;left:0;right:0;top:0;bottom:0;background:#fff}div.cirsim-inline{position:relative;margin:0;border:0;padding:0;background:#fff;overflow:hidden}div.cirsim-inline div{text-align:center}div.cirsim-inline canvas{margin:0 auto}div.cirsim-window{position:relative;width:100%;height:600px;margin:0;border-left:0;border-right:0;padding:0;border-top:thin solid #aaa;background:#fff;min-height:100px;min-width:800px}div.cirsim.height300{height:300px}div.cirsim div.cirsim-dlg-content{position:relative;padding:.5em;font-size:.95em}div.cirsim div.cirsim-dlg-content input{padding:3px;box-sizing:border-box;font-size:1.1em}div.cirsim div.cirsim-dlg-content h2{margin:.75em 0}div.cirsim div.cirsim-dlg-content form{position:relative;height:100%}div.cirsim div.cirsim-dlg-content .large{font-size:1.2em}div.cirsim div.cirsim-dlg-content fieldset{position:relative;border:0;margin:0;padding:0;height:100%;min-width:0;max-width:100%}div.cirsim div.cirsim-dlg-content p.error{margin:1em 0 0 0;text-align:center;color:red;font-size:.9em;font-style:italic}div.cirsim div.cirsim-dlg-content div.control{position:relative;margin:0 0 1em 0}div.cirsim div.cirsim-dlg-content div.control div.left{text-align:left}div.cirsim div.cirsim-dlg-content div.control label{display:block;font-style:italic;margin:.2em 0 .1em 0}div.cirsim div.cirsim-dlg-content div.control input{display:block}div.cirsim div.cirsim-dlg-content div.control input[type=text],div.cirsim div.cirsim-dlg-content div.control input[type=file]{width:100%}div.cirsim div.cirsim-dlg-content div.control input[type=radio]{display:inline-block}div.cirsim div.cirsim-dlg-content div.control input[type=range]{width:100%}div.cirsim div.cirsim-dlg-content div.control p.selector{text-align:center}div.cirsim div.cirsim-dlg-content div.control select{width:6em}div.cirsim div.cirsim-dlg-content div.control select.auto{width:auto}div.cirsim div.cirsim-dlg-content div.control select.files{width:100%}div.cirsim div.cirsim-dlg-content div.control div.notice{position:absolute;width:100%;left:0;top:45%;text-align:center;font-style:italic;color:#8b4513}div.cirsim div.cirsim-dlg-content div.control textarea{width:100%}div.cirsim div.cirsim-dlg-content div.control div.choosers{display:inline-block;text-align:left}div.cirsim div.cirsim-dlg-content div.control1{margin:0 0 1em 0}div.cirsim div.cirsim-dlg-content div.control1 label{display:inline-block;font-style:italic;padding-right:.5em}div.cirsim div.cirsim-dlg-content div.control1 select{width:6em}div.cirsim div.cirsim-dlg-content div.control1 input.number{width:2em;text-align:center}div.cirsim div.cirsim-dlg-content div.control1 input.compname{width:4em}div.cirsim div.cirsim-dlg-content div.control1 input.tabname{width:6em}div.cirsim div.cirsim-dlg-content div.control1 select.auto{width:auto}div.cirsim div.cirsim-dlg-content div.control-table{margin:0 auto;display:table}div.cirsim div.cirsim-dlg-content div.control-table div.control{display:table-row;height:2em}div.cirsim div.cirsim-dlg-content div.control-table div.control label{display:table-cell;text-align:right;padding-right:.5em}div.cirsim div.cirsim-dlg-content div.control-table div.control select{display:table-cell}div.cirsim div.cirsim-dlg-content div.center{text-align:center}div.cirsim div.cirsim-dlg-content div.indent{margin-left:20px;margin-right:20px}div.cirsim div.cirsim-dlg-content h1{margin:0 0 .5em 0}div.cirsim div.cirsim-dlg-content p,div.cirsim div.cirsim-dlg-content li{color:#606060}div.cirsim div.cirsim-dlg-content .gap{margin-top:1em}div.cirsim.about{width:400px;text-align:center}div.cirsim.about img{width:171px;height:75px}div.cirsim.about div.cirsim-dlg-content{padding:1em}div.cirsim.about figure img{box-shadow:none}div.cirsim.help{width:500px;height:600px}div.cirsim.component a.helper{display:block;position:absolute;right:.5em;top:.5em;float:right;color:#606060;font-style:italic;text-decoration:underline;cursor:pointer;font-size:.85em;padding:0}div.cirsim .cirsim-error{color:red}div.cirsim-dialog{padding:1em;font-size:.95em}div.cirsim table{margin-left:auto;margin-right:auto;border-collapse:separate;border-spacing:0;font-size:.9em}div.cirsim table th{color:#fff;background:#18453b;background:linear-gradient(#18453B, #73d189);text-shadow:rgba(0,0,0,.4) 0 1px 0;border-right:1px solid #c1dad7;border-bottom:1px solid #c1dad7;border-top:1px solid #c1dad7;letter-spacing:1px;text-align:left;padding:2px 6px;font-family:Helvetica,Arial,sans-serif;text-decoration:none;vertical-align:bottom}div.cirsim table th a:link{color:#f5f3eb}div.cirsim table th a:visited{color:#e3dcc5}div.cirsim table th a:hover{color:#fff}div.cirsim table th.width40{width:20%}div.cirsim table th.width40em{width:40em}div.cirsim table th.width20em{width:20em}div.cirsim table td{border-right:1px solid #c1dad7;border-bottom:1px solid #c1dad7;background:#fff;padding:.25em .75em;color:#4f6b72}div.cirsim table td a,div.cirsim table td a:link,div.cirsim table td a:visited,div.cirsim table td a:hover{text-decoration:underline}div.cirsim table td a:link{color:#8a8a8a}div.cirsim table td a:visited{color:#b09d5b}div.cirsim table td a:hover{color:#36c}div.cirsim table.center td,div.cirsim table.center th{text-align:center}div.cirsim table.truth-table th{color:#000;background:#fff;text-shadow:none;border:none;border-bottom:1px solid #000;text-align:center}div.cirsim table.truth-table td{border:0}div.cirsim table.truth-table th:last-child,div.cirsim table.truth-table td:last-child{border-left:thin solid #000}div.cirsim div.tabs{position:absolute;left:83px;top:0;bottom:0;right:0;font-size:.8rem;padding:0;background:#ddd;border:0}div.cirsim div.tabs>ul{margin:0;padding:3px 0 0 2px;background:rgba(0,0,0,0);border:0;list-style:none}div.cirsim div.tabs>ul>li{position:relative;display:inline-block;font-size:.8rem;padding:.25em 1em .45em 1em;min-width:6em;text-align:center;cursor:pointer;background:#ccc;border:1px solid #000;border-bottom:none;border-radius:5px 5px 0 0;margin:1px 3px -1px 0;white-space:nowrap;z-index:18}div.cirsim div.tabs>ul>li a{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;text-decoration:none;color:#000;outline:0;user-select:none}div.cirsim div.tabs>ul>li.selected{background:#fff;z-index:22}div.cirsim div.tabs>ul>li.selected a{color:#000}div.cirsim div.tabs div.tab{position:absolute;display:none;left:0;top:29px;right:0;bottom:0;z-index:20;overflow:auto}div.cirsim div.tabs div.tab canvas{position:absolute;top:0;left:0;width:500px;height:500px;cursor:pointer}div.cirsim div.tabs div.tab.selected{display:block;background:#fff;border-top:1px solid #000}div.cirsim-test-result p.cs-result{text-align:center;color:#000}div.cirsim-test-result p.cs-info{text-align:center;font-size:.9em;font-style:italic}`,""]);const d=c},16251:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(3041),o=i.n(n),s=i(52281),r=i.n(s)()(o());r.push([t.id,"div.cl-cirsim{display:none}div.cl-cirsim-gap-before,div.cl-cirsim-gap-after{margin-top:0;margin-bottom:0;height:1px}div.cl-cirsim-gap-after{height:1em}",""]);const a=r},43096:function(t,e){var i,n,o;n=[],void 0===(o="function"==typeof(i=function(){"use strict";var t={defaultCompare:function(t,e){return t<e?-1:t===e?0:1},defaultEquals:function(t,e){return t===e},defaultToString:function(e){return null===e?"BUCKETS_NULL":t.isUndefined(e)?"BUCKETS_UNDEFINED":t.isString(e)?e:e.toString()},isFunction:function(t){return"function"==typeof t},isUndefined:function(t){return void 0===t},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},reverseCompareFunction:function(e){return t.isFunction(e)?function(t,i){return-1*e(t,i)}:function(t,e){return t<e?1:t===e?0:-1}},compareToEquals:function(t){return function(e,i){return 0===t(e,i)}},arrays:{}};return t.arrays.indexOf=function(e,i,n){var o,s=n||t.defaultEquals,r=e.length;for(o=0;o<r;o+=1)if(s(e[o],i))return o;return-1},t.arrays.lastIndexOf=function(e,i,n){var o,s=n||t.defaultEquals;for(o=e.length-1;o>=0;o-=1)if(s(e[o],i))return o;return-1},t.arrays.contains=function(e,i,n){return t.arrays.indexOf(e,i,n)>=0},t.arrays.remove=function(e,i,n){var o=t.arrays.indexOf(e,i,n);return!(o<0||(e.splice(o,1),0))},t.arrays.frequency=function(e,i,n){var o,s=n||t.defaultEquals,r=e.length,a=0;for(o=0;o<r;o+=1)s(e[o],i)&&(a+=1);return a},t.arrays.equals=function(e,i,n){var o,s=n||t.defaultEquals,r=e.length;if(e.length!==i.length)return!1;for(o=0;o<r;o+=1)if(!s(e[o],i[o]))return!1;return!0},t.arrays.copy=function(t){return t.concat()},t.arrays.swap=function(t,e,i){var n;return!(e<0||e>=t.length||i<0||i>=t.length||(n=t[e],t[e]=t[i],t[i]=n,0))},t.arrays.forEach=function(t,e){var i,n=t.length;for(i=0;i<n;i+=1)if(!1===e(t[i]))return},t.Bag=function(e){var i={},n=e||t.defaultToString,o=new t.Dictionary(n),s=0;return i.add=function(e,n){var r;return(isNaN(n)||t.isUndefined(n))&&(n=1),!(t.isUndefined(e)||n<=0||(i.contains(e)?o.get(e).copies+=n:(r={value:e,copies:n},o.set(e,r)),s+=n,0))},i.count=function(t){return i.contains(t)?o.get(t).copies:0},i.contains=function(t){return o.containsKey(t)},i.remove=function(e,n){var r;return(isNaN(n)||t.isUndefined(n))&&(n=1),!(t.isUndefined(e)||n<=0||!i.contains(e)||(r=o.get(e),s-=n>r.copies?r.copies:n,r.copies-=n,r.copies<=0&&o.remove(e),0))},i.toArray=function(){var t,e,i,n,s,r=[],a=o.values(),l=a.length;for(n=0;n<l;n+=1)for(e=(t=a[n]).value,i=t.copies,s=0;s<i;s+=1)r.push(e);return r},i.toSet=function(){var e,i=new t.Set(n),s=o.values(),r=s.length;for(e=0;e<r;e+=1)i.add(s[e].value);return i},i.forEach=function(t){o.forEach((function(e,i){var n,o=i.value,s=i.copies;for(n=0;n<s;n+=1)if(!1===t(o))return!1;return!0}))},i.size=function(){return s},i.isEmpty=function(){return 0===s},i.clear=function(){s=0,o.clear()},i.equals=function(e){var n;return!t.isUndefined(e)&&"function"==typeof e.toSet&&i.size()===e.size()&&(n=!0,e.forEach((function(t){return n=i.count(t)===e.count(t)})),n)},i},t.BSTree=function(e){function i(t,e){for(var i,n=t;void 0!==n&&0!==i;)(i=r(e,n.element))<0?n=n.leftCh:i>0&&(n=n.rightCh);return n}function n(t){for(var e=t;void 0!==e.leftCh;)e=e.leftCh;return e}var o,s={},r=e||t.defaultCompare,a=0;return s.add=function(e){function i(t){for(var e,i,n=o;void 0!==n;){if(0===(i=r(t.element,n.element)))return;i<0?(e=n,n=n.leftCh):(e=n,n=n.rightCh)}return t.parent=e,void 0===e?o=t:r(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t}return!t.isUndefined(e)&&void 0!==i({element:e,leftCh:void 0,rightCh:void 0,parent:void 0})&&(a+=1,!0)},s.clear=function(){o=void 0,a=0},s.isEmpty=function(){return 0===a},s.size=function(){return a},s.contains=function(e){return!t.isUndefined(e)&&void 0!==i(o,e)},s.remove=function(t){function e(t,e){void 0===t.parent?o=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,void 0!==e&&(e.parent=t.parent)}function s(t){if(void 0===t.leftCh)e(t,t.rightCh);else if(void 0===t.rightCh)e(t,t.leftCh);else{var i=n(t.rightCh);i.parent!==t&&(e(i,i.rightCh),i.rightCh=t.rightCh,i.rightCh.parent=i),e(t,i),i.leftCh=t.leftCh,i.leftCh.parent=i}}var r;return void 0!==(r=i(o,t))&&(s(r),a-=1,!0)},s.inorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(e(t.leftCh,i,n),n.stop||(n.stop=!1===i(t.element),n.stop||e(t.rightCh,i,n)))}e(o,t,{stop:!1})},s.preorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(n.stop=!1===i(t.element),n.stop||(e(t.leftCh,i,n),n.stop||e(t.rightCh,i,n)))}e(o,t,{stop:!1})},s.postorderTraversal=function(t){function e(t,i,n){void 0===t||n.stop||(e(t.leftCh,i,n),n.stop||(e(t.rightCh,i,n),n.stop||(n.stop=!1===i(t.element))))}e(o,t,{stop:!1})},s.levelTraversal=function(e){function i(e,i){var n=t.Queue();for(void 0!==e&&n.enqueue(e);!n.isEmpty();){if(!1===i((e=n.dequeue()).element))return;void 0!==e.leftCh&&n.enqueue(e.leftCh),void 0!==e.rightCh&&n.enqueue(e.rightCh)}}i(o,e)},s.minimum=function(){if(!s.isEmpty())return n(o).element},s.maximum=function(){function t(t){for(;void 0!==t.rightCh;)t=t.rightCh;return t}if(!s.isEmpty())return t(o).element},s.forEach=function(t){s.inorderTraversal(t)},s.toArray=function(){var t=[];return s.inorderTraversal((function(e){t.push(e)})),t},s.height=function(){function t(e){return void 0===e?-1:Math.max(t(e.leftCh),t(e.rightCh))+1}function e(e){return void 0===e?-1:Math.max(t(e.leftCh),t(e.rightCh))+1}return e(o)},s.equals=function(e){var i;return!t.isUndefined(e)&&"function"==typeof e.levelTraversal&&s.size()===e.size()&&(i=!0,e.forEach((function(t){return i=s.contains(t)})),i)},s},t.Dictionary=function(e){var i={},n={},o=0,s=e||t.defaultToString,r="/$ ";return i.get=function(e){var i=n[r+s(e)];if(!t.isUndefined(i))return i.value},i.set=function(e,i){var a,l,h;if(!t.isUndefined(e)&&!t.isUndefined(i))return l=r+s(e),h=n[l],t.isUndefined(h)?(o+=1,a=void 0):a=h.value,n[l]={key:e,value:i},a},i.remove=function(e){var i=r+s(e),a=n[i];if(!t.isUndefined(a))return delete n[i],o-=1,a.value},i.keys=function(){var t,e=[];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(n[t].key);return e},i.values=function(){var t,e=[];for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(n[t].value);return e},i.forEach=function(t){var e,i;for(e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&!1===t((i=n[e]).key,i.value))return},i.containsKey=function(e){return!t.isUndefined(i.get(e))},i.clear=function(){n={},o=0},i.size=function(){return o},i.isEmpty=function(){return o<=0},i.equals=function(e,n){var o,s;return!t.isUndefined(e)&&"function"==typeof e.keys&&i.size()===e.size()&&(o=n||t.defaultEquals,s=!0,e.forEach((function(t,e){return s=o(i.get(t),e)})),s)},i},t.Heap=function(e){function i(e){function i(t){return Math.floor((t-1)/2)}var n;for(n=i(e);e>0&&r(s[n],s[e])>0;)t.arrays.swap(s,n,e),n=i(e=n)}function n(e){function i(t){return 2*t+1}function n(t){return 2*t+2}function o(t,e){return e>=s.length?t>=s.length?-1:t:r(s[t],s[e])<=0?t:e}var a;for(a=o(i(e),n(e));a>=0&&r(s[e],s[a])>0;)t.arrays.swap(s,a,e),a=o(i(e=a),n(e))}var o={},s=[],r=e||t.defaultCompare;return o.peek=function(){if(s.length>0)return s[0]},o.add=function(e){if(!t.isUndefined(e))return s.push(e),i(s.length-1),!0},o.removeRoot=function(){var t;if(s.length>0)return t=s[0],s[0]=s[s.length-1],s.splice(s.length-1,1),s.length>0&&n(0),t},o.contains=function(e){var i=t.compareToEquals(r);return t.arrays.contains(s,e,i)},o.size=function(){return s.length},o.isEmpty=function(){return s.length<=0},o.clear=function(){s.length=0},o.forEach=function(e){t.arrays.forEach(s,e)},o.toArray=function(){return t.arrays.copy(s)},o.equals=function(e){var i,n,s;return!t.isUndefined(e)&&"function"==typeof e.removeRoot&&o.size()===e.size()&&(i=o.toArray(),n=e.toArray(),s=t.compareToEquals(r),i.sort(r),n.sort(r),t.arrays.equals(i,n,s))},o},t.LinkedList=function(){function e(t){var e,o;if(!(t<0||t>=s)){if(t===s-1)return n;for(e=i,o=0;o<t;o+=1)e=e.next;return e}}var i,n,o={},s=0;return o.add=function(o,r){var a,l;return t.isUndefined(r)&&(r=s),!(r<0||r>s||t.isUndefined(o)||(a={element:o,next:void 0},0===s?(i=a,n=a):r===s?(n.next=a,n=a):0===r?(a.next=i,i=a):(l=e(r-1),a.next=l.next,l.next=a),s+=1,0))},o.first=function(){if(void 0!==i)return i.element},o.last=function(){if(void 0!==n)return n.element},o.elementAtIndex=function(t){var i=e(t);if(void 0!==i)return i.element},o.indexOf=function(e,n){var o=n||t.defaultEquals,s=i,r=0;if(t.isUndefined(e))return-1;for(;void 0!==s;){if(o(s.element,e))return r;r+=1,s=s.next}return-1},o.contains=function(t,e){return o.indexOf(t,e)>=0},o.remove=function(e,o){var r,a=o||t.defaultEquals,l=i;if(s<1||t.isUndefined(e))return!1;for(;void 0!==l;){if(a(l.element,e))return l===i?(i=i.next,l===n&&(n=void 0)):l===n?(n=r,r.next=l.next,l.next=void 0):(r.next=l.next,l.next=void 0),s-=1,!0;r=l,l=l.next}return!1},o.clear=function(){i=void 0,n=void 0,s=0},o.equals=function(e,n){var s=n||t.defaultEquals,r=!0,a=i;return!t.isUndefined(e)&&"function"==typeof e.elementAtIndex&&o.size()===e.size()&&(e.forEach((function(t){return r=s(t,a.element),a=a.next,r})),r)},o.removeElementAtIndex=function(t){var o,r;if(!(t<0||t>=s))return 1===s?(o=i.element,i=void 0,n=void 0):(void 0===(r=e(t-1))?(o=i.element,i=i.next):r.next===n&&(o=n.element,n=r),void 0!==r&&(o=r.next.element,r.next=r.next.next)),s-=1,o},o.forEach=function(t){for(var e=i;void 0!==e&&!1!==t(e.element);)e=e.next},o.reverse=function(){for(var t,e,o=i;void 0!==o;)e=o.next,o.next=t,t=o,o=e;e=i,i=n,n=e},o.toArray=function(){var t=[];return o.forEach((function(e){t.push(e)})),t},o.size=function(){return s},o.isEmpty=function(){return s<=0},o},t.MultiDictionary=function(e,i){var n={},o=new t.Dictionary(e),s=i||t.defaultEquals;return n.get=function(e){var i=o.get(e);return t.isUndefined(i)?[]:t.arrays.copy(i)},n.set=function(e,i){var r;return!(t.isUndefined(e)||t.isUndefined(i)||(n.containsKey(e)?(r=o.get(e),t.arrays.contains(r,i,s)||(r.push(i),0)):(o.set(e,[i]),0)))},n.remove=function(e,i){var n,r;return t.isUndefined(i)?(n=o.remove(e),!t.isUndefined(n)):(r=o.get(e),!!t.arrays.remove(r,i,s)&&(0===r.length&&o.remove(e),!0))},n.keys=function(){return o.keys()},n.values=function(){var t,e,i,n=o.values(),s=[];for(t=0;t<n.length;t+=1)for(i=n[t],e=0;e<i.length;e+=1)s.push(i[e]);return s},n.containsKey=function(t){return o.containsKey(t)},n.clear=function(){return o.clear()},n.size=function(){return o.size()},n.isEmpty=function(){return o.isEmpty()},n.forEach=function(t){return o.forEach(t)},n.equals=function(e){var i,o=!0;return!t.isUndefined(e)&&"function"==typeof e.values&&n.size()===e.size()&&(e.forEach((function(e,r){return(i=n.get(e)||[]).length!==r.length?o=!1:t.arrays.forEach(i,(function(e){return o=t.arrays.contains(r,e,s)})),o})),o)},n},t.PriorityQueue=function(e){var i={},n=t.reverseCompareFunction(e),o=new t.Heap(n);return i.enqueue=function(t){return o.add(t)},i.add=function(t){return o.add(t)},i.dequeue=function(){var t;if(0!==o.size())return t=o.peek(),o.removeRoot(),t},i.peek=function(){return o.peek()},i.contains=function(t){return o.contains(t)},i.isEmpty=function(){return o.isEmpty()},i.size=function(){return o.size()},i.clear=function(){o.clear()},i.forEach=function(t){o.forEach(t)},i.toArray=function(){return o.toArray()},i.equals=function(e){var o,s,r;return!t.isUndefined(e)&&"function"==typeof e.dequeue&&i.size()===e.size()&&(o=i.toArray(),s=e.toArray(),r=t.compareToEquals(n),o.sort(n),s.sort(n),t.arrays.equals(o,s,r))},i},t.Queue=function(){var e={},i=new t.LinkedList;return e.enqueue=function(t){return i.add(t)},e.add=function(t){return i.add(t)},e.dequeue=function(){var t;if(0!==i.size())return t=i.first(),i.removeElementAtIndex(0),t},e.peek=function(){if(0!==i.size())return i.first()},e.size=function(){return i.size()},e.contains=function(t,e){return i.contains(t,e)},e.isEmpty=function(){return i.size()<=0},e.clear=function(){i.clear()},e.forEach=function(t){i.forEach(t)},e.toArray=function(){return i.toArray()},e.equals=function(i,n){var o,s,r;return!t.isUndefined(i)&&"function"==typeof i.dequeue&&e.size()===i.size()&&(o=n||t.defaultEquals,s=!0,i.forEach((function(t){return r=e.dequeue(),e.enqueue(r),s=o(r,t)})),s)},e},t.Set=function(e){var i={},n=new t.Dictionary(e);return i.contains=function(t){return n.containsKey(t)},i.add=function(e){return!i.contains(e)&&!t.isUndefined(e)&&(n.set(e,e),!0)},i.intersection=function(t){i.forEach((function(e){t.contains(e)||i.remove(e)}))},i.union=function(t){t.forEach((function(t){i.add(t)}))},i.difference=function(t){t.forEach((function(t){i.remove(t)}))},i.isSubsetOf=function(t){var e=!0;return!(i.size()>t.size())&&(i.forEach((function(i){if(!t.contains(i))return e=!1,!1})),e)},i.remove=function(t){return!!i.contains(t)&&(n.remove(t),!0)},i.forEach=function(t){n.forEach((function(e,i){return t(i)}))},i.toArray=function(){return n.values()},i.isEmpty=function(){return n.isEmpty()},i.size=function(){return n.size()},i.clear=function(){n.clear()},i.equals=function(e){var n;return!t.isUndefined(e)&&"function"==typeof e.isSubsetOf&&i.size()===e.size()&&(n=!0,e.forEach((function(t){return n=i.contains(t)})),n)},i},t.Stack=function(){var e={},i=new t.LinkedList;return e.push=function(t){return i.add(t,0)},e.add=function(t){return i.add(t,0)},e.pop=function(){return i.removeElementAtIndex(0)},e.peek=function(){return i.first()},e.size=function(){return i.size()},e.contains=function(t,e){return i.contains(t,e)},e.isEmpty=function(){return i.isEmpty()},e.clear=function(){i.clear()},e.forEach=function(t){i.forEach(t)},e.toArray=function(){return i.toArray()},e.equals=function(n,o){var s,r,a;return!t.isUndefined(n)&&"function"==typeof n.peek&&e.size()===n.size()&&(s=o||t.defaultEquals,r=!0,n.forEach((function(t){return a=e.pop(),i.add(a),r=s(a,t)})),r)},e},t})?i.apply(e,n):i)||(t.exports=o)},84324:t=>{"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAOCAYAAADNGCeJAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAAVdJREFUOI2V0bFrU1EUB+DvRWNsIJNQu6t1E8ykuDgKBQlIFwdHkQ7+AwU7url0FMQ5cXFwsoMguIhSqoPtJA51EHGohedQfg55SV9jaeKFw71wDt89hyOJesx60u83srR0LlwKvdArJoGiKKZDq6vzBoOunZ1ruIgfGPwXlm73lIODW7a3l5XlIn7hNfrYNcuY2duTXm8uPAgfQj/cD4uhGQRTsezvy8pKJzwMX8KzcCGcHiGHGHPhSlgIRZrNVjY3h1BZytpap+roU3ga5v9Bxj8PkRdhN7wLd8LltNvtrK93wt3wMQzC+WORGiYU4XrYCl8r9F64HTbC+3CzqjseqmGjOBOehO/hW3hZ4Y9D60RovICjYCM8Cj8r9HO4OhUaY6M4BFvhTfgd3oaz49zE9uvRmJBHrz/YQInn1V3Pz9DZ0Q674VW17aldJTmhYDjajVmhJP4Cy1ZU6+dCg3AAAAAASUVORK5CYII="},75456:t=>{"use strict";t.exports=JSON.parse('{"name":"cirsim","version":"2.1.17","description":"Cirsim Circuit Simulator","main":"dist/cirsim.min.js","module":"index.js","scripts":{"build:dev":"webpack --config webpack.dev.js","build:prod":"webpack --config webpack.prod.js","build:all":"$npm_execpath run build:dev && $npm_execpath run build:prod","test":"karma start karma.conf.js","serve":"webpack serve --config webpack.dev.js --open","build:docs":"documentation build src/Cirsim/**/*.js --sort-order source -f html -o doc/js"},"keywords":["Education","Circuits","Computer Architecture"],"author":"Charles B. Owen","license":"MIT","devDependencies":{"@babel/core":"^7.22.9","@babel/plugin-transform-runtime":"^7.22.9","@babel/preset-env":"^7.22.9","@babel/runtime":"7.22.6","babel-loader":"^9.1.3","clean-webpack-plugin":"^4.0.0","copy-webpack-plugin":"^11.0.0","css-loader":"^6.8.1","css-minimizer-webpack-plugin":"^5.0.1","file-loader":"^6.2.0","html-webpack-plugin":"^5.5.3","html-webpack-tags-plugin":"^3.0.2","jasmine-core":"^5.0.1","karma":"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.0","resolve-url-loader":"^5.0.0","sass":"^1.63.6","sass-loader":"^13.3.2","style-loader":"^3.3.3","terser-webpack-plugin":"^5.3.9","webpack":"^5.88.1","webpack-cli":"^5.1.4","webpack-dev-server":"^4.15.1","webpack-merge":"^5.9.0"},"dependencies":{"buckets-js":"^1.98.2","dialog-cl":"^1.0.7","dompurify":"^3.0.5","icons-cl":"~1.1.3","promise-polyfill":"^8.3.0","resizer-cl":"^2.4.4"}}')}},t=>{t.O(0,[736,77,530,592],(()=>{return e=54463,t(t.s=e);var e}));t.O()}]);